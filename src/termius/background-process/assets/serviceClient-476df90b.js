function Ce(t){let e="";for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return btoa(e)}function Ee(t){const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n}function Sr(t){return atob(t)}const v="$",U="_";function Je(t,e){return e!=="Composite"&&e!=="Dictionary"&&(typeof t=="string"||typeof t=="number"||typeof t=="boolean"||(e==null?void 0:e.match(/^(Date|DateTime|DateTimeRfc1123|UnixTime|ByteArray|Base64Url)$/i))!==null||t===void 0||t===null)}const Qe=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Ge(t){return Qe.test(t)}const Ye=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i;function Ze(t){return Ye.test(t)}function et(t){const e=Object.assign(Object.assign({},t.headers),t.body);return t.hasNullableType&&Object.getOwnPropertyNames(e).length===0?t.shouldWrapBody?{body:null}:null:t.shouldWrapBody?Object.assign(Object.assign({},t.headers),{body:t.body}):e}function he(t,e){var n,r;const i=t.parsedHeaders;if(t.request.method==="HEAD")return Object.assign(Object.assign({},i),{body:t.parsedBody});const s=e&&e.bodyMapper,o=!!(s!=null&&s.nullable),l=s==null?void 0:s.type.name;if(l==="Stream")return Object.assign(Object.assign({},i),{blobBody:t.blobBody,readableStreamBody:t.readableStreamBody});const c=l==="Composite"&&s.type.modelProperties||{},a=Object.keys(c).some(u=>c[u].serializedName==="");if(l==="Sequence"||a){const u=(n=t.parsedBody)!==null&&n!==void 0?n:[];for(const d of Object.keys(c))c[d].serializedName&&(u[d]=(r=t.parsedBody)===null||r===void 0?void 0:r[d]);if(i)for(const d of Object.keys(i))u[d]=i[d];return o&&!t.parsedBody&&!i&&Object.getOwnPropertyNames(c).length===0?null:u}return et({body:t.parsedBody,headers:i,hasNullableType:o,shouldWrapBody:Je(t.parsedBody,l)})}class tt{constructor(e={},n=!1){this.modelMappers=e,this.isXML=n}validateConstraints(e,n,r){const i=(s,o)=>{throw new Error(`"${r}" with value "${n}" should satisfy the constraint "${s}": ${o}.`)};if(e.constraints&&n!==void 0&&n!==null){const{ExclusiveMaximum:s,ExclusiveMinimum:o,InclusiveMaximum:l,InclusiveMinimum:c,MaxItems:a,MaxLength:u,MinItems:d,MinLength:f,MultipleOf:h,Pattern:m,UniqueItems:y}=e.constraints;if(s!==void 0&&n>=s&&i("ExclusiveMaximum",s),o!==void 0&&n<=o&&i("ExclusiveMinimum",o),l!==void 0&&n>l&&i("InclusiveMaximum",l),c!==void 0&&n<c&&i("InclusiveMinimum",c),a!==void 0&&n.length>a&&i("MaxItems",a),u!==void 0&&n.length>u&&i("MaxLength",u),d!==void 0&&n.length<d&&i("MinItems",d),f!==void 0&&n.length<f&&i("MinLength",f),h!==void 0&&n%h!==0&&i("MultipleOf",h),m){const p=typeof m=="string"?new RegExp(m):m;(typeof n!="string"||n.match(p)===null)&&i("Pattern",m)}y&&n.some((p,x,w)=>w.indexOf(p)!==x)&&i("UniqueItems",y)}}serialize(e,n,r,i={xml:{}}){var s,o,l;const c={xml:{rootName:(s=i.xml.rootName)!==null&&s!==void 0?s:"",includeRoot:(o=i.xml.includeRoot)!==null&&o!==void 0?o:!1,xmlCharKey:(l=i.xml.xmlCharKey)!==null&&l!==void 0?l:U}};let a={};const u=e.type.name;r||(r=e.serializedName),u.match(/^Sequence$/i)!==null&&(a=[]),e.isConstant&&(n=e.defaultValue);const{required:d,nullable:f}=e;if(d&&f&&n===void 0)throw new Error(`${r} cannot be undefined.`);if(d&&!f&&n==null)throw new Error(`${r} cannot be null or undefined.`);if(!d&&f===!1&&n===null)throw new Error(`${r} cannot be null.`);return n==null||u.match(/^any$/i)!==null?a=n:u.match(/^(Number|String|Boolean|Object|Stream|Uuid)$/i)!==null?a=at(u,r,n):u.match(/^Enum$/i)!==null?a=lt(r,e.type.allowedValues,n):u.match(/^(Date|DateTime|TimeSpan|DateTimeRfc1123|UnixTime)$/i)!==null?a=dt(u,n,r):u.match(/^ByteArray$/i)!==null?a=ct(r,n):u.match(/^Base64Url$/i)!==null?a=ut(r,n):u.match(/^Sequence$/i)!==null?a=ft(this,e,n,r,!!this.isXML,c):u.match(/^Dictionary$/i)!==null?a=mt(this,e,n,r,!!this.isXML,c):u.match(/^Composite$/i)!==null&&(a=yt(this,e,n,r,!!this.isXML,c)),a}deserialize(e,n,r,i={xml:{}}){var s,o,l,c;const a={xml:{rootName:(s=i.xml.rootName)!==null&&s!==void 0?s:"",includeRoot:(o=i.xml.includeRoot)!==null&&o!==void 0?o:!1,xmlCharKey:(l=i.xml.xmlCharKey)!==null&&l!==void 0?l:U},ignoreUnknownProperties:(c=i.ignoreUnknownProperties)!==null&&c!==void 0?c:!1};if(n==null)return this.isXML&&e.type.name==="Sequence"&&!e.xmlIsWrapped&&(n=[]),e.defaultValue!==void 0&&(n=e.defaultValue),n;let u;const d=e.type.name;if(r||(r=e.serializedName),d.match(/^Composite$/i)!==null)u=gt(this,e,n,r,a);else{if(this.isXML){const f=a.xml.xmlCharKey;n[v]!==void 0&&n[f]!==void 0&&(n=n[f])}d.match(/^Number$/i)!==null?(u=parseFloat(n),isNaN(u)&&(u=n)):d.match(/^Boolean$/i)!==null?n==="true"?u=!0:n==="false"?u=!1:u=n:d.match(/^(String|Enum|Object|Stream|Uuid|TimeSpan|any)$/i)!==null?u=n:d.match(/^(Date|DateTime|DateTimeRfc1123)$/i)!==null?u=new Date(n):d.match(/^UnixTime$/i)!==null?u=ot(n):d.match(/^ByteArray$/i)!==null?u=Ee(n):d.match(/^Base64Url$/i)!==null?u=it(n):d.match(/^Sequence$/i)!==null?u=bt(this,e,n,r,a):d.match(/^Dictionary$/i)!==null&&(u=wt(this,e,n,r,a))}return e.isConstant&&(u=e.defaultValue),u}}function Cr(t={},e=!1){return new tt(t,e)}function nt(t,e){let n=t.length;for(;n-1>=0&&t[n-1]===e;)--n;return t.substr(0,n)}function rt(t){if(!t)return;if(!(t instanceof Uint8Array))throw new Error("Please provide an input of type Uint8Array for converting to Base64Url.");const e=Ce(t);return nt(e,"=").replace(/\+/g,"-").replace(/\//g,"_")}function it(t){if(t){if(t&&typeof t.valueOf()!="string")throw new Error("Please provide an input of type string for converting to Uint8Array");return t=t.replace(/-/g,"+").replace(/_/g,"/"),Ee(t)}}function te(t){const e=[];let n="";if(t){const r=t.split(".");for(const i of r)i.charAt(i.length-1)==="\\"?n+=i.substr(0,i.length-1)+".":(n+=i,e.push(n),n="")}return e}function st(t){if(t)return typeof t.valueOf()=="string"&&(t=new Date(t)),Math.floor(t.getTime()/1e3)}function ot(t){if(t)return new Date(t*1e3)}function at(t,e,n){if(n!=null){if(t.match(/^Number$/i)!==null){if(typeof n!="number")throw new Error(`${e} with value ${n} must be of type number.`)}else if(t.match(/^String$/i)!==null){if(typeof n.valueOf()!="string")throw new Error(`${e} with value "${n}" must be of type string.`)}else if(t.match(/^Uuid$/i)!==null){if(!(typeof n.valueOf()=="string"&&Ze(n)))throw new Error(`${e} with value "${n}" must be of type string and a valid uuid.`)}else if(t.match(/^Boolean$/i)!==null){if(typeof n!="boolean")throw new Error(`${e} with value ${n} must be of type boolean.`)}else if(t.match(/^Stream$/i)!==null){const r=typeof n;if(r!=="string"&&typeof n.pipe!="function"&&!(n instanceof ArrayBuffer)&&!ArrayBuffer.isView(n)&&!((typeof Blob=="function"||typeof Blob=="object")&&n instanceof Blob)&&r!=="function")throw new Error(`${e} must be a string, Blob, ArrayBuffer, ArrayBufferView, NodeJS.ReadableStream, or () => NodeJS.ReadableStream.`)}}return n}function lt(t,e,n){if(!e)throw new Error(`Please provide a set of allowedValues to validate ${t} as an Enum Type.`);if(!e.some(i=>typeof i.valueOf()=="string"?i.toLowerCase()===n.toLowerCase():i===n))throw new Error(`${n} is not a valid value for ${t}. The valid values are: ${JSON.stringify(e)}.`);return n}function ct(t,e){if(e!=null){if(!(e instanceof Uint8Array))throw new Error(`${t} must be of type Uint8Array.`);e=Ce(e)}return e}function ut(t,e){if(e!=null){if(!(e instanceof Uint8Array))throw new Error(`${t} must be of type Uint8Array.`);e=rt(e)}return e}function dt(t,e,n){if(e!=null){if(t.match(/^Date$/i)!==null){if(!(e instanceof Date||typeof e.valueOf()=="string"&&!isNaN(Date.parse(e))))throw new Error(`${n} must be an instanceof Date or a string in ISO8601 format.`);e=e instanceof Date?e.toISOString().substring(0,10):new Date(e).toISOString().substring(0,10)}else if(t.match(/^DateTime$/i)!==null){if(!(e instanceof Date||typeof e.valueOf()=="string"&&!isNaN(Date.parse(e))))throw new Error(`${n} must be an instanceof Date or a string in ISO8601 format.`);e=e instanceof Date?e.toISOString():new Date(e).toISOString()}else if(t.match(/^DateTimeRfc1123$/i)!==null){if(!(e instanceof Date||typeof e.valueOf()=="string"&&!isNaN(Date.parse(e))))throw new Error(`${n} must be an instanceof Date or a string in RFC-1123 format.`);e=e instanceof Date?e.toUTCString():new Date(e).toUTCString()}else if(t.match(/^UnixTime$/i)!==null){if(!(e instanceof Date||typeof e.valueOf()=="string"&&!isNaN(Date.parse(e))))throw new Error(`${n} must be an instanceof Date or a string in RFC-1123/ISO8601 format for it to be serialized in UnixTime/Epoch format.`);e=st(e)}else if(t.match(/^TimeSpan$/i)!==null&&!Ge(e))throw new Error(`${n} must be a string in ISO 8601 format. Instead was "${e}".`)}return e}function ft(t,e,n,r,i,s){var o;if(!Array.isArray(n))throw new Error(`${r} must be of type Array.`);let l=e.type.element;if(!l||typeof l!="object")throw new Error(`element" metadata for an Array must be defined in the mapper and it must of type "object" in ${r}.`);l.type.name==="Composite"&&l.type.className&&(l=(o=t.modelMappers[l.type.className])!==null&&o!==void 0?o:l);const c=[];for(let a=0;a<n.length;a++){const u=t.serialize(l,n[a],r,s);if(i&&l.xmlNamespace){const d=l.xmlNamespacePrefix?`xmlns:${l.xmlNamespacePrefix}`:"xmlns";l.type.name==="Composite"?(c[a]=Object.assign({},u),c[a][v]={[d]:l.xmlNamespace}):(c[a]={},c[a][s.xml.xmlCharKey]=u,c[a][v]={[d]:l.xmlNamespace})}else c[a]=u}return c}function mt(t,e,n,r,i,s){if(typeof n!="object")throw new Error(`${r} must be of type object.`);const o=e.type.value;if(!o||typeof o!="object")throw new Error(`"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in ${r}.`);const l={};for(const c of Object.keys(n)){const a=t.serialize(o,n[c],r,s);l[c]=Te(o,a,i,s)}if(i&&e.xmlNamespace){const c=e.xmlNamespacePrefix?`xmlns:${e.xmlNamespacePrefix}`:"xmlns",a=l;return a[v]={[c]:e.xmlNamespace},a}return l}function ht(t,e,n){const r=e.type.additionalProperties;if(!r&&e.type.className){const i=Ae(t,e,n);return i==null?void 0:i.type.additionalProperties}return r}function Ae(t,e,n){const r=e.type.className;if(!r)throw new Error(`Class name for model "${n}" is not provided in the mapper "${JSON.stringify(e,void 0,2)}".`);return t.modelMappers[r]}function Oe(t,e,n){let r=e.type.modelProperties;if(!r){const i=Ae(t,e,n);if(!i)throw new Error(`mapper() cannot be null or undefined for model "${e.type.className}".`);if(r=i==null?void 0:i.type.modelProperties,!r)throw new Error(`modelProperties cannot be null or undefined in the mapper "${JSON.stringify(i)}" of type "${e.type.className}" for object "${n}".`)}return r}function yt(t,e,n,r,i,s){if(K(t,e)&&(e=$e(t,e,n,"clientName")),n!=null){const o={},l=Oe(t,e,r);for(const a of Object.keys(l)){const u=l[a];if(u.readOnly)continue;let d,f=o;if(t.isXML)u.xmlIsWrapped?d=u.xmlName:d=u.xmlElementName||u.xmlName;else{const h=te(u.serializedName);d=h.pop();for(const m of h){const y=f[m];y==null&&(n[a]!==void 0&&n[a]!==null||u.defaultValue!==void 0)&&(f[m]={}),f=f[m]}}if(f!=null){if(i&&e.xmlNamespace){const x=e.xmlNamespacePrefix?`xmlns:${e.xmlNamespacePrefix}`:"xmlns";f[v]=Object.assign(Object.assign({},f[v]),{[x]:e.xmlNamespace})}const h=u.serializedName!==""?r+"."+u.serializedName:r;let m=n[a];const y=K(t,e);y&&y.clientName===a&&m==null&&(m=e.serializedName);const p=t.serialize(u,m,h,s);if(p!==void 0&&d!==void 0&&d!==null){const x=Te(u,p,i,s);i&&u.xmlIsAttribute?(f[v]=f[v]||{},f[v][d]=p):i&&u.xmlIsWrapped?f[d]={[u.xmlElementName]:x}:f[d]=x}}}const c=ht(t,e,r);if(c){const a=Object.keys(l);for(const u in n)a.every(f=>f!==u)&&(o[u]=t.serialize(c,n[u],r+'["'+u+'"]',s))}return o}return n}function Te(t,e,n,r){if(!n||!t.xmlNamespace)return e;const s={[t.xmlNamespacePrefix?`xmlns:${t.xmlNamespacePrefix}`:"xmlns"]:t.xmlNamespace};if(["Composite"].includes(t.type.name)){if(e[v])return e;{const l=Object.assign({},e);return l[v]=s,l}}const o={};return o[r.xml.xmlCharKey]=e,o[v]=s,o}function pt(t,e){return[v,e.xml.xmlCharKey].includes(t)}function gt(t,e,n,r,i){var s,o;const l=(s=i.xml.xmlCharKey)!==null&&s!==void 0?s:U;K(t,e)&&(e=$e(t,e,n,"serializedName"));const c=Oe(t,e,r);let a={};const u=[];for(const f of Object.keys(c)){const h=c[f],m=te(c[f].serializedName);u.push(m[0]);const{serializedName:y,xmlName:p,xmlElementName:x}=h;let w=r;y!==""&&y!==void 0&&(w=r+"."+y);const S=h.headerCollectionPrefix;if(S){const g={};for(const b of Object.keys(n))b.startsWith(S)&&(g[b.substring(S.length)]=t.deserialize(h.type.value,n[b],w,i)),u.push(b);a[f]=g}else if(t.isXML)if(h.xmlIsAttribute&&n[v])a[f]=t.deserialize(h,n[v][p],w,i);else if(h.xmlIsMsText)n[l]!==void 0?a[f]=n[l]:typeof n=="string"&&(a[f]=n);else{const g=x||p||y;if(h.xmlIsWrapped){const b=n[p],E=(o=b==null?void 0:b[x])!==null&&o!==void 0?o:[];a[f]=t.deserialize(h,E,w,i),u.push(p)}else{const b=n[g];a[f]=t.deserialize(h,b,w,i),u.push(g)}}else{let g,b=n,E=0;for(const _ of m){if(!b)break;E++,b=b[_]}b===null&&E<m.length&&(b=void 0),g=b;const M=e.type.polymorphicDiscriminator;M&&f===M.clientName&&g==null&&(g=e.serializedName);let D;if(Array.isArray(n[f])&&c[f].serializedName===""){g=n[f];const _=t.deserialize(h,g,w,i);for(const[me,je]of Object.entries(a))Object.prototype.hasOwnProperty.call(_,me)||(_[me]=je);a=_}else(g!==void 0||h.defaultValue!==void 0)&&(D=t.deserialize(h,g,w,i),a[f]=D)}}const d=e.type.additionalProperties;if(d){const f=h=>{for(const m in c)if(te(c[m].serializedName)[0]===h)return!1;return!0};for(const h in n)f(h)&&(a[h]=t.deserialize(d,n[h],r+'["'+h+'"]',i))}else if(n&&!i.ignoreUnknownProperties)for(const f of Object.keys(n))a[f]===void 0&&!u.includes(f)&&!pt(f,i)&&(a[f]=n[f]);return a}function wt(t,e,n,r,i){const s=e.type.value;if(!s||typeof s!="object")throw new Error(`"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in ${r}`);if(n){const o={};for(const l of Object.keys(n))o[l]=t.deserialize(s,n[l],r,i);return o}return n}function bt(t,e,n,r,i){var s;let o=e.type.element;if(!o||typeof o!="object")throw new Error(`element" metadata for an Array must be defined in the mapper and it must of type "object" in ${r}`);if(n){Array.isArray(n)||(n=[n]),o.type.name==="Composite"&&o.type.className&&(o=(s=t.modelMappers[o.type.className])!==null&&s!==void 0?s:o);const l=[];for(let c=0;c<n.length;c++)l[c]=t.deserialize(o,n[c],`${r}[${c}]`,i);return l}return n}function xt(t,e,n){const r=[n];for(;r.length;){const i=r.shift(),s=e===i?e:i+"."+e;if(Object.prototype.hasOwnProperty.call(t,s))return t[s];for(const[o,l]of Object.entries(t))o.startsWith(i+".")&&l.type.uberParent===i&&l.type.className&&r.push(l.type.className)}}function $e(t,e,n,r){var i;const s=K(t,e);if(s){let o=s[r];if(o){r==="serializedName"&&(o=o.replace(/\\/gi,""));const l=n[o],c=(i=e.type.uberParent)!==null&&i!==void 0?i:e.type.className;if(typeof l=="string"&&c){const a=xt(t.modelMappers.discriminators,l,c);a&&(e=a)}}}return e}function K(t,e){return e.type.polymorphicDiscriminator||ye(t,e.type.uberParent)||ye(t,e.type.className)}function ye(t,e){return e&&t.modelMappers[e]&&t.modelMappers[e].type.polymorphicDiscriminator}const O={Base64Url:"Base64Url",Boolean:"Boolean",ByteArray:"ByteArray",Composite:"Composite",Date:"Date",DateTime:"DateTime",DateTimeRfc1123:"DateTimeRfc1123",Dictionary:"Dictionary",Enum:"Enum",Number:"Number",Object:"Object",Sequence:"Sequence",String:"String",Stream:"Stream",TimeSpan:"TimeSpan",UnixTime:"UnixTime"},pe=new Set(["Deserialize","Serialize","Retry","Sign"]);class W{constructor(e){var n;this._policies=[],this._policies=(n=e==null?void 0:e.slice(0))!==null&&n!==void 0?n:[],this._orderedPolicies=void 0}addPolicy(e,n={}){if(n.phase&&n.afterPhase)throw new Error("Policies inside a phase cannot specify afterPhase.");if(n.phase&&!pe.has(n.phase))throw new Error(`Invalid phase name: ${n.phase}`);if(n.afterPhase&&!pe.has(n.afterPhase))throw new Error(`Invalid afterPhase name: ${n.afterPhase}`);this._policies.push({policy:e,options:n}),this._orderedPolicies=void 0}removePolicy(e){const n=[];return this._policies=this._policies.filter(r=>e.name&&r.policy.name===e.name||e.phase&&r.options.phase===e.phase?(n.push(r.policy),!1):!0),this._orderedPolicies=void 0,n}sendRequest(e,n){return this.getOrderedPolicies().reduceRight((s,o)=>l=>o.sendRequest(l,s),s=>e.sendRequest(s))(n)}getOrderedPolicies(){return this._orderedPolicies||(this._orderedPolicies=this.orderPolicies()),this._orderedPolicies}clone(){return new W(this._policies)}static create(){return new W}orderPolicies(){const e=[],n=new Map;function r(m){return{name:m,policies:new Set,hasRun:!1,hasAfterPolicies:!1}}const i=r("Serialize"),s=r("None"),o=r("Deserialize"),l=r("Retry"),c=r("Sign"),a=[i,s,o,l,c];function u(m){return m==="Retry"?l:m==="Serialize"?i:m==="Deserialize"?o:m==="Sign"?c:s}for(const m of this._policies){const y=m.policy,p=m.options,x=y.name;if(n.has(x))throw new Error("Duplicate policy names not allowed in pipeline");const w={policy:y,dependsOn:new Set,dependants:new Set};p.afterPhase&&(w.afterPhase=u(p.afterPhase),w.afterPhase.hasAfterPolicies=!0),n.set(x,w),u(p.phase).policies.add(w)}for(const m of this._policies){const{policy:y,options:p}=m,x=y.name,w=n.get(x);if(!w)throw new Error(`Missing node for policy ${x}`);if(p.afterPolicies)for(const S of p.afterPolicies){const g=n.get(S);g&&(w.dependsOn.add(g),g.dependants.add(w))}if(p.beforePolicies)for(const S of p.beforePolicies){const g=n.get(S);g&&(g.dependsOn.add(w),w.dependants.add(g))}}function d(m){m.hasRun=!0;for(const y of m.policies)if(!(y.afterPhase&&(!y.afterPhase.hasRun||y.afterPhase.policies.size))&&y.dependsOn.size===0){e.push(y.policy);for(const p of y.dependants)p.dependsOn.delete(y);n.delete(y.policy.name),m.policies.delete(y)}}function f(){for(const m of a){if(d(m),m.policies.size>0&&m!==s){s.hasRun||d(s);return}m.hasAfterPolicies&&d(s)}}let h=0;for(;n.size>0;){h++;const m=e.length;if(f(),e.length<=m&&h>1)throw new Error("Cannot satisfy policy dependencies due to requirements cycle.")}return e}}function Pt(){return W.create()}function vt(...t){if(t.length>0){const e=String(t[0]);e.includes(":error")?console.error(...t):e.includes(":warning")?console.warn(...t):e.includes(":info")?console.info(...t):e.includes(":verbose")?console.debug(...t):console.debug(...t)}}const ge=typeof process<"u"&&process.env&&process.env.DEBUG||void 0;let Ne,ne=[],re=[];const X=[];ge&&ae(ge);const Me=Object.assign(t=>De(t),{enable:ae,enabled:le,disable:Rt,log:vt});function ae(t){Ne=t,ne=[],re=[];const e=/\*/g,n=t.split(",").map(r=>r.trim().replace(e,".*?"));for(const r of n)r.startsWith("-")?re.push(new RegExp(`^${r.substr(1)}$`)):ne.push(new RegExp(`^${r}$`));for(const r of X)r.enabled=le(r.namespace)}function le(t){if(t.endsWith("*"))return!0;for(const e of re)if(e.test(t))return!1;for(const e of ne)if(e.test(t))return!0;return!1}function Rt(){const t=Ne||"";return ae(""),t}function De(t){const e=Object.assign(n,{enabled:le(t),destroy:St,log:Me.log,namespace:t,extend:Ct});function n(...r){e.enabled&&(r.length>0&&(r[0]=`${t} ${r[0]}`),e.log(...r))}return X.push(e),e}function St(){const t=X.indexOf(this);return t>=0?(X.splice(t,1),!0):!1}function Ct(t){const e=De(`${this.namespace}:${t}`);return e.log=this.log,e}const L=Me,_e=new Set,k=typeof process<"u"&&process.env&&process.env.AZURE_LOG_LEVEL||void 0;let j;const ie=L("azure");ie.log=(...t)=>{L.log(...t)};const ce=["verbose","info","warning","error"];k&&(Ue(k)?Et(k):console.error(`AZURE_LOG_LEVEL set to unknown log level '${k}'; logging is not enabled. Acceptable values: ${ce.join(", ")}.`));function Et(t){if(t&&!Ue(t))throw new Error(`Unknown log level '${t}'. Acceptable values: ${ce.join(",")}`);j=t;const e=[];for(const n of _e)Ie(n)&&e.push(n.namespace);L.enable(e.join(","))}function Er(){return j}const we={verbose:400,info:300,warning:200,error:100};function ue(t){const e=ie.extend(t);return ze(ie,e),{error:V(e,"error"),warning:V(e,"warning"),info:V(e,"info"),verbose:V(e,"verbose")}}function ze(t,e){e.log=(...n)=>{t.log(...n)}}function V(t,e){const n=Object.assign(t.extend(e),{level:e});if(ze(t,n),Ie(n)){const r=L.disable();L.enable(r+","+n.namespace)}return _e.add(n),n}function Ie(t){return!!(j&&we[t.level]<=we[j])}function Ue(t){return ce.includes(t)}const $=ue("core-rest-pipeline"),A=new WeakMap,F=new WeakMap;class J{constructor(){this.onabort=null,A.set(this,[]),F.set(this,!1)}get aborted(){if(!F.has(this))throw new TypeError("Expected `this` to be an instance of AbortSignal.");return F.get(this)}static get none(){return new J}addEventListener(e,n){if(!A.has(this))throw new TypeError("Expected `this` to be an instance of AbortSignal.");A.get(this).push(n)}removeEventListener(e,n){if(!A.has(this))throw new TypeError("Expected `this` to be an instance of AbortSignal.");const r=A.get(this),i=r.indexOf(n);i>-1&&r.splice(i,1)}dispatchEvent(e){throw new Error("This is a stub dispatchEvent implementation that should not be used.  It only exists for type-checking purposes.")}}function be(t){if(t.aborted)return;t.onabort&&t.onabort.call(t);const e=A.get(t);e&&e.slice().forEach(n=>{n.call(t,{type:"abort"})}),F.set(t,!0)}class de extends Error{constructor(e){super(e),this.name="AbortError"}}let Ar=class{constructor(e){if(this._signal=new J,!!e){Array.isArray(e)||(e=arguments);for(const n of e)n.aborted?this.abort():n.addEventListener("abort",()=>{this.abort()})}}get signal(){return this._signal}abort(){be(this._signal)}static timeout(e){const n=new J,r=setTimeout(be,e,n);return typeof r.unref=="function"&&r.unref(),n}};function At(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t}function Le(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)&&!(t instanceof RegExp)&&!(t instanceof Date)}function fe(t){if(Le(t)){const e=typeof t.name=="string",n=typeof t.message=="string";return e&&n}return!1}function Q(t){if(fe(t))return t.message;{let e;try{typeof t=="object"&&t?e=JSON.stringify(t):e=String(t)}catch{e="[unable to stringify input]"}return`Unknown error ${e}`}}const G="REDACTED",Ot=["x-ms-client-request-id","x-ms-return-client-request-id","x-ms-useragent","x-ms-correlation-request-id","x-ms-request-id","client-request-id","ms-cv","return-client-request-id","traceparent","Access-Control-Allow-Credentials","Access-Control-Allow-Headers","Access-Control-Allow-Methods","Access-Control-Allow-Origin","Access-Control-Expose-Headers","Access-Control-Max-Age","Access-Control-Request-Headers","Access-Control-Request-Method","Origin","Accept","Accept-Encoding","Cache-Control","Connection","Content-Length","Content-Type","Date","ETag","Expires","If-Match","If-Modified-Since","If-None-Match","If-Unmodified-Since","Last-Modified","Pragma","Request-Id","Retry-After","Server","Transfer-Encoding","User-Agent","WWW-Authenticate"],Tt=["api-version"];class ke{constructor({additionalAllowedHeaderNames:e=[],additionalAllowedQueryParameters:n=[]}={}){e=Ot.concat(e),n=Tt.concat(n),this.allowedHeaderNames=new Set(e.map(r=>r.toLowerCase())),this.allowedQueryParameters=new Set(n.map(r=>r.toLowerCase()))}sanitize(e){const n=new Set;return JSON.stringify(e,(r,i)=>{if(i instanceof Error)return Object.assign(Object.assign({},i),{name:i.name,message:i.message});if(r==="headers")return this.sanitizeHeaders(i);if(r==="url")return this.sanitizeUrl(i);if(r==="query")return this.sanitizeQuery(i);if(r==="body")return;if(r==="response")return;if(r==="operationSpec")return;if(Array.isArray(i)||Le(i)){if(n.has(i))return"[Circular]";n.add(i)}return i},2)}sanitizeHeaders(e){const n={};for(const r of Object.keys(e))this.allowedHeaderNames.has(r.toLowerCase())?n[r]=e[r]:n[r]=G;return n}sanitizeQuery(e){if(typeof e!="object"||e===null)return e;const n={};for(const r of Object.keys(e))this.allowedQueryParameters.has(r.toLowerCase())?n[r]=e[r]:n[r]=G;return n}sanitizeUrl(e){if(typeof e!="string"||e===null)return e;const n=new URL(e);if(!n.search)return e;for(const[r]of n.searchParams)this.allowedQueryParameters.has(r.toLowerCase())||n.searchParams.set(r,G);return n.toString()}}const $t="logPolicy";function Nt(t={}){var e;const n=(e=t.logger)!==null&&e!==void 0?e:$.info,r=new ke({additionalAllowedHeaderNames:t.additionalAllowedHeaderNames,additionalAllowedQueryParameters:t.additionalAllowedQueryParameters});return{name:$t,async sendRequest(i,s){if(!n.enabled)return s(i);n(`Request: ${r.sanitize(i)}`);const o=await s(i);return n(`Response status code: ${o.status}`),n(`Headers: ${r.sanitize(o.headers)}`),o}}}function Mt(){return"x-ms-useragent"}function Dt(t){const e=self.navigator;t.set("OS",(e.oscpu||e.platform).replace(" ",""))}const Ve="1.10.0",se=3;function _t(t){const e=[];for(const[n,r]of t){const i=r?`${n}/${r}`:n;e.push(i)}return e.join(" ")}function zt(){return Mt()}function qe(t){const e=new Map;e.set("core-rest-pipeline",Ve),Dt(e);const n=_t(e);return t?`${t} ${n}`:n}const xe=zt(),It="userAgentPolicy";function Ut(t={}){const e=qe(t.userAgentPrefix);return{name:It,async sendRequest(n,r){return n.headers.has(xe)||n.headers.set(xe,e),r(n)}}}const Lt="The operation was aborted.";function He(t,e,n){return new Promise((r,i)=>{let s,o;const l=()=>i(new de(n!=null&&n.abortErrorMsg?n==null?void 0:n.abortErrorMsg:Lt)),c=()=>{n!=null&&n.abortSignal&&o&&n.abortSignal.removeEventListener("abort",o)};if(o=()=>(s&&clearTimeout(s),c(),l()),n!=null&&n.abortSignal&&n.abortSignal.aborted)return l();s=setTimeout(()=>{c(),r(e)},t),n!=null&&n.abortSignal&&n.abortSignal.addEventListener("abort",o)})}function kt(t,e){const n=t.headers.get(e);if(!n)return;const r=Number(n);if(!Number.isNaN(r))return r}const oe="Retry-After",Vt=["retry-after-ms","x-ms-retry-after-ms",oe];function Be(t){if(t&&[429,503].includes(t.status))try{for(const i of Vt){const s=kt(t,i);if(s===0||s)return s*(i===oe?1e3:1)}const e=t.headers.get(oe);if(!e)return;const r=Date.parse(e)-Date.now();return Number.isFinite(r)?Math.max(0,r):void 0}catch{return}}function qt(t){return Number.isFinite(Be(t))}function Ht(){return{name:"throttlingRetryStrategy",retry({response:t}){const e=Be(t);return Number.isFinite(e)?{retryAfterInMs:e}:{skipStrategy:!0}}}}const Bt=1e3,Ft=1e3*64;function Kt(t={}){var e,n;const r=(e=t.retryDelayInMs)!==null&&e!==void 0?e:Bt,i=(n=t.maxRetryDelayInMs)!==null&&n!==void 0?n:Ft;let s=r;return{name:"exponentialRetryStrategy",retry({retryCount:o,response:l,responseError:c}){const a=Xt(c),u=a&&t.ignoreSystemErrors,d=Wt(l),f=d&&t.ignoreHttpStatusCodes;if(l&&(qt(l)||!d)||f||u)return{skipStrategy:!0};if(c&&!a&&!d)return{errorToThrow:c};const m=s*Math.pow(2,o),y=Math.min(i,m);return s=y/2+At(0,y/2),{retryAfterInMs:s}}}}function Wt(t){return!!(t&&t.status!==void 0&&(t.status>=500||t.status===408)&&t.status!==501&&t.status!==505)}function Xt(t){return t?t.code==="ETIMEDOUT"||t.code==="ESOCKETTIMEDOUT"||t.code==="ECONNREFUSED"||t.code==="ECONNRESET"||t.code==="ENOENT":!1}const Pe=ue("core-rest-pipeline retryPolicy"),jt="retryPolicy";function Jt(t,e={maxRetries:se}){const n=e.logger||Pe;return{name:jt,async sendRequest(r,i){var s,o;let l,c,a=-1;e:for(;;){a+=1,l=void 0,c=void 0;try{n.info(`Retry ${a}: Attempting to send request`,r.requestId),l=await i(r),n.info(`Retry ${a}: Received a response from request`,r.requestId)}catch(u){if(n.error(`Retry ${a}: Received an error from request`,r.requestId),c=u,!u||c.name!=="RestError")throw u;l=c.response}if(!((s=r.abortSignal)===null||s===void 0)&&s.aborted)throw n.error(`Retry ${a}: Request aborted.`),new de;if(a>=((o=e.maxRetries)!==null&&o!==void 0?o:se)){if(n.info(`Retry ${a}: Maximum retries reached. Returning the last received response, or throwing the last received error.`),c)throw c;if(l)return l;throw new Error("Maximum retries reached with no response or error to throw")}n.info(`Retry ${a}: Processing ${t.length} retry strategies.`);t:for(const u of t){const d=u.logger||Pe;d.info(`Retry ${a}: Processing retry strategy ${u.name}.`);const f=u.retry({retryCount:a,response:l,responseError:c});if(f.skipStrategy){d.info(`Retry ${a}: Skipped.`);continue t}const{errorToThrow:h,retryAfterInMs:m,redirectTo:y}=f;if(h)throw d.error(`Retry ${a}: Retry strategy ${u.name} throws error:`,h),h;if(m||m===0){d.info(`Retry ${a}: Retry strategy ${u.name} retries after ${m}`),await He(m,void 0,{abortSignal:r.abortSignal});continue e}if(y){d.info(`Retry ${a}: Retry strategy ${u.name} redirects to ${y}`),r.url=y;continue e}}if(c)throw n.info("None of the retry strategies could work with the received error. Throwing it."),c;if(l)return n.info("None of the retry strategies could work with the received response. Returning it."),l}}}}const Qt="defaultRetryPolicy";function Gt(t={}){var e;return{name:Qt,sendRequest:Jt([Ht(),Kt(t)],{maxRetries:(e=t.maxRetries)!==null&&e!==void 0?e:se}).sendRequest}}const Yt="formDataPolicy";function Zt(){return{name:Yt,async sendRequest(t,e){if(t.formData){const n=t.formData,r=new FormData;for(const s of Object.keys(n)){const o=n[s];if(Array.isArray(o))for(const l of o)r.append(s,l);else r.append(s,o)}t.body=r,t.formData=void 0;const i=t.headers.get("Content-Type");i&&i.indexOf("application/x-www-form-urlencoded")!==-1?t.body=new URLSearchParams(r).toString():i&&i.indexOf("multipart/form-data")!==-1&&t.headers.delete("Content-Type")}return e(t)}}}const en="setClientRequestIdPolicy";function tn(t="x-ms-client-request-id"){return{name:en,async sendRequest(e,n){return e.headers.has(t)||e.headers.set(t,e.requestId),n(e)}}}const z={span:Symbol.for("@azure/core-tracing span"),namespace:Symbol.for("@azure/core-tracing namespace")};function nn(t={}){let e=new I(t.parentContext);return t.span&&(e=e.setValue(z.span,t.span)),t.namespace&&(e=e.setValue(z.namespace,t.namespace)),e}class I{constructor(e){this._contextMap=e instanceof I?new Map(e._contextMap):new Map}setValue(e,n){const r=new I(this);return r._contextMap.set(e,n),r}getValue(e){return this._contextMap.get(e)}deleteValue(e){const n=new I(this);return n._contextMap.delete(e),n}}function rn(){return{end:()=>{},isRecording:()=>!1,recordException:()=>{},setAttribute:()=>{},setStatus:()=>{}}}function sn(){return{createRequestHeaders:()=>({}),parseTraceparentHeader:()=>{},startSpan:(t,e)=>({span:rn(),tracingContext:nn({parentContext:e.tracingContext})}),withContext(t,e,...n){return e(...n)}}}let Y;function q(){return Y||(Y=sn()),Y}function on(t){const{namespace:e,packageName:n,packageVersion:r}=t;function i(a,u,d){var f;const h=q().startSpan(a,Object.assign(Object.assign({},d),{packageName:n,packageVersion:r,tracingContext:(f=u==null?void 0:u.tracingOptions)===null||f===void 0?void 0:f.tracingContext}));let m=h.tracingContext;const y=h.span;m.getValue(z.namespace)||(m=m.setValue(z.namespace,e)),y.setAttribute("az.namespace",m.getValue(z.namespace));const p=Object.assign({},u,{tracingOptions:Object.assign(Object.assign({},u==null?void 0:u.tracingOptions),{tracingContext:m})});return{span:y,updatedOptions:p}}async function s(a,u,d,f){const{span:h,updatedOptions:m}=i(a,u,f);try{const y=await o(m.tracingOptions.tracingContext,()=>Promise.resolve(d(m,h)));return h.setStatus({status:"success"}),y}catch(y){throw h.setStatus({status:"error",error:y}),y}finally{h.end()}}function o(a,u,...d){return q().withContext(a,u,...d)}function l(a){return q().parseTraceparentHeader(a)}function c(a){return q().createRequestHeaders(a)}return{startSpan:i,withSpan:s,withContext:o,parseTraceparentHeader:l,createRequestHeaders:c}}const an={},ln=new ke;class R extends Error{constructor(e,n={}){super(e),this.name="RestError",this.code=n.code,this.statusCode=n.statusCode,this.request=n.request,this.response=n.response,Object.setPrototypeOf(this,R.prototype)}[an](){return`RestError: ${this.message} 
 ${ln.sanitize(this)}`}}R.REQUEST_SEND_ERROR="REQUEST_SEND_ERROR";R.PARSE_ERROR="PARSE_ERROR";function cn(t){return t instanceof R?!0:fe(t)&&t.name==="RestError"}const un="tracingPolicy";function dn(t={}){const e=qe(t.userAgentPrefix),n=fn();return{name:un,async sendRequest(r,i){var s,o;if(!n||!(!((s=r.tracingOptions)===null||s===void 0)&&s.tracingContext))return i(r);const{span:l,tracingContext:c}=(o=mn(n,r,e))!==null&&o!==void 0?o:{};if(!l||!c)return i(r);try{const a=await n.withContext(c,i,r);return yn(l,a),a}catch(a){throw hn(l,a),a}}}}function fn(){try{return on({namespace:"",packageName:"@azure/core-rest-pipeline",packageVersion:Ve})}catch(t){$.warning(`Error when creating the TracingClient: ${Q(t)}`);return}}function mn(t,e,n){try{const{span:r,updatedOptions:i}=t.startSpan(`HTTP ${e.method}`,{tracingOptions:e.tracingOptions},{spanKind:"client",spanAttributes:{"http.method":e.method,"http.url":e.url,requestId:e.requestId}});if(!r.isRecording()){r.end();return}n&&r.setAttribute("http.user_agent",n);const s=t.createRequestHeaders(i.tracingOptions.tracingContext);for(const[o,l]of Object.entries(s))e.headers.set(o,l);return{span:r,tracingContext:i.tracingOptions.tracingContext}}catch(r){$.warning(`Skipping creating a tracing span due to an error: ${Q(r)}`);return}}function hn(t,e){try{t.setStatus({status:"error",error:fe(e)?e:void 0}),cn(e)&&e.statusCode&&t.setAttribute("http.status_code",e.statusCode),t.end()}catch(n){$.warning(`Skipping tracing span processing due to an error: ${Q(n)}`)}}function yn(t,e){try{t.setAttribute("http.status_code",e.status);const n=e.headers.get("x-ms-request-id");n&&t.setAttribute("serviceRequestId",n),t.setStatus({status:"success"}),t.end()}catch(n){$.warning(`Skipping tracing span processing due to an error: ${Q(n)}`)}}function pn(t){const e=Pt();return e.addPolicy(Zt()),e.addPolicy(Ut(t.userAgentOptions)),e.addPolicy(tn()),e.addPolicy(Gt(t.retryOptions),{phase:"Retry"}),e.addPolicy(dn(t.userAgentOptions),{afterPhase:"Retry"}),e.addPolicy(Nt(t.loggingOptions),{afterPhase:"Sign"}),e}function H(t){return t.toLowerCase()}function*gn(t){for(const e of t.values())yield[e.name,e.value]}class wn{constructor(e){if(this._headersMap=new Map,e)for(const n of Object.keys(e))this.set(n,e[n])}set(e,n){this._headersMap.set(H(e),{name:e,value:String(n)})}get(e){var n;return(n=this._headersMap.get(H(e)))===null||n===void 0?void 0:n.value}has(e){return this._headersMap.has(H(e))}delete(e){this._headersMap.delete(H(e))}toJSON(e={}){const n={};if(e.preserveCase)for(const r of this._headersMap.values())n[r.name]=r.value;else for(const[r,i]of this._headersMap)n[r]=i.value;return n}toString(){return JSON.stringify(this.toJSON({preserveCase:!0}))}[Symbol.iterator](){return gn(this._headersMap)}}function Fe(t){return new wn(t)}function bn(t){return t&&typeof t.pipe=="function"}function Ke(t){return!!(t&&typeof t.getReader=="function"&&typeof t.tee=="function")}class xn{async sendRequest(e){if(new URL(e.url).protocol!=="https:"&&!e.allowInsecureConnection)throw new Error(`Cannot connect to ${e.url} while allowInsecureConnection is false.`);if(e.proxySettings)throw new Error("HTTP proxy is not supported in browser environment");try{return await Pn(e)}catch(i){throw Sn(i,e)}}}async function Pn(t){const{abortController:e,abortControllerCleanup:n}=Rn(t);try{const r=Cn(t.headers),i=An(t),s=await fetch(t.url,{body:i,method:t.method,headers:r,signal:e.signal,credentials:t.withCredentials?"include":"same-origin",cache:"no-store"});return vn(s,t)}finally{n&&n()}}async function vn(t,e){var n,r;const i=En(t),s={request:e,headers:i,status:t.status},o=Ke(t.body)?We(t.body,e.onDownloadProgress):t.body;if(!((n=e.streamResponseStatusCodes)===null||n===void 0)&&n.has(Number.POSITIVE_INFINITY)||!((r=e.streamResponseStatusCodes)===null||r===void 0)&&r.has(s.status))if(e.enableBrowserStreams)s.browserStreamBody=o??void 0;else{const l=new Response(o);s.blobBody=l.blob()}else{const l=new Response(o);s.bodyAsText=await l.text()}return s}function Rn(t){const e=new AbortController;let n,r;if(t.abortSignal){if(t.abortSignal.aborted)throw new de("The operation was aborted.");r=i=>{i.type==="abort"&&e.abort()},t.abortSignal.addEventListener("abort",r),n=()=>{var i;r&&((i=t.abortSignal)===null||i===void 0||i.removeEventListener("abort",r))}}return t.timeout>0&&setTimeout(()=>{e.abort()},t.timeout),{abortController:e,abortControllerCleanup:n}}function Sn(t,e){var n;return t&&(t==null?void 0:t.name)==="AbortError"?t:new R(`Error sending request: ${t.message}`,{code:(n=t==null?void 0:t.code)!==null&&n!==void 0?n:R.REQUEST_SEND_ERROR,request:e})}function Cn(t){const e=new Headers;for(const[n,r]of t)e.append(n,r);return e}function En(t){const e=Fe();for(const[n,r]of t.headers)e.set(n,r);return e}function An(t){const e=typeof t.body=="function"?t.body():t.body;if(bn(e))throw new Error("Node streams are not supported in browser environment.");return Ke(e)?We(e,t.onUploadProgress):e}function We(t,e){let n=0;if(Tn(t))return t.pipeThrough(new TransformStream({transform(r,i){if(r===null){i.terminate();return}i.enqueue(r),n+=r.length,e&&e({loadedBytes:n})}}));{const r=t.getReader();return new ReadableStream({async pull(i){var s;const{done:o,value:l}=await r.read();if(o||!l){i.close(),r.releaseLock();return}n+=(s=l==null?void 0:l.length)!==null&&s!==void 0?s:0,i.enqueue(l),e&&e({loadedBytes:n})}})}}function On(){return new xn}function Tn(t){return t.pipeThrough!==void 0&&self.TransformStream!==void 0}function $n(){return On()}var B,Nn=new Uint8Array(16);function Mn(){if(!B&&(B=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!B))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return B(Nn)}const Dn=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function _n(t){return typeof t=="string"&&Dn.test(t)}var P=[];for(var Z=0;Z<256;++Z)P.push((Z+256).toString(16).substr(1));function zn(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=(P[t[e+0]]+P[t[e+1]]+P[t[e+2]]+P[t[e+3]]+"-"+P[t[e+4]]+P[t[e+5]]+"-"+P[t[e+6]]+P[t[e+7]]+"-"+P[t[e+8]]+P[t[e+9]]+"-"+P[t[e+10]]+P[t[e+11]]+P[t[e+12]]+P[t[e+13]]+P[t[e+14]]+P[t[e+15]]).toLowerCase();if(!_n(n))throw TypeError("Stringified UUID is invalid");return n}function In(t,e,n){t=t||{};var r=t.random||(t.rng||Mn)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){n=n||0;for(var i=0;i<16;++i)e[n+i]=r[i];return e}return zn(r)}function Un(){return In()}class Ln{constructor(e){var n,r,i,s,o,l,c;this.url=e.url,this.body=e.body,this.headers=(n=e.headers)!==null&&n!==void 0?n:Fe(),this.method=(r=e.method)!==null&&r!==void 0?r:"GET",this.timeout=(i=e.timeout)!==null&&i!==void 0?i:0,this.formData=e.formData,this.disableKeepAlive=(s=e.disableKeepAlive)!==null&&s!==void 0?s:!1,this.proxySettings=e.proxySettings,this.streamResponseStatusCodes=e.streamResponseStatusCodes,this.withCredentials=(o=e.withCredentials)!==null&&o!==void 0?o:!1,this.abortSignal=e.abortSignal,this.tracingOptions=e.tracingOptions,this.onUploadProgress=e.onUploadProgress,this.onDownloadProgress=e.onDownloadProgress,this.requestId=e.requestId||Un(),this.allowInsecureConnection=(l=e.allowInsecureConnection)!==null&&l!==void 0?l:!1,this.enableBrowserStreams=(c=e.enableBrowserStreams)!==null&&c!==void 0?c:!1}}function kn(t){return new Ln(t)}const Vn={forcedRefreshWindowInMs:1e3,retryIntervalInMs:3e3,refreshWindowInMs:1e3*60*2};async function qn(t,e,n){async function r(){if(Date.now()<n)try{return await t()}catch{return null}else{const s=await t();if(s===null)throw new Error("Failed to refresh access token.");return s}}let i=await r();for(;i===null;)await He(e),i=await r();return i}function Hn(t,e){let n=null,r=null,i;const s=Object.assign(Object.assign({},Vn),e),o={get isRefreshing(){return n!==null},get shouldRefresh(){var c;return!o.isRefreshing&&((c=r==null?void 0:r.expiresOnTimestamp)!==null&&c!==void 0?c:0)-s.refreshWindowInMs<Date.now()},get mustRefresh(){return r===null||r.expiresOnTimestamp-s.forcedRefreshWindowInMs<Date.now()}};function l(c,a){var u;return o.isRefreshing||(n=qn(()=>t.getToken(c,a),s.retryIntervalInMs,(u=r==null?void 0:r.expiresOnTimestamp)!==null&&u!==void 0?u:Date.now()).then(f=>(n=null,r=f,i=a.tenantId,r)).catch(f=>{throw n=null,r=null,i=void 0,f})),n}return async(c,a)=>i!==a.tenantId||!!a.claims||o.mustRefresh?l(c,a):(o.shouldRefresh&&l(c,a),r)}const Bn="bearerTokenAuthenticationPolicy";async function Fn(t){const{scopes:e,getAccessToken:n,request:r}=t,i={abortSignal:r.abortSignal,tracingOptions:r.tracingOptions},s=await n(e,i);s&&t.request.headers.set("Authorization",`Bearer ${s.token}`)}function Kn(t){const e=t.headers.get("WWW-Authenticate");if(t.status===401&&e)return e}function Wn(t){var e;const{credential:n,scopes:r,challengeCallbacks:i}=t,s=t.logger||$,o=Object.assign({authorizeRequest:(e=i==null?void 0:i.authorizeRequest)!==null&&e!==void 0?e:Fn,authorizeRequestOnChallenge:i==null?void 0:i.authorizeRequestOnChallenge},i),l=n?Hn(n):()=>Promise.resolve(null);return{name:Bn,async sendRequest(c,a){if(!c.url.toLowerCase().startsWith("https://"))throw new Error("Bearer token authentication is not permitted for non-TLS protected (non-https) URLs.");await o.authorizeRequest({scopes:Array.isArray(r)?r:[r],request:c,getAccessToken:l,logger:s});let u,d;try{u=await a(c)}catch(f){d=f,u=f.response}if(o.authorizeRequestOnChallenge&&(u==null?void 0:u.status)===401&&Kn(u)&&await o.authorizeRequestOnChallenge({scopes:Array.isArray(r)?r:[r],request:c,response:u,getAccessToken:l,logger:s}))return a(c);if(d)throw d;return u}}}function T(t,e,n){let r=e.parameterPath;const i=e.mapper;let s;if(typeof r=="string"&&(r=[r]),Array.isArray(r)){if(r.length>0)if(i.isConstant)s=i.defaultValue;else{let o=ve(t,r);!o.propertyFound&&n&&(o=ve(n,r));let l=!1;o.propertyFound||(l=i.required||r[0]==="options"&&r.length===2),s=l?i.defaultValue:o.propertyValue}}else{i.required&&(s={});for(const o in r){const l=i.type.modelProperties[o],c=r[o],a=T(t,{parameterPath:c,mapper:l},n);a!==void 0&&(s||(s={}),s[o]=a)}}return s}function ve(t,e){const n={propertyFound:!1};let r=0;for(;r<e.length;++r){const i=e[r];if(t&&i in t)t=t[i];else break}return r===e.length&&(n.propertyValue=t,n.propertyFound=!0),n}const Re=new WeakMap,Xe=Symbol.for("@azure/core-client original request");function Xn(t){return Xe in t}function N(t){if(Xn(t))return N(t[Xe]);let e=Re.get(t);return e||(e={},Re.set(t,e)),e}const jn=["application/json","text/json"],Jn=["application/xml","application/atom+xml"],Qn="deserializationPolicy";function Gn(t={}){var e,n,r,i,s,o,l;const c=(n=(e=t.expectedContentTypes)===null||e===void 0?void 0:e.json)!==null&&n!==void 0?n:jn,a=(i=(r=t.expectedContentTypes)===null||r===void 0?void 0:r.xml)!==null&&i!==void 0?i:Jn,u=t.parseXML,d=t.serializerOptions,f={xml:{rootName:(s=d==null?void 0:d.xml.rootName)!==null&&s!==void 0?s:"",includeRoot:(o=d==null?void 0:d.xml.includeRoot)!==null&&o!==void 0?o:!1,xmlCharKey:(l=d==null?void 0:d.xml.xmlCharKey)!==null&&l!==void 0?l:U}};return{name:Qn,async sendRequest(h,m){const y=await m(h);return er(c,a,y,f,u)}}}function Yn(t){let e;const n=t.request,r=N(n),i=r==null?void 0:r.operationSpec;return i&&(r!=null&&r.operationResponseGetter?e=r==null?void 0:r.operationResponseGetter(i,t):e=i.responses[t.status]),e}function Zn(t){const e=t.request,n=N(e),r=n==null?void 0:n.shouldDeserialize;let i;return r===void 0?i=!0:typeof r=="boolean"?i=r:i=r(t),i}async function er(t,e,n,r,i){const s=await rr(t,e,n,r,i);if(!Zn(s))return s;const o=N(s.request),l=o==null?void 0:o.operationSpec;if(!l||!l.responses)return s;const c=Yn(s),{error:a,shouldReturnResponse:u}=nr(s,l,c,r);if(a)throw a;if(u)return s;if(c){if(c.bodyMapper){let d=s.parsedBody;l.isXML&&c.bodyMapper.type.name===O.Sequence&&(d=typeof d=="object"?d[c.bodyMapper.xmlElementName]:[]);try{s.parsedBody=l.serializer.deserialize(c.bodyMapper,d,"operationRes.parsedBody",r)}catch(f){throw new R(`Error ${f} occurred in deserializing the responseBody - ${s.bodyAsText}`,{statusCode:s.status,request:s.request,response:s})}}else l.httpMethod==="HEAD"&&(s.parsedBody=n.status>=200&&n.status<300);c.headersMapper&&(s.parsedHeaders=l.serializer.deserialize(c.headersMapper,s.headers.toJSON(),"operationRes.parsedHeaders",{xml:{},ignoreUnknownProperties:!0}))}return s}function tr(t){const e=Object.keys(t.responses);return e.length===0||e.length===1&&e[0]==="default"}function nr(t,e,n,r){var i;const s=200<=t.status&&t.status<300;if(tr(e)?s:!!n)if(n){if(!n.isError)return{error:null,shouldReturnResponse:!1}}else return{error:null,shouldReturnResponse:!1};const l=n??e.responses.default,c=!((i=t.request.streamResponseStatusCodes)===null||i===void 0)&&i.has(t.status)?`Unexpected status code: ${t.status}`:t.bodyAsText,a=new R(c,{statusCode:t.status,request:t.request,response:t});if(!l)throw a;const u=l.bodyMapper,d=l.headersMapper;try{if(t.parsedBody){const f=t.parsedBody;let h;if(u){let y=f;if(e.isXML&&u.type.name===O.Sequence){y=[];const p=u.xmlElementName;typeof f=="object"&&p&&(y=f[p])}h=e.serializer.deserialize(u,y,"error.response.parsedBody",r)}const m=f.error||h||f;a.code=m.code,m.message&&(a.message=m.message),u&&(a.response.parsedBody=h)}t.headers&&d&&(a.response.parsedHeaders=e.serializer.deserialize(d,t.headers.toJSON(),"operationRes.parsedHeaders"))}catch(f){a.message=`Error "${f.message}" occurred in deserializing the responseBody - "${t.bodyAsText}" for the default response.`}return{error:a,shouldReturnResponse:!1}}async function rr(t,e,n,r,i){var s;if(!(!((s=n.request.streamResponseStatusCodes)===null||s===void 0)&&s.has(n.status))&&n.bodyAsText){const o=n.bodyAsText,l=n.headers.get("Content-Type")||"",c=l?l.split(";").map(a=>a.toLowerCase()):[];try{if(c.length===0||c.some(a=>t.indexOf(a)!==-1))return n.parsedBody=JSON.parse(o),n;if(c.some(a=>e.indexOf(a)!==-1)){if(!i)throw new Error("Parsing XML not supported.");const a=await i(o,r.xml);return n.parsedBody=a,n}}catch(a){const u=`Error "${a}" occurred while parsing the response body - ${n.bodyAsText}.`,d=a.code||R.PARSE_ERROR;throw new R(u,{code:d,statusCode:n.status,request:n.request,response:n})}}return n}function ir(t){const e=new Set;for(const n in t.responses){const r=t.responses[n];r.bodyMapper&&r.bodyMapper.type.name===O.Stream&&e.add(Number(n))}return e}function C(t){const{parameterPath:e,mapper:n}=t;let r;return typeof e=="string"?r=e:Array.isArray(e)?r=e.join("."):r=n.serializedName,r}const sr="serializationPolicy";function or(t={}){const e=t.stringifyXML;return{name:sr,async sendRequest(n,r){const i=N(n),s=i==null?void 0:i.operationSpec,o=i==null?void 0:i.operationArguments;return s&&o&&(ar(n,o,s),lr(n,o,s,e)),r(n)}}}function ar(t,e,n){var r,i;if(n.headerParameters)for(const o of n.headerParameters){let l=T(e,o);if(l!=null||o.mapper.required){l=n.serializer.serialize(o.mapper,l,C(o));const c=o.mapper.headerCollectionPrefix;if(c)for(const a of Object.keys(l))t.headers.set(c+a,l[a]);else t.headers.set(o.mapper.serializedName||C(o),l)}}const s=(i=(r=e.options)===null||r===void 0?void 0:r.requestOptions)===null||i===void 0?void 0:i.customHeaders;if(s)for(const o of Object.keys(s))t.headers.set(o,s[o])}function lr(t,e,n,r=function(){throw new Error("XML serialization unsupported!")}){var i,s,o,l,c;const a=(i=e.options)===null||i===void 0?void 0:i.serializerOptions,u={xml:{rootName:(s=a==null?void 0:a.xml.rootName)!==null&&s!==void 0?s:"",includeRoot:(o=a==null?void 0:a.xml.includeRoot)!==null&&o!==void 0?o:!1,xmlCharKey:(l=a==null?void 0:a.xml.xmlCharKey)!==null&&l!==void 0?l:U}},d=u.xml.xmlCharKey;if(n.requestBody&&n.requestBody.mapper){t.body=T(e,n.requestBody);const f=n.requestBody.mapper,{required:h,serializedName:m,xmlName:y,xmlElementName:p,xmlNamespace:x,xmlNamespacePrefix:w,nullable:S}=f,g=f.type.name;try{if(t.body!==void 0&&t.body!==null||S&&t.body===null||h){const b=C(n.requestBody);t.body=n.serializer.serialize(f,t.body,b,u);const E=g===O.Stream;if(n.isXML){const M=w?`xmlns:${w}`:"xmlns",D=cr(x,M,g,t.body,u);g===O.Sequence?t.body=r(ur(D,p||y||m,M,x),{rootName:y||m,xmlCharKey:d}):E||(t.body=r(D,{rootName:y||m,xmlCharKey:d}))}else{if(g===O.String&&(!((c=n.contentType)===null||c===void 0)&&c.match("text/plain")||n.mediaType==="text"))return;E||(t.body=JSON.stringify(t.body))}}}catch(b){throw new Error(`Error "${b.message}" occurred in serializing the payload - ${JSON.stringify(m,void 0,"  ")}.`)}}else if(n.formDataParameters&&n.formDataParameters.length>0){t.formData={};for(const f of n.formDataParameters){const h=T(e,f);if(h!=null){const m=f.mapper.serializedName||C(f);t.formData[m]=n.serializer.serialize(f.mapper,h,C(f),u)}}}}function cr(t,e,n,r,i){if(t&&!["Composite","Sequence","Dictionary"].includes(n)){const s={};return s[i.xml.xmlCharKey]=r,s[v]={[e]:t},s}return r}function ur(t,e,n,r){if(Array.isArray(t)||(t=[t]),!n||!r)return{[e]:t};const i={[e]:t};return i[v]={[n]:r},i}function dr(t={}){const e=pn(t??{});return t.credentialOptions&&e.addPolicy(Wn({credential:t.credentialOptions.credential,scopes:t.credentialOptions.credentialScopes})),e.addPolicy(or(t.serializationOptions),{phase:"Serialize"}),e.addPolicy(Gn(t.deserializationOptions),{phase:"Deserialize"}),e}let ee;function fr(){return ee||(ee=$n()),ee}const mr={CSV:",",SSV:" ",Multi:"Multi",TSV:"	",Pipes:"|"};function hr(t,e,n,r){const i=yr(e,n,r);let s=!1,o=Se(t,i);if(e.path){let a=Se(e.path,i);e.path==="/{nextLink}"&&a.startsWith("/")&&(a=a.substring(1)),pr(a)?(o=a,s=!0):o=gr(o,a)}const{queryParams:l,sequenceParams:c}=wr(e,n,r);return o=xr(o,l,c,s),o}function Se(t,e){let n=t;for(const[r,i]of e)n=n.split(r).join(i);return n}function yr(t,e,n){var r;const i=new Map;if(!((r=t.urlParameters)===null||r===void 0)&&r.length)for(const s of t.urlParameters){let o=T(e,s,n);const l=C(s);o=t.serializer.serialize(s.mapper,o,l),s.skipEncoding||(o=encodeURIComponent(o)),i.set(`{${s.mapper.serializedName||l}}`,o)}return i}function pr(t){return t.includes("://")}function gr(t,e){if(!e)return t;const n=new URL(t);let r=n.pathname;r.endsWith("/")||(r=`${r}/`),e.startsWith("/")&&(e=e.substring(1));const i=e.indexOf("?");if(i!==-1){const s=e.substring(0,i),o=e.substring(i+1);r=r+s,o&&(n.search=n.search?`${n.search}&${o}`:o)}else r=r+e;return n.pathname=r,n.toString()}function wr(t,e,n){var r;const i=new Map,s=new Set;if(!((r=t.queryParameters)===null||r===void 0)&&r.length)for(const o of t.queryParameters){o.mapper.type.name==="Sequence"&&o.mapper.serializedName&&s.add(o.mapper.serializedName);let l=T(e,o,n);if(l!=null||o.mapper.required){l=t.serializer.serialize(o.mapper,l,C(o));const c=o.collectionFormat?mr[o.collectionFormat]:"";if(Array.isArray(l)&&(l=l.map(a=>a??"")),o.collectionFormat==="Multi"&&l.length===0)continue;Array.isArray(l)&&(o.collectionFormat==="SSV"||o.collectionFormat==="TSV")&&(l=l.join(c)),o.skipEncoding||(Array.isArray(l)?l=l.map(a=>encodeURIComponent(a)):l=encodeURIComponent(l)),Array.isArray(l)&&(o.collectionFormat==="CSV"||o.collectionFormat==="Pipes")&&(l=l.join(c)),i.set(o.mapper.serializedName||C(o),l)}}return{queryParams:i,sequenceParams:s}}function br(t){const e=new Map;if(!t||t[0]!=="?")return e;t=t.slice(1);const n=t.split("&");for(const r of n){const[i,s]=r.split("=",2),o=e.get(i);o?Array.isArray(o)?o.push(s):e.set(i,[o,s]):e.set(i,s)}return e}function xr(t,e,n,r=!1){if(e.size===0)return t;const i=new URL(t),s=br(i.search);for(const[l,c]of e){const a=s.get(l);if(Array.isArray(a))if(Array.isArray(c)){a.push(...c);const u=new Set(a);s.set(l,Array.from(u))}else a.push(c);else a?(Array.isArray(c)?c.unshift(a):n.has(l)&&s.set(l,[a,c]),r||s.set(l,c)):s.set(l,c)}const o=[];for(const[l,c]of s)if(typeof c=="string")o.push(`${l}=${c}`);else if(Array.isArray(c))for(const a of c)o.push(`${l}=${a}`);else o.push(`${l}=${c}`);return i.search=o.length?`?${o.join("&")}`:"",i.toString()}const Pr=ue("core-client");class Tr{constructor(e={}){var n,r;if(this._requestContentType=e.requestContentType,this._endpoint=(n=e.endpoint)!==null&&n!==void 0?n:e.baseUri,e.baseUri&&Pr.warning("The baseUri option for SDK Clients has been deprecated, please use endpoint instead."),this._allowInsecureConnection=e.allowInsecureConnection,this._httpClient=e.httpClient||fr(),this.pipeline=e.pipeline||vr(e),!((r=e.additionalPolicies)===null||r===void 0)&&r.length)for(const{policy:i,position:s}of e.additionalPolicies){const o=s==="perRetry"?"Sign":void 0;this.pipeline.addPolicy(i,{afterPhase:o})}}async sendRequest(e){return this.pipeline.sendRequest(this._httpClient,e)}async sendOperationRequest(e,n){const r=n.baseUrl||this._endpoint;if(!r)throw new Error("If operationSpec.baseUrl is not specified, then the ServiceClient must have a endpoint string property that contains the base URL to use.");const i=hr(r,n,e,this),s=kn({url:i});s.method=n.httpMethod;const o=N(s);o.operationSpec=n,o.operationArguments=e;const l=n.contentType||this._requestContentType;l&&n.requestBody&&s.headers.set("Content-Type",l);const c=e.options;if(c){const a=c.requestOptions;a&&(a.timeout&&(s.timeout=a.timeout),a.onUploadProgress&&(s.onUploadProgress=a.onUploadProgress),a.onDownloadProgress&&(s.onDownloadProgress=a.onDownloadProgress),a.shouldDeserialize!==void 0&&(o.shouldDeserialize=a.shouldDeserialize),a.allowInsecureConnection&&(s.allowInsecureConnection=!0)),c.abortSignal&&(s.abortSignal=c.abortSignal),c.tracingOptions&&(s.tracingOptions=c.tracingOptions)}this._allowInsecureConnection&&(s.allowInsecureConnection=!0),s.streamResponseStatusCodes===void 0&&(s.streamResponseStatusCodes=ir(n));try{const a=await this.sendRequest(s),u=he(a,n.responses[a.status]);return c!=null&&c.onResponse&&c.onResponse(a,u),u}catch(a){if(typeof a=="object"&&(a!=null&&a.response)){const u=a.response,d=he(u,n.responses[a.statusCode]||n.responses.default);a.details=d,c!=null&&c.onResponse&&c.onResponse(u,d,a)}throw a}}}function vr(t){const e=Rr(t),n=t.credential&&e?{credentialScopes:e,credential:t.credential}:void 0;return dr(Object.assign(Object.assign({},t),{credentialOptions:n}))}function Rr(t){if(t.credentialScopes){const e=t.credentialScopes;return Array.isArray(e)?e.map(n=>new URL(n).toString()):new URL(e).toString()}if(t.endpoint)return`${t.endpoint}/.default`;if(t.baseUri)return`${t.baseUri}/.default`;if(t.credential&&!t.credentialScopes)throw new Error("When using credentials, the ServiceClientOptions must contain either a endpoint or a credentialScopes. Unable to create a bearerTokenAuthenticationPolicy")}export{de as A,Tr as S,Wn as a,Bn as b,Cr as c,ue as d,on as e,kn as f,Fe as g,Ar as h,Er as i,Sr as j,Pr as l,In as v};
//# sourceMappingURL=serviceClient-476df90b.js.map
