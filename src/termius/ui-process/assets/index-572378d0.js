import{a0 as w,b0 as h,a6 as y,aa as p}from"./reconnectSaga-e33541d6.js";import{i as d,s as I}from"./splitAtFirst-6f6946f9.js";const S=w("@termius/registry-js"),{enumerateKeys:g,enumerateValues:O,HKEY:P}=S;function a(t){return t.replace(/\\(.)/g,"$1")}function m(t,e){return{address:N(s(e,"HostName")??""),label:t,sshConfig:C(e),telnetConfig:T(e),identity:R(e),pfRules:W(t,e),hostChain:[],identityFile:b(e)}}function T(t){return t.get("Protocol")==="telnet"?{port:u(i(t,"PortNumber"),23),charset:f(t)}:void 0}function C(t){return t.get("Protocol")==="ssh"?{port:u(i(t,"PortNumber"),22),agent_forwarding:u(x(t,"AgentFwd"),!1),env_variables:L(t),proxy:V(t),charset:f(t)}:void 0}function L(t){const e=s(t,"Environment");return e?e.split(new RegExp("(?<!\\\\),")).map(n=>n.split(new RegExp("(?<!\\\\)="))).filter(d).map(([n,o])=>({name:a(n),value:a(o)})):void 0}function V(t){const e=new Map([[1,"socks"],[2,"socks"],[3,"http"]]),n=i(t,"ProxyMethod")??0,o=e.get(n),r=s(t,"ProxyHost");return o!=null&&r?{type:o,hostname:r,port:i(t,"ProxyPort"),identity:E(t)}:void 0}function E(t){const e=s(t,"ProxyUsername"),n=s(t,"ProxyPassword");return e||n?{is_visible:!1,username:e,password:n}:void 0}function R(t){return{is_visible:!1,username:s(t,"UserName")}}function W(t,e){const n=s(e,"PortForwardings");return n?n.split(new RegExp("(?<!\\\\),")).flatMap(o=>{const r=o.match(/([LRD])(\d+)=(?:(?:(?:\[(.+)\])|(.+)):(\d+))?/);return r==null?[]:[{pf_type:new Map([["L","Local Rule"],["R","Remote Rule"],["D","Dynamic Rule"]]).get(r[1])??"Local Rule",host_label:t,local_port:Number.parseInt(r[2],10),hostname:r[3]??r[4]??"127.0.0.1",remote_port:Number.parseInt(r[5]??"0",10),bound_address:void 0}]}):[]}function b(t){const e=s(t,"PublicKeyFile");return e?{path:e}:void 0}function f(t){return new Map([["ISO-8859-1:1998 (Latin-1, West Europe)","ISO-8859-1"],["ISO-8859-2:1999 (Latin-2, East Europe)","ISO-8859-2"],["ISO-8859-3:1999 (Latin-3, South Europe)","ISO-8859-3"],["ISO-8859-4:1998 (Latin-4, North Europe)","ISO-8859-4"],["ISO-8859-5:1999 (Latin/Cyrillic)","ISO-8859-5"],["ISO-8859-6:1999 (Latin/Arabic)","ISO-8859-6"],["ISO-8859-7:1987 (Latin/Greek)","ISO-8859-7"],["ISO-8859-8:1999 (Latin/Hebrew)","ISO-8859-8"],["ISO-8859-9:1999 (Latin-5, Turkish)","ISO-8859-9"],["ISO-8859-10:1998 (Latin-6, Nordic)","ISO-8859-10"],["ISO-8859-11:2001 (Latin/Thai)","ISO-8859-11"],["ISO-8859-13:1998 (Latin-7, Baltic)","ISO-8859-13"],["ISO-8859-14:1998 (Latin-8, Celtic)","ISO-8859-14"],['ISO-8859-15:1999 (Latin-9, "euro")',"ISO-8859-15"],["ISO-8859-16:2001 (Latin-10, Balkan)","ISO-8859-16"],["KOI8-U","KOI8-U"],["KOI8-R","KOI8-R"],["Win1250 (Central European)","windows-1250"],["Win1251 (Cyrillic)","windows-1251"],["Win1252 (Western)","windows-1252"],["Win1253 (Greek)","windows-1253"],["Win1254 (Turkish)","windows-1254"],["Win1255 (Hebrew)","windows-1255"],["Win1256 (Arabic)","windows-1256"],["Win1257 (Baltic)","windows-1257"],["Win1258 (Vietnamese)","windows-1258"],["CP437","CP437"],["CP852","CP852"]]).get(s(t,"LineCodePage")??"")}function N(t){if(t.length!==0)return t;throw new Error("Empty string")}function s(t,e){const n=t.get(e);return n!=null&&typeof n=="string"?n:void 0}function i(t,e){const n=t.get(e);return n!=null&&typeof n=="number"?n:void 0}function x(t,e){const n=i(t,e);return n!=null?n!==0:void 0}function u(t,e){return t===e?void 0:t}const c=P.HKEY_CURRENT_USER,l="SOFTWARE\\SimonTatham\\PuTTY\\Sessions";async function D(){if(!h)throw new Error("Non-windows platforms are not supported");const t=H(c,l).map(e=>[e,new Map(M(c,`${l}\\${e}`).map(n=>[n.name,n.data]))]).flatMap(([e,n])=>{try{return[m(decodeURIComponent(e),n)]}catch{return[]}});return{groups:[],snippets:[],hosts:t,tags:[],knownHosts:[]}}async function $(t){const e=t.split(/(\r\n){2,}/).map(n=>n.split(`\r
`)).filter(n=>n.length!==0&&v(n[0])).map(n=>[F(n[0]),K(n.slice(1))]).flatMap(([n,o])=>{try{return[m(decodeURIComponent(n),o)]}catch{return[]}});return{groups:[],snippets:[],hosts:e,tags:[],knownHosts:[]}}function v(t){return t.toLowerCase().startsWith(`[${c}\\${l}\\`.toLowerCase())}function F(t){return y(t.slice(1,-1).split("\\"))??""}function K(t){return new Map(t.map(e=>I(e,"=")).filter(d).map(([e,n])=>[_(e),k(n)]))}function _(t){return a(t.slice(1,-1))}function k(t){return t.startsWith("dword:")?Number.parseInt(t.slice(6),16):t.startsWith('"')?a(t.slice(1,-1)):t}function H(t,e){try{return g(t,e)}catch(n){return p.exception("Failed to enumerate regedit keys",n),[]}}function M(t,e){try{return O(t,e)}catch(n){return p.exception("Failed to enumerate regedit values",n),[]}}export{D as autoImportPuttyConfig,$ as parsePuttyConfig};
//# sourceMappingURL=index-572378d0.js.map
