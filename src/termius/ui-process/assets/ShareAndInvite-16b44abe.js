import{bi as _,ga as k,bN as $,xU as ie,bl as a,bq as r,bn as e,bR as I,bS as N,bT as L,bV as re,bg as z,r as f,ys as se,br as T,bs as v,va as oe,fA as K,co as H,cH as U,jm as j,d3 as q,dL as ce,aV as le,xg as W,bh as de,cy as he,qa as me,yt as pe,c0 as M,ee as G,xy as ue,kv as ge,yu as ve,eB as xe,p2 as Se,bW as fe,xd as A,wR as Ce,mD as Ae,xx as be}from"./reconnectSaga-e33541d6.js";import{M as ye,A as Ie}from"./AuthorizationForm-e3585f38.js";import{R as Te,a as V}from"./RadioOptionsList-4f548194.js";import{r as _e}from"./removeElementByIndex-6c99a5b8.js";import{S as P}from"./ShareCredentialsDetails-684f97ba.js";import{S as we}from"./SuccessScreen-a84e493e.js";import{u as Oe}from"./fadeIn-42e8fead.js";import{S as De}from"./SuccessStep-55a8fb83.js";import"./OTPToken-edbf83c6.js";import"./InputDialog-d2455e55.js";import"./AlertDialog-7dd4d593.js";import"./Button-6ec360d1.js";import"./PasswordInput-42a10483.js";import"./OtpLogin-b63eb22b.js";import"./DialogPanel-51ce90d1.js";const Ee=s=>{const{invites:n}=s,c=_(k),l=_($),d=ie(s.invites,2);return a(r,{flexDirection:"row",children:[e(r,{marginRight:"-5px",zIndex:2,children:e(I,{isActive:!0,color:N(c,l??0),letter:L({email:c})})}),e(r,{flexDirection:"row-reverse",children:d.map((t,i)=>e(I,{color:N(t.email,i??0),letter:L({email:t.email})}))}),n.length>2&&e(re,{position:"relative",right:"5px",children:e(I,{letter:(n.length+1).toString()})})]})},Ne=s=>{const{hasSharingSelector:n=!0,numberOfSharedItems:c,onCancel:l,onSubmit:d}=s,{classes:t,cx:i}=Le(),C=f.useRef(null),b=f.useRef(null),h=f.useRef(null),[o,S]=f.useState("credentials"),p=o==="credentials",u=o==="invites",[g,w]=f.useState(s.invites),[x,Y]=f.useState(s.credentialsMode),[O,R]=f.useState({email:"",role:"Editor"}),D=_(k),Z=_($),y=g.length!==0,J=!!g.length&&p,F=()=>{if(O.email===D){R({email:"",role:"Editor"});return}O.email.length!==0&&w(ce([...g,O],"email")),R({email:"",role:"Editor"})},Q=m=>{const{key:E}=m;E==="Enter"&&(m.preventDefault(),F())},X=m=>{R({email:m.email,role:"Editor"})},ee=()=>n?y?!x&&p:!x||u:!y,te=()=>!n||!x&&p&&y?"Done":!x||!y&&p?"Next":"Done",ne=()=>{if(!n){d(g,"no_credentials_sharing");return}if(x&&!y&&p){S("invites");return}if(!x&&u&&y){S("credentials");return}d(g,x)},B=a(r,{padding:"0px 20px",bgcolor:n?"var(--background)":"var(--foreground)",borderRadius:g.length?"0px":"0px 0px 10px 10px",children:[a(r,{flexDirection:"row",width:"100%",gap:"10px",paddingBottom:"20px",ref:C,children:[e(se,{onKeyUp:Q,email:O.email,onChange:X}),e(T,{onClick:F,color:"accent",children:"Add"})]}),e(v,{variant:"subtitle1",color:"main",children:"People with access to the team vault"}),e("div",{className:i(t.teamListWrapper,{[t.increasedHeight]:!n,[t.stretchableHeight]:g.length>1&&n,[t.teamListHasCredentialsMode]:n}),children:a(r,{gap:"6px",marginTop:"2px",paddingBottom:"10px",children:[e(r,{flexDirection:"row",alignItems:"center",justifyContent:"space-between",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",width:"100%",height:"30px",className:t.item,children:a(r,{direction:"row",alignItems:"center",children:[e(I,{isActive:!0,color:N(D,Z??0),letter:L({email:D})}),e(v,{className:t.memberTitle,color:"main",fontSize:14,children:D})]})}),e(r,{gap:"6px",ref:b,children:g.map((m,E)=>a(r,{flexDirection:"row",alignItems:"center",justifyContent:"space-between",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",width:"100%",height:"30px",className:t.item,children:[a(r,{direction:"row",alignItems:"center",children:[e(I,{color:N(m.email,E??0),letter:L({email:m.email})}),e(v,{className:t.memberTitle,color:"main",fontSize:14,ellipsis:!0,children:m.email})]}),e(r,{onClick:()=>w(_e(g,E)),children:e(oe,{width:"14px",height:"14px",className:t.removeIcon})})]},m.email))})]})})]}),ae=f.useRef(null);return K(()=>{var m;(m=ae.current)==null||m.focus()}),a(r,{ref:h,justifyContent:"space-between",height:"100%",className:i({[t.rootHasCredentialsMode]:n,[t.rootNoCredentialsMode]:!n}),children:[a(r,{maxHeight:"466px",paddingTop:"40px",className:i({[t.mainPartHasCredentialsMode]:n,[t.mainPartNoCredentialsMode]:!n}),children:[e(v,{variant:"h2",color:"main",align:"center",children:`Move ${H("item",c,!0)} to the Team Vault`}),a(r,{justifyContent:"space-between",padding:"20px 40px 40px 40px",gap:"20px",className:i({[t.stepsWrapperHasCredentialsMode]:n,[t.stepsWrapperNoCredentialsMode]:!n}),children:[n&&a("div",{className:i({[t.activeStep]:p}),children:[a("div",{className:i(t.step,{[t.noBorder]:p,[t.onHover]:u}),onClick:()=>{S(p?"invites":"credentials")},children:[a(r,{flexDirection:"row",alignItems:"center",children:[a(v,{variant:"body1",color:"main",display:"inline",children:[a(v,{bold:!0,display:"inline",children:["Step 1:"," "]}),"select what access is used in your team"]}),"Â ",x&&u&&e(v,{variant:"body1",color:"secondary",children:x==="credentials_sharing"?" - shared credentials":" - private credentials"})]}),e(U,{className:i(t.chevron,{[t.chevronOpened]:p})})]}),e(j,{in:p,children:a(Te,{className:t.optionsList,"aria-label":"Credentials mode",onChange:m=>{Y(m.target.value)},value:x,children:[e(V,{id:"credentials_sharing",value:"credentials_sharing",label:"Members share one set of credentials",children:e(P,{mode:"credentials_sharing",variant:"shareAndInviteDialog"})},"credentials_sharing"),e(V,{id:"no_credentials_sharing",value:"no_credentials_sharing",label:"Members use their own credentials",children:e(P,{mode:"no_credentials_sharing",variant:"shareAndInviteDialog"})},"no_credentials_sharing")]})})]}),n&&a(r,{gap:"20px",maxHeight:"249px",className:i(t.credentialsSection,{[t.activeStep]:u}),children:[a("div",{className:i(t.step,{[t.noBorder]:u,[t.onHover]:p}),onClick:()=>{S(u?"credentials":"invites")},children:[a(v,{variant:"body1",color:"main",display:"inline",children:[a(v,{bold:!0,display:"inline",children:["Step 2:"," "]}),"invite people to your team"]}),a(r,{flexDirection:"row",alignItems:"center",gap:"20px",children:[J&&e(Ee,{invites:g}),e(U,{className:i(t.chevron,{[t.chevronOpened]:u})})]})]}),e(j,{in:u,children:B})]}),!n&&B]})]}),a(q,{className:i(t.bottomButtons,{[t.bottomButtonsHasCredentialsMode]:n}),children:[e(T,{color:"regular",variant:"text",onClick:l,children:"Cancel"}),e(T,{disabled:ee(),onClick:ne,color:"accent",children:te()})]})]})},Le=z()((s,n,c)=>({item:{},rootHasCredentialsMode:{"@media (max-height: 530px)":{justifyContent:"space-around"}},rootNoCredentialsMode:{"@media (max-height: 530px)":{justifyContent:"normal",height:"100vh"}},mainPartHasCredentialsMode:{"@media (max-height: 530px)":{display:"flex",flexDirection:"column",paddingTop:"4vh",maxHeight:"75vh"},"@media (max-height: 480px)":{maxHeight:"65vh"}},mainPartNoCredentialsMode:{"@media (max-height: 480px)":{paddingTop:"65px"}},stepsWrapperHasCredentialsMode:{"@media (max-height: 480px)":{padding:"20px"}},stepsWrapperNoCredentialsMode:{padding:"20px 40px 0px "},teamListWrapper:{width:"615px",minHeight:"106px",maxHeight:"147px",overflowY:"scroll",marginTop:"5px",paddingRight:"15px",transition:"all 0.3s ease"},optionsList:{padding:"0 20px 20px"},stretchableHeight:{minHeight:"147px",transition:"all 0.3s ease"},teamListHasCredentialsMode:{"@media (max-height: 530px)":{maxHeight:"0",minHeight:"24.5vh"},"@media (max-height: 480px)":{maxHeight:"0",minHeight:"19.5vh"}},increasedHeight:{maxHeight:"288px","@media (max-height: 530px)":{maxHeight:"0",minHeight:"54.5vh"},"@media (max-height: 480px)":{minHeight:"49vh"}},memberTitle:{marginLeft:"8px",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"493px"},step:{height:"61px",padding:"20px",display:"flex",alignItems:"center",justifyContent:"space-between",border:"1px solid var(--card-b)",borderRadius:"10px",cursor:"pointer",".termius-dark-theme &":{borderColor:"var(--card-c)"}},credentialsSection:{transition:"all 0.25s"},activeStep:{gap:"0px",background:"var(--background)",transition:"all 0.25s",borderRadius:"10px"},noBorder:{border:"none"},onHover:{"&:hover":{background:"var(--card-b)",".termius-dark-theme &":{background:"var(--card-c)",borderColor:"var(--card-c)"}}},chevron:{width:"11px",height:"7px",fill:"var(--main)",transition:"transform 0.2s",color:"var(--main)","&:hover":{color:"var(--accent)",".termius-dark-theme &":{color:"var(--accent)"}}},chevronOpened:{transform:"rotate(180deg)"},bottomButtons:{width:"100%",minHeight:"74px",justifyContent:"space-between",borderTop:"1px solid var(--card-b)",padding:"0 20px",".termius-dark-theme &":{borderColor:"var(--card-c)"}},bottomButtonsHasCredentialsMode:{"@media (max-height: 530px)":{minHeight:"14vh"}},removeIcon:{display:"none",color:"var(--secondary)",cursor:"pointer","&:hover":{color:"var(--red)"},[`.${c.item}:hover &`]:{display:"block"}}})),Re=s=>{const{onCloseDialog:n,entitiesToShare:c,entryPointForAnalytics:l,teamTrialFunnelID:d}=s,t=de(),i=he(),C=_(k),[b,h,o]=me(Me,{context:{flowType:C?"authorized":"signUp"},actions:{onDismiss:()=>{n()},onCloseAllRelatedDialogs:()=>{t(pe("ShareAndInvite"))},sendSuccessSharingAnalytics:()=>{t(M("createTeamWizardViewOpened",{createTeamWizardStep:"Success",openedFrom:l,teamTrialFunnelID:d,trial:"yes"}))},sendAnalyticsOnAuthorizationFlowOpened:()=>{t(M("createTeamWizardViewOpened",{createTeamWizardStep:"Create Account",openedFrom:l,teamTrialFunnelID:d,trial:"yes"}))},sendAnalyticsOnTeamWizardOpened:()=>{t(M("createTeamWizardViewOpened",{createTeamWizardStep:"Invite Members",openedFrom:l,teamTrialFunnelID:d,trial:"yes"}))}},services:{createTeamAndShareData:async S=>{await G(i,ue,{createTeam:!0,teamName:"My Team",force2fa:!1,invites:S.invites}),await G(i,ve,{entities:c,targetState:{...ge,credentials_mode:S.credentialsMode==="credentials_sharing"?"credentials_sharing":"no_credentials_sharing"}})}}});return[b,h,o]},Me=le({id:"shareAndInviteFlow",initial:"introScreen",predictableActionArguments:!0,preserveActionOrder:!0,schema:{context:{},events:{},services:{}},tsTypes:{},context:{flowType:"authorized",credentialsMode:null,invites:[]},on:{CLOSE_DIALOG:{actions:"onDismiss"}},states:{introScreen:{on:{GO_TO_AUTHORIZATION_FLOW:{target:"authorizationFlow",cond:"isUnauthorizedFlow"},HANDLE_CONTINUE_BUTTON_CLICK:[{cond:"isUnauthorizedFlow",target:"authorizationFlow"},{target:"shareAndInvite"}]}},authorizationFlow:{entry:"sendAnalyticsOnAuthorizationFlowOpened",on:{GO_TO_INTRO_SCREEN:{target:"introScreen"},GO_TO_SHARE_AND_INVITE_FLOW:{target:"shareAndInvite"},CLOSE_ALL_RELATED_DIALOGS:{actions:"onCloseAllRelatedDialogs"}}},shareAndInvite:{entry:"sendAnalyticsOnTeamWizardOpened",on:{CHANGE_CREDENTIALS_MODE:{actions:"setCredentialsMode"},SUBMIT_DATA:{target:"submittingData"},UPDATE_INVITES:{actions:"setInvites"}}},errorScreen:{on:{GO_TO_SHARE_AND_INVITE_FLOW:{target:"shareAndInvite"},SUBMIT_DATA:{target:"submittingData"}}},submittingData:{tags:"submitting",invoke:{src:"createTeamAndShareData",onDone:[{actions:"sendSuccessSharingAnalytics",cond:"isUnauthorizedFlow",target:"authorizationSuccessScreen"},{actions:"sendSuccessSharingAnalytics",target:"sharingSuccessScreen"}],onError:[{target:"errorScreen"}]}},authorizationSuccessScreen:{on:{CLOSE_ALL_RELATED_DIALOGS:{actions:"onCloseAllRelatedDialogs"}}},sharingSuccessScreen:{on:{CLOSE_ALL_RELATED_DIALOGS:{actions:"onCloseAllRelatedDialogs"}}}}},{guards:{isUnauthorizedFlow:s=>s.flowType==="signUp"||s.flowType==="logIn"},actions:{setCredentialsMode:W({credentialsMode:(s,{data:n})=>n}),setInvites:W({invites:(s,{data:n})=>n})}}),He=s=>{const{onClose:n,numberOfSharedItems:c}=s,l="Team Vault has been configured",d=`${H("item",c,!0)} ${H("have",c,!1)} been moved to the team vault successfully`;return e(we,{title:l,description:d,onClose:n})},ke=s=>{const{onClose:n,onContinue:c}=s,{classes:l}=ze(),d={enter:"enter"},t={enter:c},i=f.useRef(null);return K(()=>{var C;(C=i.current)==null||C.focus()}),e(xe.HotKeys,{className:l.root,keyMap:d,handlers:t,innerRef:i,children:a(r,{width:"100%",height:"100%",justifyContent:"space-between",alignItems:"center",children:[a(r,{height:"100%",alignItems:"center",justifyContent:"center",gap:"20px",children:[a(r,{alignItems:"center",gap:"10px",children:[e(ye,{}),e(v,{variant:"h2",color:"primary",children:"Set up your team vault"})]}),a(v,{align:"center",variant:"body1",color:"secondary",children:["Securely share data via team vaults to boost your team's productivity.",e("br",{}),"Ensure everyone in your team is always on the same page."]})]}),a(q,{className:l.buttons,children:[e(T,{color:"regular",variant:"text",onClick:n,children:"Cancel"}),e(T,{onClick:c,color:"accent",children:"Start setup"})]})]})})},ze=z()({root:{width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center","@media (max-height: 520px)":{minHeight:"100vh"}},buttons:{width:"100%",minHeight:"74px",justifyContent:"space-between",borderTop:"1px solid var(--card-b)",padding:"0 20px",".termius-dark-theme &":{borderColor:"var(--card-c)"}}}),Fe=s=>{const{closeDialog:n,hasSharingSelector:c=!0,teamTrialFunnelID:l,entryPointForAnalytics:d,...t}=s,{classes:i}=Be(),C=Oe(t),b=Object.values(s.entitiesToShare).flat(),[h,o]=Re({onCloseDialog:()=>{n()},entitiesToShare:b,entryPointForAnalytics:d,teamTrialFunnelID:l}),{invites:S,credentialsMode:p}=h.context,u=b.length;return e(Se.div,{style:C,children:e(r,{width:"720px",height:"540px",borderRadius:"20px",position:"relative",overflow:"hidden",className:fe(i.dialog,{[i.mainScreen]:h.matches("shareAndInvite")}),children:a(r,{width:"100%",height:"100%",flex:1,gap:"20px",justifyContent:"space-between",alignItems:"stretch",bgcolor:"var(--foreground)",children:[e(A,{in:h.matches("introScreen"),justifyContent:"space-between",children:e(ke,{onClose:()=>o("CLOSE_DIALOG"),onContinue:()=>o("HANDLE_CONTINUE_BUTTON_CLICK")})}),e(A,{in:h.matches("authorizationFlow"),justifyContent:"space-between",children:e(Ie,{flowVariant:"shareAndInvite",onBackButtonClick:()=>o("GO_TO_INTRO_SCREEN"),onSignedUp:()=>o("GO_TO_SHARE_AND_INVITE_FLOW"),onLoggedIn:()=>o("CLOSE_ALL_RELATED_DIALOGS"),from:"Team Setup",defaultAuthorizationType:"signup-welcome",backButtonLabel:"",actionDescription:"Don't have account yet?",actionButtonText:"Sign up",signUpPasswordTitle:`Set an ${Ce}`,createAccountScreenType:"Create Team",teamWizardEntryType:d,welcomeFlowFunnelID:l})}),e(A,{in:h.matches("shareAndInvite"),justifyContent:"space-between",children:e(Ne,{invites:S,credentialsMode:p,onSubmit:(g,w)=>{o("UPDATE_INVITES",{data:g}),o("CHANGE_CREDENTIALS_MODE",{data:w}),o("SUBMIT_DATA")},onCancel:()=>o("CLOSE_DIALOG"),numberOfSharedItems:u,hasSharingSelector:c})}),e(A,{in:h.hasTag("submitting"),justifyContent:"space-between",children:e(r,{justifyContent:"center",alignItems:"center",height:"100%",children:e(Ae,{className:i.progressCircle,size:205,thickness:2})})}),e(A,{in:h.matches("authorizationSuccessScreen"),justifyContent:"center",children:e(De,{type:"sign-up",variant:"shareAndInvite",onComplete:()=>o("CLOSE_ALL_RELATED_DIALOGS")})}),e(A,{in:h.matches("sharingSuccessScreen"),justifyContent:"space-between",top:"40px",className:i.fadeContainerSuccess,children:e(He,{numberOfSharedItems:u,onClose:()=>o("CLOSE_ALL_RELATED_DIALOGS")})}),e(A,{in:h.matches("errorScreen"),justifyContent:"space-between",children:e(be,{hasRetryBtn:!0,onBack:()=>o("GO_TO_SHARE_AND_INVITE_FLOW"),onRetry:()=>o("SUBMIT_DATA",{data:h.context.invites})})})]})})})},Be=z()({dialog:{boxShadow:"0px 5px 15px rgba(0, 0, 0, 0.15)","@media (max-height: 520px)":{height:"100vh"},"@media (max-height: 520px) and (max-width:730px)":{borderRadius:"0",width:"100vw"}},mainScreen:{"@media (max-height: 520px)":{height:"540px"}},fadeContainerSuccess:{"@media (max-height: 520px)":{top:"20px"}},progressCircle:{color:"var(--accent)"}}),tt=Fe;export{tt as default};
//# sourceMappingURL=ShareAndInvite-16b44abe.js.map
