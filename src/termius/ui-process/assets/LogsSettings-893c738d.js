import{bg as C,bl as l,zN as V,bq as s,bn as e,bs as u,cH as z,zO as _,zP as W,dR as B,bz as $,bp as E,mD as F,dI as j,cb as U,bQ as S,cp as A,cy as H,bh as q,bi as h,C3 as Y,bw as G,Ca as J,yY as Q,Cb as X,b_ as K,dO as Z,br as ee,rH as te,jm as ae,cd as ne,c0 as M,c3 as oe,yj as re,ax as ie,ez as se,eA as le,ee as ce,Cc as de,cJ as ue,vU as pe}from"./reconnectSaga-e33541d6.js";import{P as ge}from"./PageWrapper-ec94ee8c.js";import{a as he}from"./PromoBanner-fb55b2e0.js";import"./External Link.react-a980ba5b.js";const me=[{label:"Enabled",value:!0},{label:"Disabled",value:!1}],xe=({value:t,disabled:n,additionalSelectElement:o,onChange:r,renderLabel:p})=>{const{classes:a}=be();return l(V,{value:t,disabled:n,onChange:c=>r(c.target.value==="true"),className:a.select,IconComponent:()=>null,renderValue:c=>l(s,{direction:"row",gap:"5px",alignItems:"center",paddingLeft:"4px",borderRadius:"4px",children:[e(u,{variant:"body1",children:p(c)}),e(z,{className:a.arrowIcon})]}),inputProps:{className:a.selectClassName},input:e(_,{className:a.selectMemberButton,label:p(t),tabIndex:-1}),MenuProps:{anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"right"},slotProps:{paper:{className:a.paperWrapper},root:{className:a.selectMenuRoot}}},children:[me.map((c,x)=>e(W,{value:c.value?"true":"false",className:a.optionClassName,children:l(s,{flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",children:[e(u,{variant:"body1",children:c.label}),c.value===t&&e(B,{className:a.checkIcon})]})},x)),o]})},D={hoverLight:"var(--light-grey-transparent-10)",hoverDark:"var(--dark-grey-transparent-10)"},m={background:D.hoverLight,".termius-dark-theme &":{"--hover-color":D.hoverDark}},be=C()({select:{color:"var(--main)","&:hover":{color:"var(--main)"},"&.Mui-disabled":{color:"var(--secondary)"}},selectMenuRoot:{"& .MuiList-root":{padding:0}},arrowIcon:{width:"11px",marginRight:"2px",marginTop:"2px",color:"currentColor"},selectMemberButton:{fontSize:"14px",paddingRight:"0px","&.MuiOutlinedInput-notchedOutline":{borderWidth:"0px"},"& fieldset":{border:"none"}},optionClassName:{color:"var(--main)",padding:"10px",borderRadius:"10px","&:hover":m,"&.Mui-selected":{background:"transparent","&:hover":m},"&.Mui-selected.Mui-focusVisible":m,"&.Mui-focusVisible":m},paperWrapper:{padding:5,border:"1px solid var(--light-grey-transparent-10)",margin:"15px 10px 15px 15px",borderRadius:"15px",background:"var(--white)",".termius-dark-theme &":{background:"var(--foreground)"},width:"178px"},selectClassName:{border:"1px solid transparent",color:"inherit","&.MuiSelect-select":{paddingRight:"4px !important"},"&.Mui-disabled":{WebkitTextFillColor:"currentColor"},padding:0},checkIcon:{color:"var(--secondary)",width:"14px",height:"14px",marginLeft:"10px"}}),T=t=>{const{vault:n,variant:o}=t,{classes:r,cx:p}=L();return l(s,{direction:"row",alignItems:"center",justifyContent:"space-between",component:"li",className:p(r.root,{[r.compact]:o==="compact"}),children:[l("section",{className:r.leftSection,children:[e($,{size:24,icon:e(E,{width:"16px",color:"var(--main)"})}),e(u,{title:n.name,variant:"body1",color:"primary",ellipsis:!0,children:n.name}),o==="default"&&t.icon&&e(s,{padding:"6px 5px 5px 5px",children:t.icon})]}),o==="default"&&e("section",{className:r.rightSection,children:e(xe,{value:t.setting,disabled:!n.permissions.has("editVaultSettings")||t.isFetching,onChange:a=>a!==t.setting&&t.onToggle(n,a),renderLabel:a=>e(ve,{enabled:a,isFetching:t.isFetching})})})]})},ve=({enabled:t,isFetching:n})=>{const{classes:o}=L();return l(s,{gap:"4px",direction:"row",alignItems:"center",children:[n&&e(F,{className:o.spinner,size:12}),t?"Enabled":"Disabled"]})},L=C()(()=>({root:{padding:"10px",borderRadius:"10px",".termius-dark-theme &":{boxShadow:"none"}},compact:{background:"var(--foreground)"},leftSection:{display:"flex",alignItems:"center",overflow:"hidden",gap:"5px",paddingRight:"10px"},rightSection:{display:"flex",alignItems:"center",flexShrink:0,position:"relative"},spinner:{color:"var(--secondary)"}})),fe=({onClose:t,onConfirm:n,vault:o})=>{const[r,p]=S.useState(!1);return e(A,{title:"Confirm disabling logs",buttonColor:"error",cancelButtonTitle:"Cancel",cancelButtonVariant:"text",confirmButtonTitle:"Disable Logs",onOk:async()=>{try{p(!0),await n()}finally{p(!1),t()}},onClose:t,fetching:r,disabled:r,children:l(s,{gap:"20px",children:[l(u,{children:["Disabling logs will ",e("strong",{children:"delete the logs "}),"from this vault:"]}),e(T,{vault:o,variant:"compact"})]})})},ye=j.promisify(U(fe)),Me=()=>{const{classes:t}=we(),n=H(),o=q(),r=h(Y),p=h(G),a=h(J),c=he(),x=h(Q),[R,k]=S.useState(void 0),[b,v]=S.useState("");X(()=>{b&&v("")},1e4),K(()=>{o(M("logsSettingsScreenOpened"))});const O=()=>{o(re({createAccountScreenType:"High-Volume Unsynced Logs Popup",upgradeToProFunnelID:ie()})),se(n,{dialog:"CreateAccountDialog",target:le(),options:{closeOnBackdropClick:!1},props:{}})},I=async(i,d)=>{var N;const y=r.get(i);if(!y)return;k(i);try{await ce(n,de,{vaultId:i,enabled:d})}catch{v(`Couldn't ${d?"enable":"disable"} logs in ${(N=r.get(i))==null?void 0:N.name}`)}finally{k(void 0)}let w="Shared";ue(y)?w="Personal":pe(y)&&(w="Team"),o(M("logsRetentionPolicyChanged",{vaultType:w,logsRetentionPolicy:d?"Enabled":"Disabled"}))},P=(i,d)=>{v(""),d===!1?ye({onConfirm:async()=>{await I(i.id,d)},vault:i}).catch(oe.swallow):I(i.id,d)},g=(()=>{switch(c){case"no_account_over_size_limit":return{title:`You have ${x.size}mb of logs stored locally`,description:"Change log retention policies or create an account to store logs in a cloud vault."};default:return null}})(),f=(()=>{switch(c){case"no_account_over_size_limit":return{text:"Create account",onClick:O};default:return null}})();return e(Z,{fullHeight:!0,children:e(ge,{children:e(s,{className:t.root,alignItems:"center",gap:"30px",children:l(s,{className:t.vaultsList,component:"ul",children:[e(u,{variant:"boldBody1",color:"main",children:"Logs retention policies"}),e(u,{variant:"body1",children:"Control how logs are stored in your vaults."}),e("div",{className:t.divider}),(g==null?void 0:g.title)&&l(s,{className:t.promo,children:[l(s,{gap:"5px",children:[e(u,{variant:"body1",bolder:!0,children:g.title}),e(u,{variant:"body1",children:g.description})]}),f&&e(ee,{size:"small",color:"white",onClick:f.onClick,children:e(u,{variant:"mediumBody1",children:f.text})})]}),e(s,{component:"ul","aria-label":"Logs settings list",children:p.map(i=>{const d=r.get(i.vault_id);return d?e(T,{variant:"default",vault:d,isFetching:R===i.vault_id,setting:i.enabled,onToggle:P,icon:a&&e(te,{color:"var(--secondary)"})},i.vault_id):null})}),e(ae,{in:!!b,mountOnEnter:!0,unmountOnExit:!0,children:l(s,{gap:"10px",direction:"row",alignItems:"center",padding:"0 15px",children:[e(s,{flex:0,children:e(ne,{className:t.warningIcon})}),e(u,{variant:"body1",color:"error",ellipsis:!0,whiteSpace:"pre-wrap",children:b})]})})]})})})})},we=C()({root:{background:"var(--background)",color:"var(--main)",padding:"30px 20px",width:"100%",height:"100%",overflowY:"auto",overflowX:"hidden"},vaultsList:{width:"100%",maxWidth:"700px",listStyle:"none",margin:0,padding:15,borderRadius:15,display:"flex",flexDirection:"column",gap:"10px",backgroundColor:"var(--card-a)","@media only screen and (max-width: 1280px)":{maxWidth:"600px"},"@media only screen and (max-width: 900px)":{maxWidth:"500px"},"@media only screen and (max-width: 800px)":{width:"100%",margin:"30px 20px 0 20px"}},divider:{height:"1px",width:"100%",backgroundColor:"var(--background-entity)"},promo:{display:"flex",padding:"10px",gap:"15px",borderRadius:"10px",alignItems:"baseline",alignSelf:"stretch",justifyContent:"center",background:"var(--background-entity)","& > button":{textTransform:"none"}},warningIcon:{width:"15px",height:"15px",color:"var(--error-medium)"}});export{Me as LogsSettings};
//# sourceMappingURL=LogsSettings-893c738d.js.map
