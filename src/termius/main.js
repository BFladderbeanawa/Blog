(()=>{var wa={996:(k,O,b)=>{"use strict";var A=b(928);const fe=require("node:fs/promises"),j=require("node:timers/promises");var me=b(508),y=b.n(me);class Ae{#e;#t;#i;constructor(t,i){this.#e=t,this.#i=i,this.#t=t.createChannel(i)}close(){this.#e.closeChannel(this.#t)}async send(t){this.#e.gqlChannelSend(this.#t,t).catch(i=>{this.#i({type:"protocolError",id:t.id,msg:i.message})})}}async function ee(e){return await y().invoke_callback(JSON.stringify(e))}async function Pe(e){return await y().get_lock_screen(e)}function te(e,t){return y().init_runtime(JSON.stringify(e),t)}function xe(e,t,i){return y().init_core(JSON.stringify(e),(n,r)=>t(n,JSON.parse(r)),i)}function He(e){return core.request_single_instance_lock(e)}function C(e,t){return y().complete_future(e,JSON.stringify(t))}function ie(e,t){return y().log(JSON.stringify(e),JSON.stringify(t))}function Me(e){return y().log_level_enabled(e)}async function D(e,t){if(!y().start_profile||!y().end_profile)throw new Error("Not Implemented");const i=t?.duration||5e3,n=t?.frequency||100,r=await(0,j.setTimeout)(i,y().start_profile(n)),a=y().end_profile(r);await(0,fe.writeFile)(e,a)}async function s(e){return await y().get_resource(e)}function o(e){return y().activate_and_focus_window(e)}function d(e){return y().check_for_crash_reports(e)}function u(e){return y().clear_crash_reports(e)}function p(e){return y().send_crash_reports(e)}async function f(e,t,i){return await y().unsafe_unlock_with_embedded_system_auth(e,t,i)}function g(e){return y().unsafe_remove_embedded_auth_subview(e)}function m(e){return y().focus_non_activating_panel(e)}async function v(e){return await y().webauthn_sign(JSON.stringify(e)).then(JSON.parse)}function L(){return y().set_current_process_aumid()}function F(){return y().show_on_auto_start()}function R(e){return y().protect_process_memory(e)}function J(){return core.should_disable_seccomp()}function V(){return core.should_use_file_open_portal()}function We(){return y().dev_tools_enabled()}function Ie(e){return y().capture_active_app(e)}function ga(e){return y().restore_active_app(e)}function fa(){return y().quick_access_hidden()}function je(){return y().should_use_hardware_acceleration()}function ma(){return y().take_silent_from_user_defaults()}function va(){return y().take_launched_from_b5x_from_user_defaults()}function Y(e){return y().localize(JSON.stringify(e))}function ya(){return y().get_locale()}async function _a(e){return await y().process_qr_code(JSON.stringify({...e,imageBytes:[]}),e.imageBytes)}function ba(){return y().bh_reconnect()}async function Sa(e){return await y().gql_invoke(JSON.stringify(e))}const ka={createChannel:e=>y().gql_create_channel(e),closeChannel:e=>{y().gql_close_channel(e)},gqlChannelSend:async(e,t)=>await y().gql_subscription_send(e,JSON.stringify(t))};function Aa(e){return new Ae(ka,e)}var l=b(157),Ye;(function(e){e.SshKeyTitle="ssh-key-title",e.SshKey="ssh-key",e.None="none",e.Name="name",e.HonorificPrefix="honorific-prefix",e.GivenName="given-name",e.AdditionalName="additional-name",e.FamilyName="family-name",e.HonorificSuffix="honorific-suffix",e.Nickname="nickname",e.OrganizationTitle="organization-title",e.Username="username",e.NewPassword="new-password",e.CurrentPassword="current-password",e.OneTimeCode="one-time-code",e.Organization="organization",e.StreetAddress="street-address",e.AddressLine1="address-line1",e.AddressLine2="address-line2",e.AddressLine3="address-line3",e.AddressLevel1="address-level1",e.AddressLevel2="address-level2",e.AddressLevel3="address-level3",e.AddressLevel4="address-level4",e.Country="country",e.CountryName="country-name",e.PostalCode="postal-code",e.CcName="cc-name",e.CcGivenName="cc-given-name",e.CcAdditionalName="cc-additional-name",e.CcFamilyName="cc-family-name",e.CcNumber="cc-number",e.CcExp="cc-exp",e.CcExpMonth="cc-exp-month",e.CcExpYear="cc-exp-year",e.CcCsc="cc-csc",e.CcType="cc-type",e.TransactionCurrency="transaction-currency",e.TransactionAmount="transaction-amount",e.Language="language",e.Bday="bday",e.BdayDay="bday-day",e.BdayMonth="bday-month",e.BdayYear="bday-year",e.Sex="sex",e.Url="url",e.Photo="photo",e.Tel="tel",e.TelCountryCode="tel-country-code",e.TelNational="tel-national",e.TelAreaCode="tel-area-code",e.TelLocal="tel-local",e.TelLocalPrefix="tel-local-prefix",e.TelLocalSuffix="tel-local-suffix",e.TelExtension="tel-extension",e.Email="email",e.Impp="impp",e.CryptoAddress="crypto-address",e.CryptoRecoverySeed="crypto-recovery-seed",e.RecoveryCode="recovery-code"})(Ye||(Ye={}));var Ze;(function(e){e.ClickOpid="clickOpid",e.ClickQuerySelector="clickQuerySelector",e.FillOpid="fillOpid",e.FillQuerySelector="fillQuerySelector",e.FocusOpid="focusOpid",e.Submit="submit"})(Ze||(Ze={}));var Je;(function(e){e.Favorite="favorite",e.Lock="lock",e.Chevron="chevron",e.ChevronPressed="chevronPressed",e.Key="key"})(Je||(Je={}));var et;(function(e){e.Circle="circle",e.RoundedRect="roundedRect",e.Rect="rect"})(et||(et={}));var tt;(function(e){e.SecretKey="secretKey",e.Sso="sso",e.WebAuthn="webAuthn"})(tt||(tt={}));var it;(function(e){e.Vault="vault",e.Archive="archive",e.Favorites="favorites",e.Categories="categories",e.WatchtowerCompromised="watchtowerCompromised",e.WatchtowerVulnerable="watchtowerVulnerable",e.WatchtowerReused="watchtowerReused",e.WatchtowerWeak="watchtowerWeak",e.WatchtowerUnsecured="watchtowerUnsecured",e.WatchtowerInactiveMfa="watchtowerInactiveMfa",e.WatchtowerInWrongAccount="watchtowerInWrongAccount",e.WatchtowerPasskeyAvailable="watchtowerPasskeyAvailable",e.WatchtowerExpiring="watchtowerExpiring"})(it||(it={}));var nt;(function(e){e.FeatureFlags="feature_flags",e.LegacySearchResult="legacy_search_result",e.SmartSearchResult="smart_search_result",e.SmartSearchFilterVault="smart_search_filter_vault",e.LegacySearchFilterVault="legacy_search_filter_vault",e.SmartSearchFilterFavorite="smart_search_filter_favorite",e.LegacySearchFilterFavorite="legacy_search_filter_favorite",e.SmartSearchFilterCategory="smart_search_filter_category",e.LegacySearchFilterCategory="legacy_search_filter_category",e.SmartSearchFilterTag="smart_search_filter_tag",e.LegacySearchFilterTag="legacy_search_filter_tag",e.SmartSearchFilterUntag="smart_search_filter_untag",e.LegacySearchFilterUntag="legacy_search_filter_untag",e.SetUpAnotherDevice="set_up_another_device",e.CopyLink="copy_link",e.ShareLink="share_link",e.SetUpAnotherDeviceSetupCode="set_up_another_device_setup_code",e.RemoveCard="remove_card",e.SafariExtensionCard="safari_extension_card",e.ProfileCard="profile_card",e.LabsCard="labs_card",e.AppleWatchCard="apple_watch_card",e.CustomizeHomeCard="customize_home_card",e.PinnedFieldsCard="pinned_fields_card",e.AutofillCard="autofill_card",e.Profile="profile_view",e.Watchtower="watchtower",e.WatchtowerPasswordStrengthBar="password_strength_bar",e.WatchtowerCompromisedWebsites="compromised_websites",e.WatchtowerVulnerablePasswords="vulnerable_passwords",e.WatchtowerPasskeysAvailable="passkeys_available",e.WatchtowerWrongAccount="items_wrong_account",e.WatchtowerReusedPasswords="reused_passwords",e.WatchtowerWeakPasswords="weak_passwords",e.WatchtowerUnsecuredWebsites="unsecured_websites",e.Watchtower2FA="2FA",e.WatchtowerExpiringItems="expiring_items",e.WatchtowerDuplicateItems="duplicate_items",e.WatchtowerConflictingShortcuts="conflicting_shortcuts",e.WatchtowerDeveloperCredentials="dev_credentials_learn_more",e.WatchtowerRecoveryCodes="setup_recovery_code",e.WatchtowerDataInvolvedInBreach="data_involved_in_breach",e.WatchtowerIgnoredAlerts="ignored_alerts",e.StartHere="start_here",e.AddToBrowser="add_to_browser",e.SetUpAutofill="set_up_autofill",e.OpenTutorial="open_tutorial",e.ImportNext="import_next",e.InviteNext="invite_next",e.InviteSkip="invite_skip",e.DevicesNext="devices_next",e.ImportAddFirstItems="add_first_items",e.ImportMoreToAdd="have_more_to_add",e.ImportAddItemsChooseMethod="add_items_choose_method",e.MigrateDataToOnePassword="migrate_data_to_1p",e.ImportDoNotAskAboutMigrationsAgain="dont_ask_migrations_again",e.ImportCreateSingleItem="create_one_new_item",e.Cancel="cancel",e.DismissMigrateDataTo1P="dismiss_migrate_data_to_1p",e.ItemImport="item_import",e.Safari="safari",e.Firefox="firefox",e.Chrome="chrome",e.Edge="edge",e.Bitwarden="bitwarden",e.Brave="brave",e.DifferentBrowser="different_browser",e.LastPass="lastpass",e.ICloudKeychain="icloud_keychain",e.Dashlane="dashlane",e.Keepass="keepass",e.KeepassXc="keepass_xc",e.Roboform="roboform",e.DeliniaSecretServer="delinea_secret_server",e.OnePassword="1password",e.DifferentPasswordManager="different_password_manager",e.MemorizedPasswords="memorized_passwords",e.PenAndPaper="pen_and_paper",e.Spreadsheet="spreadsheet",e.Csv="csv",e.DoNotSeeMyOption="i_dont_see_my_option",e.AddNewItemScreenGettingStarted="getting_started",e.AddNewItemScreenDeveloperTools="developer_tools",e.AddNewItemScreenMostPopularLogins="popular_logins",e.AddNewItemScreenCryptoBasics="crypto_basics",e.AddNewItemScreenTravelEssentials="travel_essentials",e.PinExtension="pin_extension",e.Done="done",e.Skip="skip",e.GetExtension="get_extension",e.ClickOpenBrowser="click_open_browser",e.GoToAutofillSettings="go_to_autofill_settings",e.UseAutofill="use_autofill",e.AutofillIsOn="autofill_is_on",e.AutofillIsReady="autofill_is_ready",e.AutofillEnrollmentFailed="autofill_enrollment_failed",e.AutofillStepOne="autofill_step_1",e.AutofillStepTwo="autofill_step_2",e.AutofillStepThree="autofill_step_3",e.AutofillStepFour="autofill_step_4",e.ClickPasswordField="click_password_field",e.UseSuggestedPassword="use_suggested_password",e.PracticeSaveAndFill="practice_save_and_fill",e.SaveItem="save_item",e.SavedInOnePassword="saved_in_1password",e.SelectUsernameField="select_username_field",e.FillWithOneClick="fill_with_one_click",e.YouAreDone="youre_done",e.ManageAccount="manage_account",e.People="people",e.InvitePeople="invite_people",e.Invite="invite",e.Accounts="accounts",e.AccountPage="account_page",e.FindInList="find_in_list",e.GlobalSearchField="global_search_field",e.PullToSearch="pull_to_search",e.ItemTemplate="item_template",e.ItemSharing="item_sharing",e.ExportData="export_data",e.GitCommitSigning="git_commit_signing",e.EditAutomatically="edit_automatically",e.CopySnippet="copy_snippet",e.Close="close",e.SettingsDeveloper="settings_developer",e.DeveloperExperienceOnboarding="developer_experience_onboarding",e.DeveloperExperienceEnable="developer_experience_enable",e.DeveloperExperienceDismiss="developer_experience_dismiss",e.DeveloperExperienceSetting="developer_experience_setting",e.DeveloperWatchtowerSetting="developer_watchtower_setting",e.DeveloperExperienceHome="developer_experience_home",e.DeveloperExperienceSsh="developer_experience_ssh",e.DeveloperExperienceCli="developer_experience_cli",e.DeveloperExperienceWatchtower="developer_experience_watchtower",e.DeveloperExperienceEnvironments="developer_experience_environments",e.DeveloperExperienceActivity="developer_experience_activity",e.SshBookmarksCreate="ssh_bookmarks_create",e.SshBookmarksDelete="ssh_bookmarks_delete",e.SshBookmarksConnect="ssh_bookmarks_connect",e.SshBookmarksConfigSetting="ssh_bookmarks_config_setting",e.CopySecretReference="copy_secret_reference",e.MobileHome="mobile_home",e.ChromeAutofillPromptScreen="chrome_autofill_prompt_screen",e.BraveAutofillPromptScreen="brave_autofill_prompt_screen",e.GetStarted="get_started",e.AutofillOnChrome="autofill_on_chrome",e.DefaultTerminalSetting="default_terminal_setting",e.SshAgentSetting="ssh_agent_setting",e.AntiPeekModeToggleOn="anti_peek_mode_toggle_on",e.AntiPeekModeToggleOff="anti_peek_mode_toggle_off",e.AntiPeekModeShareBlocked="anti_peek_mode_share_blocked",e.MobileHomeScreeenCustomize="mobile_home_screen_customize",e.NearbyOnboardingSetLocation="nearby_onboarding_set_location",e.UseMaps="use_maps",e.HelpMenu="help_menu",e.SupportCenterLink="support_center_link",e.TutorialVideosLinks="tutorial_videos_link",e.CommunityForumLink="community_forum_link",e.ContactSupportLink="contact_support_link",e.LatestReleasesLink="latest_releases_link",e.ReportXamIssue="report_xam_issue",e.SendDiagnosticsReport="send_diagnostics_report",e.GettingStartedPlatform="getting_started_platform",e.SecurityReview="security_review",e.PreviewChanges="preview_changes",e.ApplyNewSettings="apply_new_settings",e.KeepExistingSettings="keep_existing_settings",e.CustomizeInSettings="customize_in_settings",e.CloseSecurityReviewIcon="close_security_review_icon",e.UnlockBiometrics="unlock_biometrics",e.UnlockDevicePasscode="unlock_device_passcode",e.UnlockMacPassword="unlock_mac_password",e.UnlockWindowsTpm="unlock_windows_tpm",e.AutomaticWindowsHelloPrompt="automatic_windows_hello_prompt",e.RequireAccountPasswordTime="require_account_password_time",e.SetUpRecoveryCode="set_up_recovery_code",e.DeclineRecoveryCode="decline_recovery_code",e.RecoveryCode="recovery_code",e.UnlockWhenDeviceUnlocks="unlock_when_device_unlocks",e.AskToUnlockAgainTime="ask_to_unlock_again_time",e.LockWhenDeviceLocks="lock_when_device_locks",e.LockAfterExitTime="lock_after_exit_time",e.LockAfterIdleTime="lock_after_idle_time",e.UserFeedback="user_feedback",e.SubmitUserFeedback="submit_user_feedback",e.LabsHomepage="labs_homepage",e.VerifierHomepage="verifier_homepage",e.VerifierBillboards="verifier_billboards",e.VerifierSearch="verifier_search",e.VerifierRecentAction="verifier_recent_action",e.VerifierComposeScreen="verifier_compose_screen",e.VerifierComposeNoteField="verifier_compose_note_field",e.SendVerificationRequest="send_verification_request",e.VerifierChallengeReceived="verifier_challenge_received",e.VerifierRequesterRow="verifier_requester_row",e.VerifierConfirmChallenge="verifier_confirm_challenge",e.VerifierRejectChallenge="verifier_reject_challenge",e.VerifierResponseReceived="verifier_response_received",e.StopInteractingDisclosure="stop_interacting_disclosure",e.Variables="variables",e.Destinations="destinations",e.DeleteIcon="delete_icon",e.ValueConcealRevealToggleIcon="value_conceal_reveal_toggle_icon",e.DeleteLocalFileMount="delete_local_file_mount",e.DeleteDestination="delete_destination",e.ManageAccess="manage_access",e.CopyIcon="copy_icon",e.InstallExtensionWarning="install_extension_warning",e.InstallExtensionBlocked="install_extension_block",e.InstallExtension="install_extension",e.EnableExtension="enable_extension",e.Recheck="recheck",e.Snooze="snooze",e.LearnMoreLink="learn_more_data_safety_link",e.InstallExtensionBanner="install_extension_banner",e.InstallExtensionBannerDismiss="install_extension_banner_dismiss",e.EnableExtensionWarning="enable_extension_warning",e.EnableExtensionBlocked="enable_extension_blocking",e.EssentialSetupTelemetryModalRemindMeLater="essential_setup_telemetry_modal_remind_me_later",e.AutofillNotEnabled="autofill_not_enabled",e.AutofillSnackbarFixButton="autofill_snackbar_fix_button",e.AutofillSnackbarDismissButton="autofill_snackbar_dismiss_button",e.AutomaticLock="automatic_lock",e.LinkedAppEnrollment="linked_app_enrollment",e.LinkedAppEnrollmentApprovingDevice="linked_app_enrollment_approving_device",e.TransferKey="transfer_key",e.DenyAccess="deny_access",e.CancelEnrollment="cancel_enrollment",e.SubmitEnrollment="submit_enrollment",e.CancelEnrollmentPending="cancel_enrollment_pending",e.SelectPreset="select_preset",e.Dismiss="dismiss",e.TakeSurvey="take_survey",e.PickSecurityPreset="pick_security_preset",e.DismissSecurityReview="dismiss_security_review"})(nt||(nt={}));var st;(function(e){e.Archive="archive",e.None="none"})(st||(st={}));var ot;(function(e){e.Enabled="enabled",e.Disabled="disabled"})(ot||(ot={}));var rt;(function(e){e.Default="default",e.Destructive="destructive",e.DestructiveAlt="destructiveAlt",e.Primary="primary",e.PrimaryAlt="primaryAlt",e.PrimaryWhite="primaryWhite",e.Transparent="transparent",e.TransparentBlue="transparentBlue"})(rt||(rt={}));var at;(function(e){e.Subtle="subtle",e.Warning="warning",e.Info="info",e.SolidBlue="solidBlue",e.SolidPurple="solidPurple",e.SolidGreen="solidGreen",e.SolidRed="solidRed"})(at||(at={}));var ct;(function(e){e.Individual="I",e.Family="F",e.Team="B",e.Unsupported="Unsupported"})(ct||(ct={}));var lt;(function(e){e.Registered="R",e.Active="A",e.Suspended="S",e.Deleted="D",e.Purging="X",e.Purged="Z",e.Unsupported="Unsupported"})(lt||(lt={}));var dt;(function(e){e.Active="A",e.Pending="P",e.CancelAtEnd="C",e.Frozen="F",e.Lapsed="L",e.Trialing="T",e.Unsupported="Unsupported"})(dt||(dt={}));var ht;(function(e){e.Personal="P",e.Everyone="E",e.Transfer="T",e.UserCreated="U",e.System="S",e.GeneratedPasswords="G",e.ManagedApplications="M",e.DeveloperEnvironment="D",e.Unsupported="Unsupported"})(ht||(ht={}));var ut;(function(e){e.PendingActivation="P",e.Active="A",e.Suspended="S",e.Deleted="D",e.MustMigrateAuth="M",e.RecoveryStarted="1",e.RecoveryAccepted="2",e.Registered="R",e.EmailVerifiedIncomplete="V",e.ProvisionPending="T",e.ProvisionStarted="3",e.ProvisionAccepted="4",e.ProvisionSuspended="5",e.Purging="X",e.Purged="Z",e.Unsupported="Unsupported"})(ut||(ut={}));var pt;(function(e){e.Primary="primary",e.PrimaryOutline="primaryOutline",e.DangerOutline="dangerOutline",e.Grey="grey",e.Invisible="invisible"})(pt||(pt={}));var wt;(function(e){e.GuidedSignInExperience="guidedSignInExperience"})(wt||(wt={}));var gt;(function(e){e.Active="active",e.Frozen="frozen",e.Guest="guest",e.Locked="locked"})(gt||(gt={}));var ft;(function(e){e.DownloadExtension="download-extension",e.SetUpAutofill="set-up-autofill",e.MigrateData="migrate-data",e.Practice="practice",e.AccessPasswords="access-passwords",e.InviteFamilyMembers="invite-family-members",e.PinExtension="pin-extension"})(ft||(ft={}));var mt;(function(e){e.PhoneOrTablet="phoneOrTablet",e.Computer="computer"})(mt||(mt={}));var vt;(function(e){e.AddDesktopApp="addDesktopApp",e.AddMobileApp="addMobileApp",e.AddExtension="addExtension"})(vt||(vt={}));var yt;(function(e){e.Navigation="Navigation",e.Interaction="Interaction",e.WithProvider="WithProvider"})(yt||(yt={}));var _t;(function(e){e.OnePassword="OnePassword",e.Bitwarden="Bitwarden",e.Chrome="Chrome",e.Edge="Edge",e.Dashlane="Dashlane",e.LastPass="LastPass",e.Keeper="Keeper",e.Okta="Okta",e.Unknown="Unknown"})(_t||(_t={}));var bt;(function(e){e.Google="Google",e.Microsoft="Microsoft"})(bt||(bt={}));var St;(function(e){e.SshKeyUsage="SshKeyUsage",e.CliAccountAccess="CliAccountAccess"})(St||(St={}));var kt;(function(e){e.Street="Street",e.City="City",e.Country="Country",e.Zip="Zip",e.State="State"})(kt||(kt={}));var At;(function(e){e.Us="us",e.Browser="browser"})(At||(At={}));var Pt;(function(e){e.Unknown="unknown",e.Button="button",e.Checkbox="checkbox",e.Color="color",e.Date="date",e.DatetimeLocal="datetime-local",e.Email="email",e.File="file",e.Hidden="hidden",e.Image="image",e.Month="month",e.Number="number",e.Password="password",e.Radio="radio",e.Range="range",e.Reset="reset",e.Search="search",e.Submit="submit",e.Tel="tel",e.Text="text",e.Time="time",e.Url="url",e.Week="week",e.SelectOne="select-one",e.SelectMultiple="select-multiple",e.Textarea="textarea"})(Pt||(Pt={}));var Mt;(function(e){e.ActiveFieldOnly="activeFieldOnly",e.AllFields="allFields",e.UserEdited="userEdited"})(Mt||(Mt={}));var Wt;(function(e){e.Brex="Brex",e.Privacy="Privacy"})(Wt||(Wt={}));var Et;(function(e){e.None="none",e.Login="login",e.Registration="registration",e.ChangePassword="change-password",e.OneTimeCode="one-time-code",e.ChangeEmail="change-email",e.SshKey="ssh-key",e.Payment="payment"})(Et||(Et={}));var Ot;(function(e){e.Home="home",e.Work="work",e.Mobile="mobile",e.Fax="fax",e.Pager="pager"})(Ot||(Ot={}));var Dt;(function(e){e.SystemPrompt="systemPrompt",e.ItemList="itemList",e.SaveAndFill="saveAndFill"})(Dt||(Dt={}));var Lt;(function(e){e.SshAgent="SshAgent",e.Activity="Activity"})(Lt||(Lt={}));var Ut;(function(e){e.SecuritySettingsFlexible="securitySettingsFlexible",e.SecuritySettingsBalanced="securitySettingsBalanced",e.SecuritySettingsStrict="securitySettingsStrict"})(Ut||(Ut={}));var Rt;(function(e){e.Include="include",e.Exclude="exclude"})(Rt||(Rt={}));var Ct;(function(e){e.Online="Online",e.Offline="Offline",e.Unknown="Unknown"})(Ct||(Ct={}));var xt;(function(e){e.Ascending="ascending",e.Descending="descending"})(xt||(xt={}));var Ht;(function(e){e.Name="name",e.LockState="lockState",e.SignedIn="signedIn"})(Ht||(Ht={}));var It;(function(e){e.Good="good",e.WillBlock="will_block",e.Blocked="blocked",e.Notify="notify"})(It||(It={}));var Tt;(function(e){e.Active="A",e.Deleted="D",e.Unsupported="Unsupported"})(Tt||(Tt={}));var Ft;(function(e){e.Owners="O",e.Administrators="A",e.Recovery="R",e.ExternalAccountManagers="E",e.TeamMembers="M",e.UserDefined="U",e.Unsupported="Unsupported"})(Ft||(Ft={}));var Gt;(function(e){e.CopyItemJson="copyItemJson"})(Gt||(Gt={}));var Vt;(function(e){e.Default="Default",e.Host="Host",e.Never="Never"})(Vt||(Vt={}));var Nt;(function(e){e.Regular="R",e.Service="S",e.Guest="G",e.Unsupported="Unsupported"})(Nt||(Nt={}));var Bt;(function(e){e.Name="name",e.Email="email"})(Bt||(Bt={}));var Kt;(function(e){e.CacheFirst="cacheFirst",e.NetworkOnly="networkOnly"})(Kt||(Kt={}));var zt;(function(e){e.Complete="complete",e.Dismissed="dismissed",e.Incomplete="incomplete"})(zt||(zt={}));var qt;(function(e){e.Add="add",e.Remove="remove"})(qt||(qt={}));var N;(function(e){e.Locked="locked",e.Unlocked="unlocked"})(N||(N={}));var Qt;(function(e){e.Day="day",e.Week="week",e.Month="month",e.Year="year"})(Qt||(Qt={}));var Xt;(function(e){e.PayAsYouGo="payAsYouGo",e.PayUpFront="payUpFront",e.FreeTrial="freeTrial"})(Xt||(Xt={}));var $t;(function(e){e.Individual="individual",e.Family="family",e.TeamStarterPack="teamStarterPack"})($t||($t={}));var jt;(function(e){e.Password="password",e.OneTimePassword="oneTimePassword"})(jt||(jt={}));var Yt;(function(e){e.Png="png",e.Svg="svg",e.OnesAndZeros="onesAndZeros"})(Yt||(Yt={}));var Zt;(function(e){e.DateCreated="dateCreated",e.DateModified="dateModified",e.Title="title",e.RecentlyUsed="recentlyUsed",e.FrequentlyUsed="frequentlyUsed",e.PasswordStrength="passwordStrength",e.MostRelevant="mostRelevant"})(Zt||(Zt={}));var Jt;(function(e){e.Ascending="ascending",e.Descending="descending"})(Jt||(Jt={}));var ei;(function(e){e.Active="Active",e.Archived="Archived",e.Deleted="Deleted"})(ei||(ei={}));var ti;(function(e){e.FrozenAccount="frozenAccount",e.SsoMigration="ssoMigration",e.RecentlyDeleted="recentlyDeleted"})(ti||(ti={}));var ii;(function(e){e.Dismiss="dismiss",e.Cancel="cancel"})(ii||(ii={}));var ni;(function(e){e.Info="info",e.Warn="warn",e.Error="error",e.Exception="exception"})(ni||(ni={}));var si;(function(e){e.None="none",e.Single="single",e.Double="double"})(si||(si={}));var oi;(function(e){e.Title="title",e.Primary="primary",e.Secondary="secondary",e.Tags="tags",e.CallToAction="callToAction",e.ItemLocation="itemLocation"})(oi||(oi={}));var ri;(function(e){e.RetainOriginal="RetainOriginal",e.TrashOriginal="TrashOriginal"})(ri||(ri={}));var ai;(function(e){e.BiometricsOnly="BiometricsOnly",e.BiometricsOrWatch="BiometricsOrWatch",e.WatchOnly="WatchOnly",e.NoneAvailable="NoneAvailable"})(ai||(ai={}));var ci;(function(e){e.Unknown="Unknown",e.NoneAvailable="NoneAvailable",e.TouchId="TouchId",e.FaceId="FaceId"})(ci||(ci={}));var li;(function(e){e.Available="Available",e.NotAvailable="NotAvailable",e.SensorUnavailable="SensorUnavailable",e.NotEnrolled="NotEnrolled",e.Lockout="Lockout",e.NotInteractive="NotInteractive",e.WatchNotAvailable="WatchNotAvailable",e.EnrollmentChanged="EnrollmentChanged",e.Disconnected="Disconnected",e.NotPaired="NotPaired",e.Unknown="Unknown"})(li||(li={}));var di;(function(e){e.Active="ACTIVE",e.Shipped="SHIPPED",e.Expired="EXPIRED",e.Locked="LOCKED",e.Terminated="TERMINATED"})(di||(di={}));var hi;(function(e){e.Virtual="VIRTUAL",e.Physical="PHYSICAL"})(hi||(hi={}));var ui;(function(e){e.Card="CARD",e.User="USER"})(ui||(ui={}));var pi;(function(e){e.AED="AED",e.AFN="AFN",e.ALL="ALL",e.AMD="AMD",e.XCG="XCG",e.AOA="AOA",e.ARS="ARS",e.AUD="AUD",e.AWG="AWG",e.AZN="AZN",e.BAM="BAM",e.BBD="BBD",e.BDT="BDT",e.BGN="BGN",e.BHD="BHD",e.BIF="BIF",e.BMD="BMD",e.BND="BND",e.BOB="BOB",e.BOV="BOV",e.BRL="BRL",e.BSD="BSD",e.BTN="BTN",e.BWP="BWP",e.BYN="BYN",e.BZD="BZD",e.CAD="CAD",e.CDF="CDF",e.CHE="CHE",e.CHF="CHF",e.CHW="CHW",e.CLF="CLF",e.CLP="CLP",e.CNY="CNY",e.COP="COP",e.COU="COU",e.CRC="CRC",e.CUC="CUC",e.CUP="CUP",e.CVE="CVE",e.CZK="CZK",e.DJF="DJF",e.DKK="DKK",e.DOP="DOP",e.DZD="DZD",e.EGP="EGP",e.ERN="ERN",e.ETB="ETB",e.EUR="EUR",e.FJD="FJD",e.FKP="FKP",e.GBP="GBP",e.GEL="GEL",e.GHS="GHS",e.GIP="GIP",e.GMD="GMD",e.GNF="GNF",e.GTQ="GTQ",e.GYD="GYD",e.HKD="HKD",e.HNL="HNL",e.HRK="HRK",e.HTG="HTG",e.HUF="HUF",e.IDR="IDR",e.ILS="ILS",e.INR="INR",e.IQD="IQD",e.IRR="IRR",e.ISK="ISK",e.JMD="JMD",e.JOD="JOD",e.JPY="JPY",e.KES="KES",e.KGS="KGS",e.KHR="KHR",e.KMF="KMF",e.KPW="KPW",e.KRW="KRW",e.KWD="KWD",e.KYD="KYD",e.KZT="KZT",e.LAK="LAK",e.LBP="LBP",e.LKR="LKR",e.LRD="LRD",e.LSL="LSL",e.LYD="LYD",e.MAD="MAD",e.MDL="MDL",e.MGA="MGA",e.MKD="MKD",e.MMK="MMK",e.MNT="MNT",e.MOP="MOP",e.MRU="MRU",e.MUR="MUR",e.MVR="MVR",e.MWK="MWK",e.MXN="MXN",e.MXV="MXV",e.MYR="MYR",e.MZN="MZN",e.NAD="NAD",e.NGN="NGN",e.NIO="NIO",e.NOK="NOK",e.NPR="NPR",e.NZD="NZD",e.OMR="OMR",e.PAB="PAB",e.PEN="PEN",e.PGK="PGK",e.PHP="PHP",e.PKR="PKR",e.PLN="PLN",e.PYG="PYG",e.QAR="QAR",e.RON="RON",e.RSD="RSD",e.RUB="RUB",e.RWF="RWF",e.SAR="SAR",e.SBD="SBD",e.SCR="SCR",e.SDG="SDG",e.SEK="SEK",e.SGD="SGD",e.SHP="SHP",e.SLE="SLE",e.SLL="SLL",e.SOS="SOS",e.SRD="SRD",e.SSP="SSP",e.STN="STN",e.SVC="SVC",e.SYP="SYP",e.SZL="SZL",e.THB="THB",e.TJS="TJS",e.TMT="TMT",e.TND="TND",e.TOP="TOP",e.TRY="TRY",e.TTD="TTD",e.TWD="TWD",e.TZS="TZS",e.UAH="UAH",e.UGX="UGX",e.USD="USD",e.USN="USN",e.UYI="UYI",e.UYU="UYU",e.UYW="UYW",e.UZS="UZS",e.VED="VED",e.VES="VES",e.VND="VND",e.VUV="VUV",e.WST="WST",e.XAF="XAF",e.XAG="XAG",e.XAU="XAU",e.XBA="XBA",e.XBB="XBB",e.XBC="XBC",e.XBD="XBD",e.XCD="XCD",e.XDR="XDR",e.XOF="XOF",e.XPD="XPD",e.XPF="XPF",e.XPT="XPT",e.XSU="XSU",e.XTS="XTS",e.XUA="XUA",e.XXX="XXX",e.YER="YER",e.ZAR="ZAR",e.ZMW="ZMW",e.ZWL="ZWL",e.ZWG="ZWG"})(pi||(pi={}));var wi;(function(e){e.Monthly="MONTHLY",e.Quarterly="QUARTERLY",e.Yearly="YEARLY",e.OneTime="ONE_TIME"})(wi||(wi={}));var gi;(function(e){e.Production="Production",e.Staging="Staging"})(gi||(gi={}));var fi;(function(e){e.Invited="INVITED",e.Active="ACTIVE",e.Closed="CLOSED",e.Disabled="DISABLED",e.Deleted="DELETED",e.PendingActivation="PENDING_ACTIVATION"})(fi||(fi={}));var mi;(function(e){e.Granted="GRANTED",e.Denied="DENIED",e.Unknown="UNKNOWN"})(mi||(mi={}));var vi;(function(e){e.SignOut="signOut",e.Lock="lock"})(vi||(vi={}));var yi;(function(e){e.Set="Set",e.Clear="Clear",e.Mixed="Mixed"})(yi||(yi={}));var _i;(function(e){e.Dark="dark",e.Light="light",e.System="system"})(_i||(_i={}));var bi;(function(e){e.AndroidBiometricUnlock="AndroidBiometricUnlock",e.AndroidDevicePinUnlock="AndroidDevicePinUnlock",e.AndroidBiometricOrDevicePinUnlock="AndroidBiometricOrDevicePinUnlock",e.NoneAvailable="NoneAvailable"})(bi||(bi={}));var Si;(function(e){e.Option="option",e.CtrlAlt="ctrlAlt",e.None="none"})(Si||(Si={}));var ne;(function(e){e.MainWindow="mainWindow",e.QuickAccess="quickAccess",e.Menu="menu"})(ne||(ne={}));var ki;(function(e){e.Autofill="autofill",e.Download="download",e.Go="go",e.OpenURL="openURL",e.Move="move",e.Copy="copy",e.Archive="archive",e.Restore="restore",e.Export="export",e.Tag="tag",e.Share="share",e.CreatePrivacyCard="createPrivacyCard",e.CreateBrexVendorCard="createBrexVendorCard",e.CatalogAppLaunch="catalogAppLaunch"})(ki||(ki={}));var Ai;(function(e){e.Transparent="transparent",e.Primary="primary"})(Ai||(Ai={}));var Pi;(function(e){e.MerchantLocked="MERCHANT_LOCKED",e.SingleUse="SINGLE_USE"})(Pi||(Pi={}));var Mi;(function(e){e.Transaction="TRANSACTION",e.Monthly="MONTHLY",e.Annually="ANNUALLY",e.Forever="FOREVER"})(Mi||(Mi={}));var Wi;(function(e){e.RevealSecretKey="revealSecretKey",e.ConcealSecretKey="concealSecretKey",e.CopySignInAddress="copySignInAddress",e.CopyEmail="copyEmail",e.CopySecretKey="copySecretKey",e.CopyLink="copyLink",e.CopySsoProvider="copySsoProvider",e.LargeTypeSignInAddress="largeTypeSignInAddress",e.LargeTypeEmail="largeTypeEmail",e.LargeTypeSecretKey="largeTypeSecretKey",e.LargeTypeSsoProvider="largeTypeSsoProvider",e.ChangeEmail="changeEmail",e.ChangeSecretKey="changeSecretKey"})(Wi||(Wi={}));var Ei;(function(e){e.SetUpAnotherDevice="setUpAnotherDevice",e.ManageAccount="manageAccount",e.CreateVault="createVault"})(Ei||(Ei={}));var Oi;(function(e){e.Packed="packed",e.Tpm="tpm",e.AndroidKey="android-key",e.AndroidSafetynet="android-safetynet",e.FidoU2f="fido-u2f",e.Apple="apple",e.None="none"})(Oi||(Oi={}));var Di;(function(e){e.Dashlane="dashlane"})(Di||(Di={}));var Li;(function(e){e.Bitwarden="bitwarden",e.Safari="safari",e.ICloud="iCloud",e.OnePux="onePux",e.Chrome="chrome"})(Li||(Li={}));var Ui;(function(e){e.AttentionSevere="attentionSevere",e.Attention="attention",e.Recommendation="recommendation"})(Ui||(Ui={}));var Ri;(function(e){e.AccountFamily="accountFamily",e.AccountIndividual="accountIndividual",e.AccountTeam="accountTeam",e.AllCategories="allCategories",e.AllItems="allItems",e.ApiCredentials="apiCredentials",e.Archive="archive",e.AutoFill1Password="autoFill1Password",e.AutoFillKey="autoFillKey",e.AutoFillKeyboard="autoFillKeyboard",e.AutoFillSettings="autoFillSettings",e.AutoFillToggle="autoFillToggle",e.BankAccount="bankAccount",e.BrexCorporate="brexCorporate",e.BrexVault="brexVault",e.BrexVendor="brexVendor",e.Browserbase="browserbase",e.CreditCard="creditCard",e.CreditCardAmex="creditCardAmex",e.CreditCardDiscover="creditCardDiscover",e.CreditCardMastercard="creditCardMastercard",e.CreditCardVisa="creditCardVisa",e.CryptoWallet="cryptoWallet",e.Database="database",e.Developer="developer",e.DeveloperActivity="developerActivity",e.DeveloperBiometrics="developerBiometrics",e.DeveloperCli="developerCli",e.DeveloperEnvironments="developerEnvironments",e.DeveloperEnvironmentFileMount="developerEnvironmentFileMount",e.DeveloperSsh="developerSsh",e.DeveloperSshBookmark="developerSshBookmark",e.DeveloperWatchtower="developerWatchtower",e.DeviceListAndroidPhone="deviceListAndroidPhone",e.DeviceListAndroidTablet="deviceListAndroidTablet",e.DeviceListBrave="deviceListBrave",e.DeviceListChrome="deviceListChrome",e.DeviceListCLI="deviceListCLI",e.DeviceListEdge="deviceListEdge",e.DeviceListFirefox="deviceListFirefox",e.DeviceListGeneric="deviceListGeneric",e.DeviceListIMac="deviceListIMac",e.DeviceListIPad="deviceListIPad",e.DeviceListIPhone="deviceListIPhone",e.DeviceListMacbookPro="deviceListMacbookPro",e.DeviceListOpera="deviceListOpera",e.DeviceListPC="deviceListPC",e.DeviceListPCLaptop="deviceListPCLaptop",e.DeviceListBraveExtension="deviceListBraveExtension",e.DeviceListChromeExtension="deviceListChromeExtension",e.DeviceListOperaExtension="deviceListOperaExtension",e.DeviceListFirefoxExtension="deviceListFirefoxExtension",e.DeviceListEdgeExtension="deviceListEdgeExtension",e.DeviceListSafariExtension="deviceListSafariExtension",e.DeviceListSafari="deviceListSafari",e.DeviceVerified="deviceVerified",e.Document="document",e.DocumentImage="documentImage",e.DocumentSpreadsheet="documentSpreadsheet",e.DocumentText="documentText",e.DocumentZip="documentZip",e.DriverLicense="driverLicense",e.Email="email",e.EmptyAllItems="emptyAllItems",e.EmptyArchive="emptyArchive",e.EmptyFavorites="emptyFavorites",e.EmptyNoVaults="emptyNoVaults",e.EmptyRecentlyDeleted="emptyRecentlyDeleted",e.EmptyWatchtowerCompromisedWebsites="emptyWatchtowerCompromisedWebsites",e.EmptyWatchtowerDashboard="emptyWatchtowerDashboard",e.EmptyWatchtowerExpiring="emptyWatchtowerExpiring",e.EmptyWatchtowerInactiveMfa="emptyWatchtowerInactiveMfa",e.EmptyWatchtowerInWrongAccount="emptyWatchtowerInWrongAccount",e.EmptyWatchtowerPasskeyAvailable="emptyWatchtowerPasskeyAvailable",e.EmptyWatchtowerPasswordStrength="emptyWatchtowerPasswordStrength",e.EmptyWatchtowerDuplicateItem="emptyWatchtowerDuplicateItem",e.EmptyWatchtowerReusedPasswords="emptyWatchtowerReusedPasswords",e.EmptyWatchtowerUnsecuredWebsites="emptyWatchtowerUnsecuredWebsites",e.EmptyWatchtowerVulnerablePasswords="emptyWatchtowerVulnerablePasswords",e.EmptyWatchtowerWeakPasswords="emptyWatchtowerWeakPasswords",e.Everything="everything",e.Fastmail="fastmail",e.Favorites="favorites",e.Git="git",e.HighlightsBrowserExtension="highlightsBrowserExtension",e.HighlightsDevices="highlightsDevices",e.HighlightsFaceID="highlightsFaceID",e.HighlightsFamily="highlightsFamily",e.HighlightsHandUp="highlightsHandUp",e.HighlightsItemCatalog="highlightsItemCatalog",e.HighlightsItemSharing="highlightsItemSharing",e.HighlightsKey="highlightsKey",e.HighlightsManaging="highlightsManaging",e.HighlightsPasswordlessAuthentication="highlightsPasswordlessAuthentication",e.HighlightsPerformance="highlightsPerformance",e.HighlightsPlatforms="highlightsPlatforms",e.HighlightsQuickAccess="highlightsQuickAccess",e.HighlightsRedesign="highlightsRedesign",e.HighlightsSecurity="highlightsSecurity",e.HighlightsStrongPasswords="highlightsStrongPasswords",e.HighlightsSupport="highlightsSupport",e.HighlightsTeam="highlightsTeam",e.HighlightsWatchtower="highlightsWatchtower",e.HighlightsWebsite="highlightsWebsite",e.HomeAllItems="homeAllItems",e.HomeArchived="homeArchived",e.HomeCategories="homeCategories",e.HomeFavorites="homeFavorites",e.HomeFrequentlyUsed="homeFrequentlyUsed",e.HomeNearby="homeNearby",e.HomePinned="homePinned",e.HomeRecentlyAdded="homeRecentlyAdded",e.HomeRecentlyCreated="homeRecentlyCreated",e.HomeRecentlyDeleted="homeRecentlyDeleted",e.HomeRecentlyModified="homeRecentlyModified",e.HomeRecentlyUsed="homeRecentlyUsed",e.HomeScreenBillboardAppleWatchTransparent="homeScreenBillboardAppleWatchTransparent",e.HomeScreenBillboardCustomizeHomeTransparent="homeScreenBillboardCustomizeHomeTransparent",e.HomeScreenBillboardIllustrationAppleWatch="homeScreenBillboardIllustrationAppleWatch",e.HomeScreenBillboardIllustrationAutoFill="homeScreenBillboardIllustrationAutoFill",e.HomeScreenBillboardIllustrationCustomizeHome="homeScreenBillboardIllustrationCustomizeHome",e.HomeScreenBillboardIllustrationPinnedFields="homeScreenBillboardIllustrationPinnedFields",e.HomeScreenBillboardIllustrationSafariExtension="homeScreenBillboardIllustrationSafariExtension",e.HomeScreenBillboardPinnedFieldsTransparent="homeScreenBillboardPinnedFieldsTransparent",e.HomeScreenBillboardProfileTransparent="homeScreenBillboardProfileTransparent",e.HomeScreenBillboardSafariTransparent="homeScreenBillboardSafariTransparent",e.HomeScreenBillboardTipsTransparent="homeScreenBillboardTipsTransparent",e.HomeScreenBillboardWarningTransparent="homeScreenBillboardWarningTransparent",e.HomeScreenInterstitialAppleWatch="homeScreenInterstitialAppleWatch",e.HomeScreenInterstitialEmptyHome="homeScreenInterstitialEmptyHome",e.HomeScreenInterstitialPinnedFields="homeScreenInterstitialPinnedFields",e.HomeTags="homeTags",e.HomeTips="homeTips",e.HomeVaults="homeVaults",e.HomeWatchtower="homeWatchtower",e.Identity="identity",e.ImportGuideBitwarden="importGuideBitwarden",e.ImportGuideCsv="importGuideCsv",e.ImportGuideDashlane="importGuideDashlane",e.ImportGuideDelinea="importGuideDelinea",e.ImportGuideKeypass="importGuideKeypass",e.ImportGuideKeypassXc="importGuideKeypassXc",e.ImportGuideLastPass="importGuideLastPass",e.ImportGuideMemorized="importGuideMemorized",e.ImportGuideOnePassword="importGuideOnePassword",e.ImportGuidePen="importGuidePen",e.ImportGuideRoboForm="importGuideRoboForm",e.ImportGuideSpreadsheet="importGuideSpreadsheet",e.ItemSharing="itemSharing",e.KeyEmpty="keyEmpty",e.KeyError="keyError",e.KeyFilled="keyFilled",e.LabsHero="labsHero",e.Login="login",e.ManageAccountBusiness="manageAccountBusiness",e.ManageAccountData="manageAccountData",e.ManageAccountDevices="manageAccountDevices",e.ManageAccountFamily="manageAccountFamily",e.ManageAccountIndividual="manageAccountIndividual",e.ManageAccountPeople="manageAccountPeople",e.ManageAccountSubscription="manageAccountSubscription",e.ManageAccountVaults="manageAccountVaults",e.ManageAccountTeam="manageAccountTeam",e.MedicalRecord="medicalRecord",e.Membership="membership",e.OnePasswordVerified="onePasswordVerified",e.OperatingSystemAndroid="operatingSystemAndroid",e.OperatingSystemIos="operatingSystemIos",e.OperatingSystemLinux="operatingSystemLinux",e.OperatingSystemMac="operatingSystemMac",e.OperatingSystemOther="operatingSystemOther",e.OperatingSystemWindows="operatingSystemWindows",e.OutdoorLicense="outdoorLicense",e.Passkey="passkey",e.Passport="passport",e.Password="password",e.PersonVerified="personVerified",e.PinUnlockSettings="pinUnlockSettings",e.PinUnlockWarning="pinUnlockWarning",e.Placeholder="placeholder",e.PrivacyCom="privacyCom",e.Profile="profile",e.RecentlyCreated="recentlyCreated",e.RecentlyDeleted="recentlyDeleted",e.Rewards="rewards",e.Router="router",e.Search="search",e.SecureNote="secureNote",e.Server="server",e.SettingsAbout="settingsAbout",e.SettingsAccounts="settingsAccounts",e.SettingsAdvanced="settingsAdvanced",e.SettingsAppearance="settingsAppearance",e.SettingsAutoFill="settingsAutoFill",e.SettingsBrowser="settingsBrowser",e.SettingsCollections="settingsCollections",e.SettingsDeveloper="settingsDeveloper",e.SettingsGeneral="settingsGeneral",e.SettingsHelp="settingsHelp",e.SettingsLabs="settingsLabs",e.SettingsLabsExperimentFeatureFlags="settingsLabsExperimentFeatureFlags",e.SettingsLabsExperimentPrivacyMode="settingsLabsExperimentPrivacyMode",e.SettingsNotifications="settingsNotifications",e.SettingsPrivacy="settingsPrivacy",e.SettingsReview="settingsReview",e.SettingsSafariExtension="settingsSafariExtension",e.SettingsSecurity="settingsSecurity",e.SignIn1Password="signIn1Password",e.SignInAndRecovery="signInAndRecovery",e.SignInBannerIllustration="signInBannerIllustration",e.SignInEmergencyKit="signInEmergencyKit",e.SignInGoogle="signInGoogle",e.SignInManual="signInManual",e.SignInOkta="signInOkta",e.SignInPasskey="signInPasskey",e.SignInScanQR="signInScanQR",e.SignInSSO="signInSSO",e.Snippet="snippet",e.SocialSecurityNumber="socialSecurityNumber",e.SoftwareLicense="softwareLicense",e.Ssh="ssh",e.SsoDeviceIcon="ssoDeviceIcon",e.SsoLoginAmazon="ssoLoginAmazon",e.SsoLoginAmazonAttachment="ssoLoginAmazonAttachment",e.SsoLoginApple="ssoLoginApple",e.SsoLoginAppleAttachment="ssoLoginAppleAttachment",e.SsoLoginFacebook="ssoLoginFacebook",e.SsoLoginFacebookAttachment="ssoLoginFacebookAttachment",e.SsoLoginGitHub="ssoLoginGitHub",e.SsoLoginGitHubAttachment="ssoLoginGitHubAttachment",e.SsoLoginGoogle="ssoLoginGoogle",e.SsoLoginGoogleAttachment="ssoLoginGoogleAttachment",e.SsoLoginMicrosoft="ssoLoginMicrosoft",e.SsoLoginMicrosoftAttachment="ssoLoginMicrosoftAttachment",e.SsoLoginTwitter="ssoLoginTwitter",e.SsoLoginTwitterAttachment="ssoLoginTwitterAttachment",e.SsoLoginOkta="ssoLoginOkta",e.SsoLoginOktaAttachment="ssoLoginOktaAttachment",e.SsoLoginSlack="ssoLoginSlack",e.SsoLoginSlackAttachment="ssoLoginSlackAttachment",e.SsoLoginDiscord="ssoLoginDiscord",e.SsoLoginDiscordAttachment="ssoLoginDiscordAttachment",e.Suggestions="suggestions",e.Tag="tag",e.Tombstone="tombstone",e.TutorialGlobe="tutorialGlobe",e.UnknownCategory="unknownCategory",e.Vault="vault",e.VaultPlaceholder="vaultPlaceholder",e.VaultGuarded="vaultGuarded",e.Watchtower="watchtower",e.Verifier="verifier"})(Ri||(Ri={}));var Ci;(function(e){e.Syncing="syncing",e.NotSyncedYet="notSyncedYet",e.OutOfSync="outOfSync",e.InSync="inSync",e.Unknown="unknown"})(Ci||(Ci={}));var xi;(function(e){e.Accepted="Accepted",e.UserFallBack="UserFallBack",e.Cancelled="Cancelled",e.Denied="Denied",e.NotEnabled="NotEnabled"})(xi||(xi={}));var Hi;(function(e){e.ChooseFile="chooseFile",e.ChoosePhoto="choosePhoto",e.CapturePhoto="capturePhoto",e.ScanDocument="scanDocument"})(Hi||(Hi={}));var Ii;(function(e){e.DayMonthYear="dayMonthYear",e.MonthYear="monthYear"})(Ii||(Ii={}));var Ti;(function(e){e.WrongAccount="wrongAccount",e.WrongAccountByPolicy="wrongAccountByPolicy"})(Ti||(Ti={}));var Fi;(function(e){e.ShareWithFamily="ShareWithFamily",e.ShareWithTeam="ShareWithTeam"})(Fi||(Fi={}));var Gi;(function(e){e.Enabled="enabled",e.DisabledByUser="disabledByUser",e.DisabledByAdmin="disabledByAdmin",e.NoMapNoReason="noMapNoReason"})(Gi||(Gi={}));var Vi;(function(e){e.DefaultKeyboard="DefaultKeyboard",e.NumberPad="NumberPad",e.NamePhonePad="NamePhonePad",e.NumbersAndPunctuation="NumbersAndPunctuation",e.EmailAddress="EmailAddress",e.Url="Url"})(Vi||(Vi={}));var Ni;(function(e){e.None="None",e.Words="Words",e.Sentences="Sentences",e.AllCharacters="AllCharacters"})(Ni||(Ni={}));var Bi;(function(e){e.ChooseFile="chooseFile",e.ChoosePhoto="choosePhoto",e.RemoveIcon="removeIcon"})(Bi||(Bi={}));var Ki;(function(e){e.Text="text",e.Url="url",e.Email="email",e.Address="address",e.DayMonthYear="dayMonthYear",e.MonthYear="monthYear",e.OneTimePassword="oneTimePassword",e.Password="password",e.Phone="phone",e.SecurityQuestion="securityQuestion",e.File="file",e.SshKey="sshKey",e.SsoLogin="ssoLogin"})(Ki||(Ki={}));var zi;(function(e){e.ItemCreated="itemCreated",e.ItemSaved="itemSaved",e.ItemConvertedToLogin="itemConvertedToLogin"})(zi||(zi={}));var qi;(function(e){e.Top="Top",e.Middle="Middle",e.Bottom="Bottom",e.TopAndBottom="TopAndBottom"})(qi||(qi={}));var Qi;(function(e){e.Informational="informational",e.Success="success",e.Warning="warning",e.Critical="critical"})(Qi||(Qi={}));var Xi;(function(e){e.Full="full",e.Long="long",e.Medium="medium",e.Short="short"})(Xi||(Xi={}));var $i;(function(e){e.Single="single",e.Double="double"})($i||($i={}));var ji;(function(e){e.Edit="edit",e.Autofill="autofill",e.OpenAndFill="openAndFill",e.OpenUrl="openUrl"})(ji||(ji={}));var Yi;(function(e){e.Normal="Normal",e.Warning="Warning"})(Yi||(Yi={}));var Zi;(function(e){e.BaseApp="baseApp",e.AutoFillItemSelect="autoFillItemSelect",e.AutoFillFieldSelect="autoFillFieldSelect"})(Zi||(Zi={}));var Ji;(function(e){e.Default="default",e.Destructive="destructive",e.Primary="primary",e.Transparent="transparent"})(Ji||(Ji={}));var en;(function(e){e.Success="success"})(en||(en={}));var tn;(function(e){e.AutoFill="autoFill",e.Biometrics="biometrics",e.BiometricsFace="biometricsFace",e.SystemTray="systemTray",e.BrowserExtension="browserExtension",e.Telemetry="telemetry"})(tn||(tn={}));var nn;(function(e){e.AutoFill="AutoFill",e.Biometrics="Biometrics",e.SystemTray="SystemTray",e.MigrateDataFromOpSeven="MigrateDataFromOpSeven",e.Telemetry="Telemetry"})(nn||(nn={}));var sn;(function(e){e.Strong="strong",e.Moderate="moderate"})(sn||(sn={}));var on;(function(e){e.Csv="Csv",e.OnePif2="OnePif2",e.OnePux="OnePux"})(on||(on={}));var rn;(function(e){e.Critical="critical",e.Warning="warning"})(rn||(rn={}));var an;(function(e){e.OpenSsh="OpenSSH",e.Pkcs8="PKCS#8",e.Pkcs1="PKCS#1"})(an||(an={}));var cn;(function(e){e.Finished="Finished",e.Running="Running",e.Failed="Failed"})(cn||(cn={}));var ln;(function(e){e.Enabled="ENABLED",e.Pending="PENDING"})(ln||(ln={}));var dn;(function(e){e.Uploading="Uploading",e.Available="Available",e.Missing="Missing"})(dn||(dn={}));var hn;(function(e){e.Characters="Characters",e.Words="Words",e.Pin="Pin",e.PasswordRules="PasswordRules"})(hn||(hn={}));var un;(function(e){e.Digits="Digits",e.DigitsAndSymbols="DigitsAndSymbols",e.Spaces="Spaces",e.Hyphens="Hyphens",e.Underscores="Underscores",e.Periods="Periods",e.Commas="Commas"})(un||(un={}));var pn;(function(e){e.FullWords="FullWords",e.Syllables="Syllables",e.ThreeLetters="ThreeLetters"})(pn||(pn={}));var wn;(function(e){e.Enabled="enabled",e.Disabled="disabled",e.Deleted="deleted"})(wn||(wn={}));var gn;(function(e){e.Chrome="chrome",e.Firefox="firefox",e.SafariMacos="safari-macos",e.SafariIos="safari-ios"})(gn||(gn={}));var fn;(function(e){e.Brex="Brex"})(fn||(fn={}));var mn;(function(e){e.Zero="zero",e.One="one"})(mn||(mn={}));var vn;(function(e){e.Twelve="twelve",e.TwentyFour="twentyFour"})(vn||(vn={}));var yn;(function(e){e.Raw="raw",e.Padded="padded"})(yn||(yn={}));var _n;(function(e){e.Csv="csv",e.Json="json",e.OnePux="onePux"})(_n||(_n={}));var bn;(function(e){e.Button="Button",e.Link="Link"})(bn||(bn={}));var Sn;(function(e){e.Green="green",e.Grey="grey",e.Red="red",e.Purple="purple"})(Sn||(Sn={}));var kn;(function(e){e.Amazon="amazon",e.Apple="apple",e.Discord="discord",e.Facebook="facebook",e.GitHub="github",e.Google="google",e.Microsoft="microsoft",e.Okta="okta",e.Slack="slack",e.Twitter="twitter"})(kn||(kn={}));var An;(function(e){e.Active="active",e.Deleted="deleted",e.Archived="archived"})(An||(An={}));var Pn;(function(e){e.Large="large",e.Medium="medium"})(Pn||(Pn={}));var Mn;(function(e){e.RSAOAEP="RSA-OAEP",e.RSAOAEP256="RSA-OAEP-256",e.A256GCM="A256GCM",e.ECDHES="ECDH-ES",e.ES256="ES256"})(Mn||(Mn={}));var Wn;(function(e){e.RSA="RSA",e.Oct="oct",e.EC="EC",e.OKP="OKP"})(Wn||(Wn={}));var En;(function(e){e.Sign="sign",e.Verify="verify",e.Encrypt="encrypt",e.Decrypt="decrypt",e.WrapKey="wrapKey",e.UnwrapKey="unwrapKey",e.DeriveKey="deriveKey",e.DeriveBits="deriveBits"})(En||(En={}));var On;(function(e){e.WhenUnlocked="WhenUnlocked",e.AfterFirstUnlock="AfterFirstUnlock",e.WhenPasscodeSetThisDeviceOnly="WhenPasscodeSetThisDeviceOnly",e.WhenUnlockedThisDeviceOnly="WhenUnlockedThisDeviceOnly",e.AfterFirstUnlockThisDeviceOnly="AfterFirstUnlockThisDeviceOnly"})(On||(On={}));var Dn;(function(e){e.AccountOverview="accountOverview",e.YourDetails="yourDetails",e.People="people",e.TrustedDevices="trustedDevices",e.Telemetry="telemetry",e.SetUpAnotherDevice="setUpAnotherDevice",e.Subscription="subscription",e.EmergencyKit="emergencyKit",e.Vaults="vaults",e.SignInAndRecovery="signInAndRecovery"})(Dn||(Dn={}));var Ln;(function(e){e.Text="text",e.Numeric="numeric",e.Password="password"})(Ln||(Ln={}));var Un;(function(e){e.GreyscaleWhite="greyscaleWhite",e.GreyscaleBlack="greyscaleBlack",e.ShadingHeavy="shadingHeavy",e.ShadingExtraFaint="shadingExtraFaint",e.ReadableGreen="readableGreen",e.ReadablePurple="readablePurple",e.ReadableBlue="readableBlue",e.ReadableRed="readableRed",e.TintGreen="tintGreen",e.TintPurple="tintPurple",e.TintBlue="tintBlue",e.TintRed="tintRed"})(Un||(Un={}));var Rn;(function(e){e.CategoryBackground="categoryBackground",e.Invite="invite"})(Rn||(Rn={}));var Cn;(function(e){e.TelemetryOptOut="TelemetryOptOut"})(Cn||(Cn={}));var xn;(function(e){e.Address="Address",e.Email="Email",e.SecretKey="SecretKey",e.Password="Password"})(xn||(xn={}));var Hn;(function(e){e.Leftward="leftward",e.Rightward="rightward"})(Hn||(Hn={}));var In;(function(e){e.SignIn="signIn",e.CheckAccount="checkAccount"})(In||(In={}));var Tn;(function(e){e.Web="web",e.Email="email"})(Tn||(Tn={}));var Fn;(function(e){e.ToggleFullScreen="toggleFullScreen",e.Services="services",e.Hide="hide",e.HideOthers="hideOthers",e.Unhide="unhide",e.ToggleDevTools="toggleDevTools",e.Undo="undo",e.Redo="redo",e.Cut="cut",e.Copy="copy",e.SelectAll="selectAll",e.Close="close",e.Minimize="minimize",e.Zoom="zoom",e.Front="front",e.Paste="paste",e.Reload="reload",e.StartSpeaking="startSpeaking",e.StopSpeaking="stopSpeaking",e.Help="help",e.Window="window",e.EditMenu="editMenu"})(Fn||(Fn={}));var Gn;(function(e){e.None="none",e.Info="info",e.Error="error",e.Question="question",e.Warning="warning"})(Gn||(Gn={}));var Vn;(function(e){e.Home="home",e.Items="items",e.Sidebar="sidebar"})(Vn||(Vn={}));var Nn;(function(e){e.Vaults="vaults",e.Favorites="favorites",e.RecentlyCreated="recentlyCreated",e.RecentlyModified="recentlyModified",e.RecentlyUsed="recentlyUsed",e.FrequentlyUsed="frequentlyUsed",e.Tags="tags",e.AllItems="allItems",e.Archived="archived",e.RecentlyDeleted="recentlyDeleted",e.Categories="categories",e.ItemFieldGroup="itemFieldGroup",e.BillboardGroup="billboardGroup",e.Profile="profile",e.Nearby="nearby",e.ActivationHub="activationHub",e.SecuritySetup="securitySetup"})(Nn||(Nn={}));var Bn;(function(e){e.NearbyItems="nearbyItems"})(Bn||(Bn={}));var Kn;(function(e){e.Home="Home",e.Items="Items",e.Watchtower="Watchtower",e.Verifier="Verifier"})(Kn||(Kn={}));var zn;(function(e){e.Member="member",e.Organizer="organizer",e.Guest="guest"})(zn||(zn={}));var qn;(function(e){e.AuthorizedDriven="authorizedDriven",e.UnauthorizedDriven="unauthorizedDriven"})(qn||(qn={}));var Qn;(function(e){e.Locked="Locked",e.Unlocked="Unlocked"})(Qn||(Qn={}));var Xn;(function(e){e.General="general",e.Appearance="appearance",e.Security="security",e.Privacy="privacy",e.Browser="browser",e.SafariExtension="safariExtension",e.Notifications="notifications",e.AutoFill="autoFill",e.Advanced="advanced",e.Help="help",e.About1Password="about1Password",e.Review="review",e.Developers="developers",e.ManageAccounts="manageAccounts",e.ManageCollections="manageCollections",e.Labs="labs",e.TestUserPreferences="testUserPreferences"})(Xn||(Xn={}));var $n;(function(e){e.Unlock="unlock",e.AuthPrompt="authPrompt",e.Reauthentication="reauthentication"})($n||($n={}));var jn;(function(e){e.InvalidRequest="InvalidRequest",e.UnAuthorizedClient="UnAuthorizedClient",e.AccessDenied="AccessDenied",e.UnSupportedResponseType="UnSupportedResponseType",e.InvalidScope="InvalidScope",e.ServerError="ServerError",e.TemporarilyUnavailable="TemporarilyUnavailable",e.Unknown="Unknown"})(jn||(jn={}));var Yn;(function(e){e.InvalidRequest="invalid_request",e.InvalidClient="invalid_client",e.InvalidGrant="invalid_grant",e.InvalidScope="invalid_scope",e.UnauthorizedClient="unauthorized_client",e.UnsupportedGrantType="unsupported_grant_type",e.Unknown="unknown"})(Yn||(Yn={}));var Zn;(function(e){e.SyncAll="syncAll"})(Zn||(Zn={}));var Jn;(function(e){e.AccountSignout="AccountSignout",e.Deletion="Deletion",e.Deauthorization="Deauthorization",e.SsoAccountSignout="SsoAccountSignout"})(Jn||(Jn={}));var B;(function(e){e.Primary="primary",e.ItemDetails="itemDetails",e.Settings="settings",e.QuickAccess="quickAccess",e.AuthPrompt="authPrompt",e.PasskeyPrompt="passkeyPrompt",e.LargeType="largeType",e.KeyboardShortcutsQX="keyboardShortcutsQX",e.AutofillAccessibility="autofillAccessibility",e.LargeQrCode="largeQrCode",e.None="none"})(B||(B={}));var Te;(function(e){e.Account="account",e.LockedAccount="lockedAccount",e.VaultCollection="vaultCollection"})(Te||(Te={}));var es;(function(e){e.StandardSearch="standardSearch",e.SmartSearch="smartSearch",e.Meta="meta"})(es||(es={}));var ts;(function(e){e.ForceStatusUpdate="forceStatusUpdate",e.ResetAllFlags="resetAllFlags"})(ts||(ts={}));var is;(function(e){e.Light="light",e.Dark="dark",e.System="system"})(is||(is={}));var ns;(function(e){e.Save="save",e.Generate="generate",e.Done="done"})(ns||(ns={}));var ss;(function(e){e.Bitwarden="bitwarden",e.Brave="brave",e.Chrome="chrome",e.Csv="csv",e.Dashlane="dashlane",e.Delinea="delinea",e.Edge="edge",e.Firefox="firefox",e.ICloud="iCloud",e.Keepass="keepass",e.KeePassXc="keePassXc",e.LastPass="lastPass",e.OnePux="onePux",e.RoboForm="roboForm",e.Safari="safari",e.Standalone="standalone"})(ss||(ss={}));var os;(function(e){e.Name="name",e.MainCategory="mainCategory",e.FrequentlyUsed="frequentlyUsed",e.RecentlyUsed="recentlyUsed"})(os||(os={}));var W;(function(e){e.Error="Error",e.Warn="Warn",e.Info="Info",e.Debug="Debug",e.Trace="Trace"})(W||(W={}));var rs;(function(e){e.Url="Url",e.Email="Email",e.Phone="Phone",e.MapApple="MapApple",e.MapGoogle="MapGoogle",e.MapDuckDuckGo="MapDuckDuckGo"})(rs||(rs={}));var as;(function(e){e.Once="Once",e.Transaction="Transaction",e.Monthly="Monthly",e.Annually="Annually",e.Forever="Forever"})(as||(as={}));var cs;(function(e){e.Primary="Primary",e.Secondary="Secondary",e.Tertiary="Tertiary"})(cs||(cs={}));var ls;(function(e){e.AutofillRequestAccessibilityPermissions="AutofillRequestAccessibilityPermissions"})(ls||(ls={}));var se;(function(e){e.AutofillShortcut="autofillShortcut",e.QuickAccessShortcut="quickAccessShortcut"})(se||(se={}));var ds;(function(e){e.ItemList="itemList",e.Item="item",e.Watchtower="watchtower",e.Unknown="unknown"})(ds||(ds={}));var Ee;(function(e){e.Clipboard="clipboard",e.Desktop="desktop"})(Ee||(Ee={}));var hs;(function(e){e.PlainText="plainText",e.Html="html"})(hs||(hs={}));var us;(function(e){e.Production="Production",e.Beta="Beta",e.Nightly="Nightly"})(us||(us={}));var ps;(function(e){e.FaceID="faceID",e.TouchID="touchID",e.Passcode="passcode",e.None="none"})(ps||(ps={}));var ws;(function(e){e.SecretKey="secretKey",e.Sso="sso",e.WebAuthn="webAuthn"})(ws||(ws={}));var gs;(function(e){e.Ramp="ramp"})(gs||(gs={}));var fs;(function(e){e.Login="login",e.CreditCard="credit-card",e.ApiKey="api-key",e.CryptoWallet="crypto-wallet"})(fs||(fs={}));var ms;(function(e){e.LockApp="lockApp"})(ms||(ms={}));var vs;(function(e){e.CreateCollection="CreateCollection",e.ManageCollections="ManageCollections",e.SetUpAnotherDevice="SetUpAnotherDevice",e.AccountsManagement="AccountsManagement",e.AdminDashboard="AdminDashboard",e.Settings="Settings",e.ScanQrCode="ScanQrCode",e.MobileHelpMenu="MobileHelpMenu"})(vs||(vs={}));var ys;(function(e){e.Attention="attention",e.Critical="critical",e.Neutral="neutral",e.Informational="informational",e.Success="success"})(ys||(ys={}));var _s;(function(e){e.InterfaceDensityCompact="interfaceDensityCompact",e.InterfaceDensityComfortable="interfaceDensityComfortable",e.AppIconLight="appIconLight",e.AppIconDark="appIconDark"})(_s||(_s={}));var bs;(function(e){e.Leading="leading",e.Centered="centered",e.Trailing="trailing"})(bs||(bs={}));var Ss;(function(e){e.AnyoneWithTheLink="AnyoneWithTheLink",e.OnlySomePeople="OnlySomePeople"})(Ss||(Ss={}));var ks;(function(e){e.Modal="Modal",e.ErrorStrip="ErrorStrip"})(ks||(ks={}));var As;(function(e){e.OneHour="OneHour",e.OneDay="OneDay",e.SevenDays="SevenDays",e.FourteenDays="FourteenDays",e.ThirtyDays="ThirtyDays"})(As||(As={}));var Ps;(function(e){e.Invisible="Invisible",e.VisibleChecked="VisibleChecked",e.VisibleUnchecked="VisibleUnchecked"})(Ps||(Ps={}));var Ms;(function(e){e.CopyLink="CopyLink",e.ShareLink="ShareLink"})(Ms||(Ms={}));var Ws;(function(e){e.SecretKey="secretKey",e.Sso="sso",e.Passkey="passkey"})(Ws||(Ws={}));var Es;(function(e){e.Header="header",e.List="list",e.ListFlexible="listFlexible"})(Es||(Es={}));var Oe;(function(e){e.QuickAccess="quickAccess",e.Autofill="autofill"})(Oe||(Oe={}));var Os;(function(e){e.Increment="increment",e.Decrement="decrement",e.Reset="reset"})(Os||(Os={}));var Ds;(function(e){e.AllItems="allItems",e.AppleWatchAdd="appleWatchAdd",e.AppleWatchRemove="appleWatchRemove",e.Archive="archive",e.ArchiveLarge="archiveLarge",e.BiometricUnlockAppleFaceId="biometricUnlockAppleFaceId",e.BiometricUnlockAppleTouchId="biometricUnlockAppleTouchId",e.BiometricUnlockAppleWatch="biometricUnlockAppleWatch",e.BiometricUnlock="biometricUnlock",e.BiometricUnlockFingerprint="biometricUnlockFingerprint",e.BiometricUnlockWindowsHello="biometricUnlockWindowsHello",e.Cancel="cancel",e.CancelOutline="cancelOutline",e.Checkmark="checkmark",e.CheckmarkCircle="checkmarkCircle",e.CheckmarkFilled="checkmarkFilled",e.ChevronDown="chevronDown",e.ChevronLeft="chevronLeft",e.ChevronRight="chevronRight",e.ChevronUp="chevronUp",e.Circle="circle",e.Close="close",e.CollapsedMenu="collapsedMenu",e.Copy="copy",e.CreditCard="creditCard",e.CustomizeHome="customizeHome",e.Delete="delete",e.DeleteRow="deleteRow",e.Disclosure="disclosure",e.Document="document",e.DocumentEmpty="documentEmpty",e.Download="download",e.DragHandle="dragHandle",e.Dropdown="dropdown",e.Edit="edit",e.Email="email",e.EmergencyKit="emergencyKit",e.ExternalLink="externalLink",e.FavoriteOff="favoriteOff",e.FavoriteOn="favoriteOn",e.Filter="filter",e.Find="find",e.Folder="folder",e.Frozen="frozen",e.Git="git",e.Help="help",e.HelpBubble="helpBubble",e.Hide="hide",e.Import="import",e.Information="information",e.InsertText="insertText",e.Integration="integration",e.ItemHistory="itemHistory",e.ItemSharing="itemSharing",e.Ladybug="ladybug",e.LargeType="largeType",e.Link="link",e.Lock="lock",e.Minus="minus",e.Missing="missing",e.ModeDark="modeDark",e.ModeLight="modeLight",e.ModeSystem="modeSystem",e.Move="move",e.NavigateBack="navigateBack",e.NavigateForward="navigateForward",e.NewWindow="newWindow",e.NoConnection="noConnection",e.NoConnectionLarge="noConnectionLarge",e.NoResults="noResults",e.Notifications="notifications",e.OnePassword="onePassword",e.OnePasswordLocked="onePasswordLocked",e.OpenInBrowser="openInBrowser",e.Overflow="overflow",e.OverflowApple="overflowApple",e.OverflowHorizontal="overflowHorizontal",e.Passkey="passkey",e.Password="password",e.Paste="paste",e.PersonLocation="personLocation",e.Pin="pin",e.PinUnlock="pinUnlock",e.Plus="plus",e.PlusSmall="plusSmall",e.PreviousSize="previousSize",e.Print="print",e.Unpin="unpin",e.QrCodeScan="qrCodeScan",e.RecentlyDeleted="recentlyDeleted",e.RecentlyDeletedLarge="recentlyDeletedLarge",e.Refresh="refresh",e.Report="report",e.Restore="restore",e.Review="review",e.Search="search",e.Select="select",e.Settings="settings",e.SettingsAdvanced="settingsAdvanced",e.Share="share",e.ShareHistory="shareHistory",e.Show="show",e.Sidebar="sidebar",e.SignIn="signIn",e.Sort="sort",e.Suggestions="suggestions",e.TabBarHome="tabBarHome",e.TabBarItems="tabBarItems",e.TabBarSearch="tabBarSearch",e.TabBarSettings="tabBarSettings",e.TabBarVerifier="tabBarVerifier",e.TabBarWatchtower="tabBarWatchtower",e.Tags="tags",e.Terminal="terminal",e.Trash="trash",e.TrashLarge="trashLarge",e.TravelMode="travelMode",e.Twitter="twitter",e.Unlock="unlock",e.UnlockSettingBiometric="unlockSettingBiometric",e.UnlockSettingBiometricDisabled="unlockSettingBiometricDisabled",e.UnlockSettingBiometricAppleFaceId="unlockSettingBiometricAppleFaceId",e.UnlockSettingBiometricAppleFaceIdDisabled="unlockSettingBiometricAppleFaceIdDisabled",e.UnlockSettingBiometricAppleTouchId="unlockSettingBiometricAppleTouchId",e.UnlockSettingBiometricAppleTouchIdDisabled="unlockSettingBiometricAppleTouchIdDisabled",e.UnlockSettingBiometricAppleWatch="unlockSettingBiometricAppleWatch",e.UnlockSettingPassword="unlockSettingPassword",e.UnlockSettingPinUnlock="unlockSettingPinUnlock",e.UnlockSettingPinUnlockDisabled="unlockSettingPinUnlockDisabled",e.Upload="upload",e.User="user",e.Users="users",e.UserSmall="userSmall",e.UsersSmall="usersSmall",e.VerifierAccepted="verifierAccepted",e.VerifierPending="verifierPending",e.VerifierRejected="verifierRejected",e.VerifierShield="verifierShield",e.Warning="warning",e.WarningLarge="warningLarge",e.Watchtower="watchtower",e.WatchtowerCompromisedDomain="watchtowerCompromisedDomain",e.WatchtowerExpiring="watchtowerExpiring",e.WatchtowerReusedPassword="watchtowerReusedPassword",e.WatchtowerTwoFactorAvailable="watchtowerTwoFactorAvailable",e.WatchtowerUnsecuredWebsite="watchtowerUnsecuredWebsite",e.WatchtowerVulnerablePassword="watchtowerVulnerablePassword",e.WatchtowerWeakPassword="watchtowerWeakPassword",e.WatchtowerDuplicateItem="watchtowerDuplicateItem",e.WatchtowerWrongAccount="watchtowerWrongAccount",e.WhatsApp="whatsApp"})(Ds||(Ds={}));var oe;(function(e){e.ImportantEphemeral="importantEphemeral",e.Persistent="persistent",e.Ephemeral="ephemeral"})(oe||(oe={}));var Ls;(function(e){e.AppleOtpAuth="apple-otpauth",e.OtpAuth="otpauth",e.Yjotp="yjotp"})(Ls||(Ls={}));var Us;(function(e){e.New="New",e.Existing="Existing"})(Us||(Us={}));var Rs;(function(e){e.View="view",e.Edit="edit",e.Manage="manage"})(Rs||(Rs={}));var Cs;(function(e){e.NoViewersRemainingAndUserCanManageVaults="noViewersRemainingAndUserCanManageVaults",e.NoViewersRemainingAndUserCannotManageVaults="noViewersRemainingAndUserCannotManageVaults",e.YouCannotViewAndUserCanManageVaults="youCannotViewAndUserCanManageVaults",e.YouCannotViewAndUserCannotManageVaults="youCannotViewAndUserCannotManageVaults"})(Cs||(Cs={}));var xs;(function(e){e.View="view",e.ViewAndEdit="viewAndEdit",e.Manage="manage",e.ManageAndView="manageAndView",e.FullAccess="fullAccess",e.Custom="custom"})(xs||(xs={}));var Hs;(function(e){e.CompromisedLogins="compromisedLogins",e.VulnerablePasswords="vulnerablePasswords",e.WeakPasswords="weakPasswords",e.UnsecuredUrl="unsecuredUrl",e.DuplicatePassword="duplicatePassword",e.TwoFactorAvailable="twoFactorAvailable",e.PasskeyAvailable="passkeyAvailable",e.Expiring="expiring",e.LastpassImpacted="lastpassImpacted",e.WrongAccount="wrongAccount",e.DuplicateItem="duplicateItem",e.ConflictingShortcut="conflictingShortcut",e.DeveloperWatchtower="developerWatchtower",e.RecoveryCodes="recoveryCodes"})(Hs||(Hs={}));var Is;(function(e){e.SlideOne="SlideOne",e.SlideTwo="SlideTwo",e.SlideThree="SlideThree",e.SlideFour="SlideFour",e.SlideFive="SlideFive"})(Is||(Is={}));var Ts;(function(e){e.Basic="basic",e.Extended="extended"})(Ts||(Ts={}));var Fs;(function(e){e.Required="required",e.Optional="optional",e.Excluded="excluded"})(Fs||(Fs={}));var Gs;(function(e){e.Group="group",e.User="user"})(Gs||(Gs={}));var Vs;(function(e){e.All="All",e.Locked="Locked",e.Unlocked="Unlocked"})(Vs||(Vs={}));var Ns;(function(e){e.ExampleAction="example_action",e.ClipboardCleared="clipboard_cleared",e.SearchHistoryCleared="search_history_cleared",e.ExportSucceeded="export_succeeded",e.SecurityPresetAppliedEasyAndSecure="security_preset_applied_easy_and_secure",e.SecurityPresetAppliedWorkdaySecurity="security_preset_applied_workday_security",e.SecurityPresetAppliedStrictestSecurity="security_preset_applied_strictest_security",e.SecurityPresetAppliedCustom="security_preset_applied_custom",e.UserFeedbackSuccessful="user_feedback_successful",e.UserFeedbackUnsuccessful="user_feedback_unsuccessful",e.VerifierSendingChallenge="verifier_sent_challenge",e.VerifierSendingConfirmation="verifier_sending_confirmation",e.VerifierSendingRejection="verifier_sending_rejection",e.CreateEnvironment="create_environment",e.DeleteEnvironment="delete_environment",e.RenameEnvironment="rename_environment",e.CreateAwsIntegration="create_aws_integration",e.CreateLocalFileMount="create_local_file_mount",e.PinExtension="pin_extension",e.TelemetryModalOptIn="telemetry_modal_opt_in",e.TelemetryModalOptOut="telemetry_modal_opt_out",e.ManageAccountDataUsageOptIn="manage_account_data_usage_opt_in",e.ManageAccountDataUsageOptOut="manage_account_data_usage_opt_out",e.LinkedAppEnrollmentSuccess="linked_app_enrollment_success",e.LinkedAppEnrollmentFailure="linked_app_enrollment_failure",e.AgenticAutofillRequestApproved="agentic_autofill_request_approved"})(Ns||(Ns={}));var Bs;(function(e){e.Success="success",e.Failed="failed"})(Bs||(Bs={}));var Ks;(function(e){e.Shipping="shipping",e.Billing="billing"})(Ks||(Ks={}));var zs;(function(e){e.UnverifiedUser="UnverifiedUser",e.AddressInUse="AddressInUse",e.RateLimit="RateLimit",e.OverQuota="OverQuota",e.RequestError="RequestError",e.InternalError="InternalError"})(zs||(zs={}));var qs;(function(e){e.RegionMatchesAnAccount="regionMatchesAnAccount",e.RegionWillChange="regionWillChange",e.InvalidMyceliumData="invalidMyceliumData"})(qs||(qs={}));var Qs;(function(e){e.Interrupted="Interrupted",e.NoCredential="NoCredential",e.UserCanceled="UserCanceled",e.Unknown="Unknown",e.UnexpectedCredentialType="UnexpectedCredentialType",e.ApplicationError="ApplicationError"})(Qs||(Qs={}));var Xs;(function(e){e.Error="Error",e.Success="Success"})(Xs||(Xs={}));var $s;(function(e){e.Created="created",e.Error="error"})($s||($s={}));var js;(function(e){e.Removed="removed",e.NotFound="notFound",e.NotConfirmed="notConfirmed"})(js||(js={}));var Ys;(function(e){e.Deleted="Deleted",e.Error="Error"})(Ys||(Ys={}));var Zs;(function(e){e.AccountNotFound="accountNotFound",e.AccountLocked="accountLocked"})(Zs||(Zs={}));var Js;(function(e){e.InvalidEmail="invalidEmail",e.InvalidSignInAddress="invalidSignInAddress",e.ServerRequestFailed="serverRequestFailed"})(Js||(Js={}));var eo;(function(e){e.Generic="generic"})(eo||(eo={}));var to;(function(e){e.FailedToGetAccount="failedToGetAccount",e.FailedToCheckDeviceHealth="failedToCheckDeviceHealth"})(to||(to={}));var io;(function(e){e.ConnectionFailed="connectionFailed",e.AccountNotFound="accountNotFound",e.AccountLocked="accountLocked",e.UserGuest="userGuest",e.UserSuspended="userSuspended",e.FilterVaultNotFound="filterVaultNotFound",e.ServerRequestFailed="serverRequestFailed",e.Internal="internal"})(io||(io={}));var no;(function(e){e.NoItemsFound="noItemsFound"})(no||(no={}));var so;(function(e){e.Internal="internal"})(so||(so={}));var oo;(function(e){e.NetworkConnectionFailed="networkConnectionFailed",e.AuthorizationAccountNotFound="authorizationAccountNotFound",e.AuthorizationAccountLocked="authorizationAccountLocked",e.AuthorizationUserGuest="authorizationUserGuest",e.AuthorizationUserSuspended="authorizationUserSuspended",e.SpecialFilterVaultNotFound="specialFilterVaultNotFound",e.SpecialFilterVaultCannotManageAccess="specialFilterVaultCannotManageAccess"})(oo||(oo={}));var ro;(function(e){e.ClientError="clientError",e.ItemEntityIdParseError="itemEntityIdParseError",e.ItemNotFound="itemNotFound",e.CouldNotLoadPreviousItemVersion="couldNotLoadPreviousItemVersion",e.CouldNotRestorePreviousItemVersion="couldNotRestorePreviousItemVersion"})(ro||(ro={}));var ao;(function(e){e.Success="success",e.Failed="failed",e.Error="error"})(ao||(ao={}));var co;(function(e){e.Success="success",e.Error="error"})(co||(co={}));var lo;(function(e){e.ConnectionFailed="connectionFailed",e.AccountNotFound="accountNotFound",e.AccountLocked="accountLocked",e.AccountFrozen="accountFrozen",e.AccountNotFamily="accountNotFamily",e.UserGuest="userGuest",e.UserSuspended="userSuspended",e.VaultNotFound="vaultNotFound",e.VaultAccessCannotBeManaged="vaultAccessCannotBeManaged",e.PermissionMissingManage="permissionMissingManage",e.Internal="internal"})(lo||(lo={}));var ho;(function(e){e.Error="Error",e.Success="Success"})(ho||(ho={}));var uo;(function(e){e.Android="Android",e.Apple="Apple",e.Mac="Mac",e.MacSystemPassword="MacSystemPassword"})(uo||(uo={}));var po;(function(e){e.Updated="updated",e.Error="error"})(po||(po={}));var wo;(function(e){e.Invalid="invalid"})(wo||(wo={}));var go;(function(e){e.BadLength="badLength",e.BadVersion="badVersion"})(go||(go={}));var fo;(function(e){e.Empty="empty",e.MissingEnterpriseSubdomain="missingEnterpriseSubdomain",e.BadDomain="badDomain",e.MissingDomain="missingDomain",e.LooksLikeEmail="looksLikeEmail",e.ParseError="parseError"})(fo||(fo={}));var mo;(function(e){e.CannotRemoveReadWithoutManage="cannotRemoveReadWithoutManage"})(mo||(mo={}));var vo;(function(e){e.NoAppStoreProvided="noAppStoreProvided",e.CannotMakePayment="cannotMakePayment",e.PurchaseFailed="purchaseFailed",e.ProductNotFound="productNotFound",e.CannotDecodeProductIdentifier="cannotDecodeProductIdentifier",e.NoAppStoreResult="noAppStoreResult",e.FailedToDeserializeResponse="failedToDeserializeResponse",e.ExistingPurchaseInProgress="existingPurchaseInProgress",e.UnsupportedPlatform="unsupportedPlatform"})(vo||(vo={}));var yo;(function(e){e.Check="Check",e.MarkAsShown="MarkAsShown"})(yo||(yo={}));var _o;(function(e){e.Granted="granted",e.NotGranted="notGranted"})(_o||(_o={}));var bo;(function(e){e.NotDetermined="notDetermined",e.Denied="denied",e.Authorized="authorized",e.Provisional="provisional",e.Ephemeral="ephemeral",e.Unknown="unknown"})(bo||(bo={}));var Fe;(function(e){e.Cli="Cli",e.Ssh="Ssh",e.DeveloperEnvironment="DeveloperEnvironment",e.SecureRemoteAutofill="SecureRemoteAutofill"})(Fe||(Fe={}));var So;(function(e){e.CredentialsSentSuccessfully="credentialsSentSuccessfully",e.IncorrectCodeChosen="incorrectCodeChosen",e.PromptTimeout="promptTimeout",e.PromptDenied="promptDenied",e.NetworkError="networkError",e.ChannelClosed="channelClosed",e.FeatureDisabled="featureDisabled"})(So||(So={}));var ko;(function(e){e.DeviceUnlocked="DeviceUnlocked",e.DeviceWoke="DeviceWoke"})(ko||(ko={}));var Ao;(function(e){e.Chrome="chrome",e.Firefox="firefox",e.SafariMacos="safari-macos",e.SafariIos="safari-ios"})(Ao||(Ao={}));var Po;(function(e){e.UrlParseFailed="UrlParseFailed",e.TemplateParseFailed="TemplateParseFailed",e.FailedToFindValueForFieldIdentifier="FailedToFindValueForFieldIdentifier",e.FailedToGenerateLargeType="FailedToGenerateLargeType",e.FailedToGenerateWatchtowerReport="FailedToGenerateWatchtowerReport",e.SshKeyParseFailed="SshKeyParseFailed",e.FailedToFindTemplateField="FailedToFindTemplateField",e.InvalidTemplateType="InvalidTemplateType"})(Po||(Po={}));var Mo;(function(e){e.AuthenticationSuccessful="AuthenticationSuccessful",e.AuthenticationFailed="AuthenticationFailed",e.UserCancel="UserCancel",e.UserFallBack="UserFallBack",e.SystemCancel="SystemCancel",e.PasscodeNotSet="PasscodeNotSet",e.BiometryNotAvailable="BiometryNotAvailable",e.BiometryNotEnrolled="BiometryNotEnrolled",e.BiometryLockout="BiometryLockout",e.AppCancel="AppCancel",e.InvalidContext="InvalidContext",e.NotInteractive="NotInteractive",e.WatchNotAvailable="WatchNotAvailable",e.LocalizedStringsFailure="LocalizedStringsFailure",e.FailureReasonUnknown="FailureReasonUnknown",e.Timeout="Timeout",e.BiometryAlreadyInProgress="BiometryAlreadyInProgress"})(Mo||(Mo={}));var Wo;(function(e){e.None="None",e.Biometry="Biometry",e.DeviceCredential="DeviceCredential",e.BiometryOrDeviceCredential="BiometryOrDeviceCredential"})(Wo||(Wo={}));var Eo;(function(e){e.MainAppNotRunning="MainAppNotRunning"})(Eo||(Eo={}));var Oo;(function(e){e.MainAppNotRunning="MainAppNotRunning",e.MainAppOpenTimeout="MainAppOpenTimeout",e.CannotOpenMainApp="CannotOpenMainApp",e.UnknownInvocation="UnknownInvocation",e.BrowserHelperNotRegistered="BrowserHelperNotRegistered"})(Oo||(Oo={}));var Do;(function(e){e.BrowserSignatureInvalid="BrowserSignatureInvalid",e.UnknownBrowser="UnknownBrowser"})(Do||(Do={}));var Lo;(function(e){e.Success="success",e.Failed="failed"})(Lo||(Lo={}));var Uo;(function(e){e.Visa="Visa",e.Mastercard="Mastercard",e.AmericanExpress="AmericanExpress",e.Discover="Discover",e.Jcb="Jcb",e.Maestro="Maestro",e.VisaElectron="VisaElectron",e.UnionPay="UnionPay"})(Uo||(Uo={}));var Ro;(function(e){e.Create="webauthn.create",e.Get="webauthn.get",e.PaymentGet="payment.get"})(Ro||(Ro={}));var Co;(function(e){e.InvalidBrowserSignature="InvalidBrowserSignature",e.UnsupportedBrowser="UnsupportedBrowser",e.DoesNotMatchTeam="DoesNotMatchTeam",e.NotSigned="NotSigned",e.MissingRequirementInfo="MissingRequirementInfo"})(Co||(Co={}));var xo;(function(e){e.FeatureFlagsLabsScreen="feature_flags_labs_screen",e.SetUpAnotherDeviceModal="set_up_another_device_modal",e.SetUpAnotherDeviceScreen="set_up_another_device_screen",e.HomepageScreen="homepage_screen",e.WatchtowerScreen="watchtower_screen",e.StartHereModal="start_here_modal",e.StartHereScreen="start_here_screen",e.AllItemsScreen="all_items_screen",e.AddItemsChooseMethodScreen="add_items_choose_method_screen",e.MigrateYourDataScreen="migrate_your_data_screen",e.PinExtensionScreen="pin_extension_screen",e.GetExtensionScreen="get_extension_screen",e.SetUpAutofillScreen="set_up_autofill_screen",e.PracticeSaveAndFillScreen="practice_save_and_fill_screen",e.AddNewItemScreen="add_new_item_screen",e.ProfileMenu="profile_menu",e.InvitePeopleModal="invite_people_modal",e.InvitePeopleScreen="invite_people_screen",e.ItemTemplateScreen="item_template_screen",e.ItemDetailsScreen="item_details_screen",e.ExportDataModal="export_data_modal",e.GitCommitSigningModal="git_commit_signing_modal",e.DeveloperExperienceHomeScreen="developer_experience_home_screen",e.DeveloperExperienceOnboardingCallout="developer_experience_onboarding_callout",e.SettingsDeveloperScreen="settings_developer_screen",e.DeveloperExperienceSshScreen="developer_experience_ssh_screen",e.DeveloperExperienceActivityScreen="developer_experience_activity_screen",e.CopyItemMenu="copy_item_menu",e.ChromeAutofillPromptScreen="chrome_autofill_prompt_screen",e.BraveAutofillPromptScreen="brave_autofill_prompt_screen",e.AutofillSettingsScreen="autofill_settings_screen",e.SettingsLabsScreen="settings_labs_screen",e.QuickAccessSearchFieldResult="quick_access_search_field_result",e.HelpMenu="help_menu",e.SecurityReviewModal="security_review_modal",e.SecuritySettingsScreen="security_settings_screen",e.RecoveryCodeModal="recovery_code_modal",e.AutofillScreen="autofill_screen",e.UserFeedbackScreen="user_feedback_screen",e.VerifierView="verifier_view",e.VerifierComposeScreen="verifier_compose_screen",e.VerifierChallengeReceivedScreen="verifier_challenge_received_screen",e.VerifierResponseReceivedScreen="verifier_response_received_screen",e.DeveloperEnvironmentScreen="developer_environment_screen",e.DeveloperEnvironmentVariablesTab="developer_environment_variables_tab",e.DeveloperEnvironmentDestinationsTab="developer_environment_destinations_tab",e.InstallExtensionWarningModal="install_extension_warning_modal",e.InstallExtensionBlockingModal="install_extension_block_modal",e.InstallExtensionBanner="install_extension_banner",e.EnableExtensionWarningModal="enable_extension_warning_modal",e.EnableExtensionBlockingModal="enable_extension_block_modal",e.AutofillNotEnabledSnackbar="autofill_not_enabled_snackbar",e.LinkedAppEnrollmentModal="linked_app_enrollment_modal",e.LinkedAppEnrollmentScreen="linked_app_enrollment_screen",e.LinkedAppEnrollmentApprovingDeviceModal="linked_app_enrollment_approving_device_modal",e.LinkedAppEnrollmentApprovingDeviceScreen="linked_app_enrollment_approving_device_screen",e.NotificationScreen="notification_screen",e.PickSecurityPresetNotification="pick_security_preset_notification"})(xo||(xo={}));var Ho;(function(e){e.Button="button",e.TextLink="text_link",e.Modal="modal",e.Screen="screen",e.MediaCard="mediacard",e.Switch="switch",e.SwitchOn="switch_on",e.SwitchOff="switch_off",e.CheckboxOn="checkbox_on",e.CheckboxOff="checkbox_off",e.ToolTip="tooltip",e.Callout="callout",e.Select="select",e.SearchField="search_field",e.Radio="radio",e.Disclosure="disclosure",e.Menu="menu",e.Link="link",e.Banner="banner",e.Billboard="billboard",e.TextField="text_field",e.ListRow="list_row",e.Snackbar="snackbar",e.Notification="notification"})(Ho||(Ho={}));var Io;(function(e){e.Success="success",e.Failed="failed"})(Io||(Io={}));var To;(function(e){e.Success="success",e.NotFound="notFound"})(To||(To={}));var Fo;(function(e){e.Success="success",e.Failure="failure"})(Fo||(Fo={}));var Go;(function(e){e.Metric="metric",e.USImperial="uSImperial"})(Go||(Go={}));var Vo;(function(e){e.Fastmail="fastmail"})(Vo||(Vo={}));var No;(function(e){e.FailedMfaPrompt="FailedMfaPrompt",e.InvalidMfaPromptResponse="InvalidMfaPromptResponse",e.NoMfaOptions="NoMfaOptions",e.MfaTimedOut="MfaTimedOut"})(No||(No={}));var Bo;(function(e){e.UnableToFindDevice="UnableToFindDevice",e.NoStoredDSecret="NoStoredDSecret"})(Bo||(Bo={}));var Ko;(function(e){e.Pages="pages",e.Signin="signin",e.Unlock="unlock"})(Ko||(Ko={}));var zo;(function(e){e.FeatureFlags="featureFlags",e.AutoType="autoType",e.Snippets="snippets",e.PrivacyMode="privacyMode"})(zo||(zo={}));var qo;(function(e){e.DeniedByUser="deniedByUser",e.PromptError="promptError",e.AppError="appError"})(qo||(qo={}));var Qo;(function(e){e.SignUp="signUp",e.LinkExisting="linkExisting"})(Qo||(Qo={}));var Xo;(function(e){e.Challenge="C",e.Verification="V",e.Rejection="R"})(Xo||(Xo={}));var $o;(function(e){e.Unavailable="unavailable",e.RequesterAccountNotAvailable="requesterAccountNotAvailable",e.UserLookupError="userLookupError",e.InternalError="internalError"})($o||($o={}));var jo;(function(e){e.Desktop="Desktop",e.Phone="Phone",e.Tablet="Tablet",e.Browser="Browser"})(jo||(jo={}));var Yo;(function(e){e.GuidedSetup="GuidedSetup",e.InviteModal="InviteModal"})(Yo||(Yo={}));var Zo;(function(e){e.Light="Light",e.Dark="Dark"})(Zo||(Zo={}));var Jo;(function(e){e.InputJsonDeserializationFailed="InputJsonDeserializationFailed",e.MissingTemplateUuid="MissingTemplateUuid",e.MissingItemUrl="MissingItemUrl",e.BadVersionInt="BadVersionInt"})(Jo||(Jo={}));var er;(function(e){e.AccountNotFound="accountNotFound",e.FeatureDisabled="featureDisabled",e.AccountTypeNotSupported="accountTypeNotSupported"})(er||(er={}));var tr;(function(e){e.Member="member",e.Admin="admin",e.Owner="owner"})(tr||(tr={}));var ir;(function(e){e.NetworkError="networkError",e.PermissionDenied="permissionDenied"})(ir||(ir={}));var nr;(function(e){e.Failed="failed"})(nr||(nr={}));var sr;(function(e){e.Code="Code",e.Yubikey="Yubikey"})(sr||(sr={}));var or;(function(e){e.Decimal="decimal",e.PaddedDecimal="paddedDecimal",e.Abbreviated="abbreviated",e.Full="full",e.Narrow="narrow"})(or||(or={}));var rr;(function(e){e.Ok="ok",e.Dismissed="dismissed",e.Timeout="timeout",e.AccountLocked="accountLocked",e.AccountNotFound="accountNotFound",e.UnsupportedClientType="unsupportedClientType",e.PasswordUnlockRequired="passwordUnlockRequired",e.AppMustBeLockedToContinue="appMustBeLockedToContinue",e.SystemAuthDisabled="systemAuthDisabled",e.NotAvailable="notAvailable",e.ClientOutOfDate="clientOutOfDate",e.PromptError="promptError"})(rr||(rr={}));var ar;(function(e){e.InvalidRequest="InvalidRequest",e.JsonSerializeError="JsonSerializeError",e.DeviceKeyNotFound="DeviceKeyNotFound",e.EncryptCredentialBundleError="EncryptCredentialBundleError",e.DecryptCredentialBundleError="DecryptCredentialBundleError",e.StoreError="StoreError",e.DecryptDeviceKeyError="DecryptDeviceKeyError",e.DeviceKeyGenerationError="DeviceKeyGenerationError",e.WriteDeviceKeyToStorageError="WriteDeviceKeyToStorageError",e.EncryptDeviceKeyError="EncryptDeviceKeyError",e.Unknown="Unknown"})(ar||(ar={}));var cr;(function(e){e.Initializing="initializing",e.Connected="connected",e.PermissionErrors="permissionErrors",e.ValidationErrors="validationErrors",e.SynchronizationErrors="synchronizationErrors",e.IncompatibleSandbox="incompatibleSandbox",e.UnableToConnect="unableToConnect"})(cr||(cr={}));var lr;(function(e){e.UserSuspended="userSuspended",e.Other="other"})(lr||(lr={}));var dr;(function(e){e.Decimal="decimal",e.PaddedDecimal="paddedDecimal"})(dr||(dr={}));var hr;(function(e){e.Install="Install",e.Uninstall="Uninstall"})(hr||(hr={}));var ur;(function(e){e.SessionNotFound="sessionNotFound"})(ur||(ur={}));var pr;(function(e){e.Username="username",e.Password="password",e.Totp="totp",e.Sso="sso"})(pr||(pr={}));var wr;(function(e){e.SessionNotFound="sessionNotFound",e.NoDataSource="noDataSource",e.UnexpectedError="unexpectedError"})(wr||(wr={}));var gr;(function(e){e.SessionNotFound="sessionNotFound",e.AlreadyExists="alreadyExists",e.Unsupported="unsupported",e.Io="io"})(gr||(gr={}));var fr;(function(e){e.FailedToGenerateRandom="failedToGenerateRandom"})(fr||(fr={}));var mr;(function(e){e.SessionNotFound="sessionNotFound",e.NoDataSource="noDataSource",e.Io="io",e.FailedToCreateFileSupport="failedToCreateFileSupport",e.Offline="offline",e.Cancelled="cancelled",e.Other="other",e.MalformedZip="malformedZip",e.MalformedFile="malformedFile",e.MalformedCsv="malformedCsv"})(mr||(mr={}));var vr;(function(e){e.Start="start",e.ProcessingExportedAccount="processingExportedAccount",e.Saving="saving"})(vr||(vr={}));var yr;(function(e){e.Bearer="Bearer"})(yr||(yr={}));var _r;(function(e){e.AccountLocked="AccountLocked",e.Ok="Ok"})(_r||(_r={}));var br;(function(e){e.Ok="Ok",e.NoUnlockedAccounts="NoUnlockedAccounts"})(br||(br={}));var Sr;(function(e){e.Ok="Ok",e.FailedToSync="FailedToSync",e.AccountNotFound="AccountNotFound"})(Sr||(Sr={}));var kr;(function(e){e.InvalidRequest="InvalidRequest",e.MissingAccountInformation="MissingAccountInformation",e.MissingUnlockInformationInKeychain="MissingUnlockInformationInKeychain",e.MissingDSecret="MissingDSecret",e.CannotUnlockAccounts="CannotUnlockAccounts",e.CannotEncodeResponse="CannotEncodeResponse",e.Unknown="Unknown",e.CannotEncryptCredentialBundle="CannotEncryptCredentialBundle",e.CannotDecryptCredentialBundle="CannotDecryptCredentialBundle",e.UserDefaultsError="UserDefaultsError"})(kr||(kr={}));var Ar;(function(e){e.Uppercase="uppercase",e.Lowercase="lowercase"})(Ar||(Ar={}));var Pr;(function(e){e.LimitReached="limitReached",e.InternalError="internalError",e.AccountLocked="accountLocked"})(Pr||(Pr={}));var Mr;(function(e){e.Success="success",e.Failure="failure"})(Mr||(Mr={}));var Wr;(function(e){e.Success="success",e.Failure="failure"})(Wr||(Wr={}));var Er;(function(e){e.Success="success",e.NotFound="notFound"})(Er||(Er={}));var Or;(function(e){e.Success="success",e.Failed="failed"})(Or||(Or={}));var Dr;(function(e){e.InvalidSession="InvalidSession",e.SessionLocked="SessionLocked",e.SessionNotConfigured="SessionNotConfigured",e.NakedDomainFailed="NakedDomainFailed",e.InvalidItemTemplate="InvalidItemTemplate",e.BrainSaveObject="BrainSaveObject",e.InvalidSaveRequest="InvalidSaveRequest"})(Dr||(Dr={}));var Lr;(function(e){e.EnvironmentSizeLimitExceeded="environmentSizeLimitExceeded",e.AppError="appError"})(Lr||(Lr={}));var Ur;(function(e){e.DeniedByUser="deniedByUser",e.InvalidResponse="invalidResponse"})(Ur||(Ur={}));var Rr;(function(e){e.Unavailable="unavailable",e.UnableToLoadSettings="unableToLoadSettings",e.UnableToSaveSettings="unableToSaveSettings"})(Rr||(Rr={}));var Cr;(function(e){e.Terrible="Terrible",e.Weak="Weak",e.Fair="Fair",e.Good="Good",e.VeryGood="VeryGood",e.Excellent="Excellent",e.Fantastic="Fantastic",e.NotSpecified="NotSpecified"})(Cr||(Cr={}));var xr;(function(e){e.Default="default",e.Privacy="privacy",e.Ramp="ramp",e.Stripe="stripe"})(xr||(xr={}));var Hr;(function(e){e.LimitReached="limitReached",e.InternalError="internalError"})(Hr||(Hr={}));var Ir;(function(e){e.Warning="warning",e.Info="info"})(Ir||(Ir={}));var De;(function(e){e.ItemCreated="itemCreated",e.Cancelled="cancelled"})(De||(De={}));var Le;(function(e){e.Accepted="Accepted",e.Denied="Denied"})(Le||(Le={}));var Tr;(function(e){e.GenerateDeviceUuidError="GenerateDeviceUuidError",e.SetDeviceUuidError="SetDeviceUuidError",e.EncryptCredentialBundleError="EncryptCredentialBundleError",e.DecryptCredentialBundleError="DecryptCredentialBundleError",e.DeleteDeviceKeyError="DeleteDeviceKeyError"})(Tr||(Tr={}));var Fr;(function(e){e.FeatureFlags="feature_flags",e.ItemSearch="item_search",e.SetUpAnotherDevice="set_up_another_device",e.Homepage="homepage",e.Watchtower="watchtower",e.ActivationHub="activation_hub",e.ManualItemCreate="manual_item_create",e.ItemImport="item_import",e.ExtensionSetup="extension_setup",e.SetUpAutofill="set_up_autofill",e.MobileAutofillTutorial="mobile_autofill_tutorial",e.ExtensionSaveFillTutorial="extension_save_fill_tutorial",e.ManageAccount="manage_account",e.Accounts="accounts",e.InviteMembers="invite_members",e.ItemSharing="item_sharing",e.ExportItems="export_items",e.GitCommitSigning="git_commit_signing",e.DeveloperExperience="developer_experience",e.SshBookmarks="ssh_bookmarks",e.Item="item",e.PasskeySave="passkey_save",e.ChromeAutofillPrompt="chrome_autofill_prompt",e.BraveAutofillPrompt="brave_autofill_prompt",e.DeveloperSettings="developer_settings",e.AntiPeekMode="anti_peek_mode",e.PrivacySettings="privacy_settings",e.HelpMenu="help_menu",e.SecurityReview="security_review",e.Feedback="feedback",e.Verifier="verifier",e.VerifierSendingRequest="verifier_sending_request",e.VerifierReceivingRequest="verifier_receiving_request",e.VerifierReceivingResponse="verifier_receiving_response",e.DeveloperEnvironments="developer_environments",e.ExtensionInstall="extension_install",e.EssentialSetupTelemetryModal="essential_setup_telemetry_modal",e.ExtensionSurvey="extension_survey",e.LinkedAppEnrollment="linked_app_enrollment",e.AgenticAutofill="agentic_autofill"})(Fr||(Fr={}));var Gr;(function(e){e.New="New",e.InReview="InReview",e.Managed="Managed",e.Accepted="Accepted",e.Ignored="Ignored",e.PlanToClose="PlanToClose",e.Closed="Closed"})(Gr||(Gr={}));var Vr;(function(e){e.Allow="allow",e.Deny="deny",e.Dismiss="dismiss"})(Vr||(Vr={}));var Nr;(function(e){e.Success="success",e.Failure="failure"})(Nr||(Nr={}));var Br;(function(e){e.Initialization="initialization",e.Create="create",e.Edit="edit",e.Delete="delete"})(Br||(Br={}));var Kr;(function(e){e.Private="Private",e.Others="Others",e.Everyone="Everyone"})(Kr||(Kr={}));var zr;(function(e){e.CannotRemoveReadWithoutManage="cannotRemoveReadWithoutManage"})(zr||(zr={}));var qr;(function(e){e.Simplified="simplified"})(qr||(qr={}));var Qr;(function(e){e.Success="success",e.Error="error"})(Qr||(Qr={}));var Xr;(function(e){e.Failed="failed"})(Xr||(Xr={}));var ve;(function(e){e.QuickAccess="quickAccess",e.SsoAuthPrompt="ssoAuthPrompt"})(ve||(ve={}));var $r;(function(e){e.CleanUp="CleanUp",e.ConnectionInterrupted="ConnectionInterrupted",e.ConnectionInvalidated="ConnectionInvalidated",e.ConnectionTimeout="ConnectionTimeout",e.ContextDropped="ContextDropped",e.ServerInvalid="ServerInvalid"})($r||($r={}));var Pa=b(896),jr=b.n(Pa);const Ma=Symbol("LogSafeKey");function ye(e){return this instanceof ye?(this[Ma]=e,this.toString=()=>e,this.toJSON=()=>e,this):new ye(e)}function E(e,...t){return ye(e.flatMap((i,n)=>t[n]?[i,t[n]]:i).join(""))}class q{constructor(t,i,n){this.browserWindow=t,this.statePath=i,this.onError=n,l.app.on("before-quit",this.beforeQuit),t.on("close",()=>{l.app.off("before-quit",this.beforeQuit),this.update(E`Attempted to update the window state after it was destroyed. Caused by window close event.`)}),t.on("blur",()=>{this.update(E`Attempted to update the window state after it was destroyed. Caused by window close event.`)}),t.on("moved",this.updateState),t.on("resized",this.updateState)}#e;static isBounds(t){return typeof t!="object"||t===null||t===void 0?!1:Number.isInteger(t.x)&&Number.isInteger(t.y)&&Number.isInteger(t.width)&&Number.isInteger(t.height)}static confineWindowToScreen(t){const i=t.getBounds(),n=l.screen.getDisplayMatching(i).workArea;Ue(i,n),t.setBounds(i)}static moveWindowToScreen(t,i){if(q.isBounds(i)){const{workArea:n}=l.screen.getDisplayMatching(i);t.setBounds({x:n.x,y:n.y})}}static centerWindow(t,i){this.centerWindowWithOffset(t,0,0,i)}static centerWindowWithOffset(t,i,n,r){if(r){const a=t.getBounds();q.moveWindowToScreen(t,r),a.x=Math.round(r.x+r.width/2-a.width/2)-i,a.y=Math.round(r.y+r.height/2-a.height/2)-n,Ue(a,l.screen.getDisplayMatching(r).workArea),t.setBounds(a)}else t.center()}beforeQuit=()=>{this.update(E`Attempted to update the window state after it was destroyed. Caused by app before-quit event.`)};save=()=>{try{jr().writeFileSync(this.statePath,JSON.stringify(this.#e),{encoding:"utf8"})}catch{this.onError(E`Could not save window state.`)}};load=()=>{let{bounds:t,maximized:i,fullscreen:n}=this.#e||{};if(q.isBounds(t)){const{workArea:r}=l.screen.getDisplayMatching(t);Ue(t,r)}else{try{const r=jr().readFileSync(this.statePath).toString(),a=JSON.parse(r);this.#e=Yr(a)}catch{this.onError(E`Could not load window state.`),this.#e=Yr({})}t=this.#e.bounds,i=this.#e.maximized,n=this.#e.fullscreen}if(q.isBounds(t))q.moveWindowToScreen(this.browserWindow,t),this.browserWindow.setBounds(t);else{const r=l.screen.getDisplayNearestPoint(l.screen.getCursorScreenPoint()).workArea;q.centerWindow(this.browserWindow,r)}i&&this.browserWindow.maximize(),n&&this.browserWindow.setFullScreen(!0)};update=t=>{if(this.browserWindow.isDestroyed()){this.onError(t),this.save();return}this.updateState(),this.save()};updateState=()=>{if(this.browserWindow.isDestroyed())return;const t=this.browserWindow.getBounds(),{id:i,bounds:n}=l.screen.getDisplayMatching(t);this.#e={id:i,maximized:this.browserWindow.isMaximized(),fullscreen:this.browserWindow.isFullScreen(),bounds:t,displayBounds:n,displayCount:l.screen.getAllDisplays().length}}}function Yr(e){const t={bounds:{},maximized:!1,fullscreen:!1,id:l.screen.getPrimaryDisplay().id,displayBounds:{},displayCount:l.screen.getAllDisplays().length};if(!q.isBounds(e.bounds))return t;const i=l.screen.getAllDisplays().length,{id:n,bounds:r,workArea:a}=l.screen.getDisplayMatching(e.bounds);return e.displayCount!==void 0&&e.displayCount!==i||e.displayBounds!==void 0&&JSON.stringify(e.displayBounds)!==JSON.stringify(r)?t:(Ue(e.bounds,a),{id:e.id??n,maximized:!!e.maximized,fullscreen:!!e.fullscreen,bounds:e.bounds,displayBounds:e.displayBounds??r,displayCount:i})}function Ue(e,t){e.width>t.width&&(e.width=t.width),e.height>t.height&&(e.height=t.height);const i=e.x+e.width,n=t.x+t.width;i>n&&(e.x+=n-i);const r=e.y+e.height,a=t.y+t.height;r>a&&(e.y+=a-r),e.x<t.x&&(e.x+=t.x-e.x),e.y<t.y&&(e.y+=t.y-e.y)}const Wa=7680,Ea=4320;async function Oa(e,t,i){const n=await Zr(e,i);if(n.result.type==="found"){const h=n.result;return{message:n.message,value:h.content}}const r=t?l.screen.getDisplayNearestPoint(t.getBounds()):l.screen.getPrimaryDisplay(),c=(await l.desktopCapturer.getSources({types:["screen","window"],thumbnailSize:{width:r.bounds.width,height:r.bounds.height}})).map(h=>h.thumbnail).slice(0,10);for(const h of c){const w=await Jr(e,h,Ee.Desktop,i);if(w.result.type==="found")return{message:w.message,value:w.result.content}}return n}async function Zr(e,t){return await Jr(e,l.clipboard.readImage(),Ee.Clipboard,t)}async function Jr(e,t,i,n){const{width:r,height:a}=t.getSize();if(r>Wa||a>Ea)throw new Error("Image dimensions are too great.");const c=t.toPNG();return await e.scanQrCode(c,i,n)}function ea(e){return{id:"scanTotpResult",message:e,behavior:oe.Ephemeral}}const ta=require("original-fs");function ia(e,t){return e.hasOwnProperty(t)}async function yc(e,t,i){let n,r;try{await new Promise((a,c)=>{n=setInterval(()=>{e()||a(null)},t),r=setTimeout(c,i)})}finally{n&&clearInterval(n),r&&clearTimeout(r)}}const Da=(e,t,i="",n)=>{let r;const a=new Promise((c,h)=>{r=setTimeout(()=>{console.warn(`Promise timed out. ${i}`),h(n)},t)});return Promise.race([e,a]).finally(()=>clearTimeout(r))};function na(e,t,i){return Math.min(Math.max(e,t),i)}function z(e){throw new Error(`Unexpected value. "${e}" should have never reached this point.`)}function re(e){return`${e.accountUuid}:${e.vaultUuid}:${e.itemUuid}`}const La="file://";class Ua{handle(t,i){l.ipcMain.handle(t,(n,...r)=>{if(n.senderFrame){if(n.senderFrame.url.startsWith(La))return i(n,...r);throw`unknown RPC user at (${n.senderFrame.url}), rejecting request`}})}}class Ra{constructor(t,i,n,r,a,c,h){this.core=t,this.windowManager=i,this.urlService=n,this.menu=r,this.contextMenu=a,this.shareMenu=c,this.state=h}rpc=new Ua;serve(){l.ipcMain.on("SendPendingEvent",(i,n)=>{this.windowManager.sendPendingEvent(n)}),l.ipcMain.on("CoreLog",(i,{level:n,message:r})=>{this.core.log(n,ye(r))}),this.rpc.handle("fetchResource",(i,n)=>this.core.getResource(n)),this.rpc.handle("generateTotp",async(i,n)=>(await this.core.generateTotp(n)).oneTimePassword),this.rpc.handle("classifyAppUrl",(i,n)=>this.urlService.classifyAppUrl(n)),this.rpc.handle("getFrontEndConfig",()=>this.windowManager.getFrontEndConfig()),this.rpc.handle("invoke",(i,n,r)=>this.core.invoke({type:n,content:r})),this.rpc.handle("executeGql",(i,n)=>this.core.executeGql(n)),this.rpc.handle("getLockScreen",(i,n)=>this.core.getLockScreen(n)),this.rpc.handle("addAccountFromFile",async(i,n)=>{try{const{url:r}=await this.core.invoke({type:"AppUrlFromEmergencyKit",content:{emergencyKitPath:n}});return await this.urlService.captureUrl(r),!0}catch{return this.core.log(W.Error,E`Failed to add account from dropped file.`),!1}}),this.rpc.handle("captureSignInComponents",(i,n)=>{this.urlService.captureSignInComponents(n)}),this.rpc.handle("getUrlFromOpenDialog",async()=>await this.urlService.getUrlFromOpenDialog()),this.rpc.handle("addAccountFromOpenDialog",async()=>await this.urlService.captureUrlFromOpenDialog()),this.rpc.handle("getUserMenu",async(i,n)=>{const r=await this.core.invoke({type:"UserMenu",content:n}),a=r.menu.filter(c=>c.type==="collection"&&c.content.collectionType!==Te.LockedAccount).map(c=>c.content);return this.menu.reload(a),r}),this.rpc.handle("quit",()=>{l.app.quit()}),this.rpc.handle("setCurrentWindowContentSize",(i,n,r)=>{l.BrowserWindow.fromWebContents(i.sender)?.setContentSize(Math.round(n),Math.round(r))}),this.rpc.handle("centerCurrentWindow",i=>{const n=l.BrowserWindow.fromWebContents(i.sender);n&&q.centerWindow(n)}),this.rpc.handle("showCurrentWindow",i=>{const n=l.BrowserWindow.fromWebContents(i.sender);n&&this.windowManager.getOpWindow(n).show()}),this.rpc.handle("closeCurrentWindow",i=>{this.windowManager.close(i.sender)}),this.rpc.handle("hideCurrentWindow",(i,n)=>{this.windowManager.hide(i.sender,n??!1)}),this.rpc.handle("showMenuForCurrentWindow",(i,n)=>{this.windowManager.showMenu(i.sender,n)}),this.rpc.handle("minimizeCurrentWindow",i=>{this.windowManager.minimize(i.sender)}),this.rpc.handle("maximizeCurrentWindow",i=>{this.windowManager.maximize(i.sender)}),this.rpc.handle("handleTitlebarDoubleClick",i=>{const n=l.systemPreferences.getUserDefault("AppleActionOnDoubleClick","string");n==="Minimize"?this.windowManager.minimize(i.sender):n==="Maximize"&&this.windowManager.maximize(i.sender)}),this.rpc.handle("setTitleForCurrentWindow",(i,n)=>{this.windowManager.setTitle(i.sender,n)}),this.rpc.handle("showLargeType",(i,n)=>{this.windowManager.showLargeType(n)}),this.rpc.handle("onFieldActionSelected",async(i,{itemId:n,itemTitle:r,action:a})=>{switch(a.type){case"ToggleReveal":case"ViewRelatedItem":case"ViewPasswordHistory":case"ToggleAlias":case"PinFieldToMobileHomeScreen":case"UnPinFieldFromMobileHomeScreen":case"SetDefaultMobileHomeScreenActionToCopy":case"SetDefaultMobileHomeScreenActionToLargeType":case"SetDefaultMobileHomeScreenActionToShowQrCode":case"SetDefaultMobileHomeScreenActionToGoToItem":case"ShowSshPrivateKeyExportPrompt":case"LargeMap":case"DisplayWifiQrCode":case"ShareQrCode":case"Fill":case"ReportManagedCredentialFailure":break;case"LargeType":{const S=await this.core.getLargeTypeData({itemId:n,fieldIdentifier:a.content});this.windowManager.showLargeType(S.largeTypeValue);break}case"LargeTypeFormattedString":const c=await this.core.getFormattedLargeTypeData({itemId:n,clientFormattedString:a.content});this.windowManager.showLargeType(c.largeTypeValue);break;case"TypeInWindow":case"SecureCopy":case"SecureCopySecretReference":case"SecureCopySshPrivateKey":case"SecureCopyCity":case"SecureCopyCountry":case"SecureCopyFormattedString":case"SecureCopyRegion":case"SecureCopyState":case"SecureCopyStreet":case"SecureCopyZip":case"OpenNetworkLocation":case"ConnectToSshHost":case"OpenUrl":case"OpenAndAutoFillUrl":case"Preview":case"OpenFile":case"ShowInFileBrowser":case"Download":case"Decode":case"SafariGetValueForClipboard":this.core.invoke({type:"FieldAction",content:{itemId:n,action:a}});break;case"ExportSshKey":const h=r??"SSH Key",w=A.join(l.app.getPath("home"),".ssh");let _,U,I;a.content.fieldIdentifier.type==="PublicKey"?(_=this.core.localize({type:"SshKeyExportPublicKeyFilePickerTitle"}),U=h+".pub",I=this.core.localize({type:"SshKeyExportPublicKeyFilePickerMessage"})):(_=this.core.localize({type:"SshKeyExportPrivateKeyFilePickerTitle"}),U=h,I=this.core.localize({type:"SshKeyExportPrivateKeyFilePickerMessage"}));const{canceled:M,filePath:H}=await l.dialog.showSaveDialog({title:_,defaultPath:A.join(w,U),properties:["showHiddenFiles"],message:I});if(M)return;this.core.invoke({type:"FieldAction",content:{itemId:n,action:{...a,content:{...a.content,filePath:H}}}});break;default:z(a)}}),this.rpc.handle("onDragAndDropFieldStart",(i,n,r)=>{let a=!1;const c=l.screen.getCursorScreenPoint(),h=setInterval(()=>{const _=l.screen.getCursorScreenPoint(),U=_.x-c.x,I=_.y-c.y;Math.hypot(U,I)>=40&&(this.windowManager.fade(i.sender,"out",100),a=!0,clearInterval(h))},100),w=()=>{a&&this.windowManager.fade(i.sender,"in",150),clearInterval(h)};r.value&&(l.ipcMain.removeHandler("onDragAndDropFieldEnd"),l.ipcMain.handleOnce("onDragAndDropFieldEnd",w)),this.core.invoke({type:"FieldDragAction",content:{itemId:n,action:r}}).finally(()=>{r.value||w()})}),this.rpc.handle("onQuickAccessItemActionSelected",async(i,{request:n,itemSpecifier:r})=>{const a=n.action.type==="CopyFieldFromQX"||n.action.type==="Autofill"||n.action.type==="ExpandSnippet";await this.windowManager.fade(i.sender,"out",250,!0,a),t(n,r)}),this.rpc.handle("onItemActionSelected",(i,{request:n,itemSpecifier:r})=>{t(n,r)});const t=(i,n)=>{switch(i.action.type){case"OpenInNewWindowFromQX":if(!i.itemListType||!n)return;this.windowManager.showItemDetailsInNewWindow({itemId:re(n.itemUuidComponents),itemListRoute:{type:"ItemList",content:{unlockedRoute:{collectionUuid:i.collectionUuid},properties:{itemListType:i.itemListType}}}}),this.core.invoke({type:"ItemToSearchHistory",content:{type:"ItemId",content:i.itemIds[0]}});break;case"OpenInNewWindow":if(!i.itemListType||!n)return;this.windowManager.showItemDetailsInNewWindow({itemId:re(n.itemUuidComponents),itemListRoute:{type:"ItemList",content:{unlockedRoute:{collectionUuid:i.collectionUuid},properties:{itemListType:i.itemListType}}}});break;case"Open":{let r;i.itemIds.length&&i.itemListType&&n&&(r={type:"ItemDetail",content:{itemId:re(n.itemUuidComponents),itemListRoute:{type:"ItemList",content:{unlockedRoute:{collectionUuid:i.collectionUuid},properties:{itemListType:i.itemListType}}}}},this.windowManager.openRoute(r),this.core.invoke({type:"ItemToSearchHistory",content:{type:"ItemId",content:i.itemIds[0]}}));break}case"Autofill":this.core.invoke({type:"DesktopFill",content:{itemId:i.itemIds[0]}}).then(r=>{switch(r.type){case"needsConfirmation":this.windowManager.promptManualOverride(r.content);break;case"needsAccessibilityPermissions":this.windowManager.showAutofillAccessibility(r.content.windowTitle);break}});break;case"ExpandSnippet":this.core.invoke({type:"ExpandSnippet",content:{itemId:i.itemIds[0]}});break;default:this.core.invoke({type:"ItemAction",content:i})}};this.rpc.handle("quickAccess",(i,n)=>{const r=this.state.getState().qxOpenedBy;return this.core.invoke({type:"QuickAccess",content:{action:n.action,openedBy:r}})}),this.rpc.handle("openCredits",()=>{l.shell.openPath(A.join(__dirname,"CREDITS.html"))}),this.rpc.handle("openLink",(i,n)=>{this.urlService.openCustomUrl(n)}),this.rpc.handle("profile",async(i,n)=>{const{filePath:r}=await l.dialog.showSaveDialog({title:"Choose where to save the profile:",defaultPath:A.join(l.app.getPath("downloads"),"profile.pb"),filters:[{name:"*",extensions:["pb"]}],properties:["createDirectory"],message:"Select a location to store a CPU profile result"});if(!r)throw new Error("Must pick file to save");await this.core.profile(r,n);const a=`go tool pprof -http=:8080 "${r}"`;return l.clipboard.writeText(a),a}),this.rpc.handle("openSystemNotificationPermissions",()=>{}),this.rpc.handle("getDocumentPath",(i,n,r)=>this.windowManager.showOpenDialogWithOptions({defaultPath:n,filters:r?[{name:"",extensions:r}]:void 0})),this.rpc.handle("setModalStatus",(i,n)=>{const r=l.BrowserWindow.fromWebContents(i.sender);r&&(this.windowManager.getOpWindow(r).setModalStatus(n),this.menu.reload([]))}),this.rpc.handle("setRevealStatus",(i,n)=>{this.menu.setRevealStatus(n)}),this.rpc.handle("setSelectedItemIds",(i,n)=>{const r=l.BrowserWindow.fromWebContents(i.sender);r&&(this.windowManager.getOpWindow(r).setSelectedItemIds(n),this.menu.reload([]))}),this.rpc.handle("showContextMenu",(i,n)=>{const r=l.BrowserWindow.fromWebContents(i.sender);r&&this.contextMenu.showMenu(n,{window:r})}),this.rpc.handle("showQXCollectionsMenu",(i,n)=>{const r=this.windowManager.getQXWindowSize(),a=l.BrowserWindow.fromWebContents(i.sender);a&&this.contextMenu.showMenu(n,{window:a,x:r.width-40,y:60})}),this.rpc.handle("showShareMenu",(i,n,r)=>{this.shareMenu.showMenu(n,r)}),this.rpc.handle("onRouteChanged",(i,n)=>{const r=l.BrowserWindow.fromWebContents(i.sender);if(!r)return;this.windowManager.getOpWindow(r).setRoute(n),this.menu.reload([]);const a=()=>{try{return JSON.stringify(n)}catch{return this.core.log(W.Error,E`Failed to stringify route for UINavigationStateChanged`),JSON.stringify({type:"ItemList",content:{type:"ItemList",content:{unlockedRoute:{collectionUuid:"everything"},properties:{itemListType:{type:"AllItems"}}}}})}};this.core.invoke({type:"FrontendEvent",content:{type:"UINavigationStateChanged",content:{state:a()}}})}),this.rpc.handle("localize",(i,n)=>this.core.localize(n)),this.rpc.handle("getLocale",()=>this.core.getLocale()),this.rpc.handle("setSecureInput",(i,n)=>{this.windowManager.setSecureInput(i.sender,n)}),this.rpc.handle("webauthnSign",(i,n)=>this.core.webauthnSign(n)),this.rpc.handle("getCameraAccessStatus",()=>l.systemPreferences.getMediaAccessStatus("camera")),this.rpc.handle("openSystemCameraPermissions",()=>{let i=null;switch(process.platform){case"darwin":i="x-apple.systempreferences:com.apple.preference.security?Privacy_Camera";break;case"win32":i="ms-settings:privacy-webcam";break;default:break}i!==null&&l.shell.openExternal(i)}),this.rpc.handle("showKeyboardShortcutsQX",()=>{this.windowManager.showKeyboardShortcutsQX()}),this.rpc.handle("showLargeQrCodeWindow",(i,n,r)=>{this.windowManager.showLargeQrCodeWindow(n,r)}),this.rpc.handle("secureCopy",(i,n,r=!1)=>{this.core.invoke({type:"SecureCopy",content:n}).then(()=>{r&&(i.sender.isDestroyed()||i.sender.delete())})}),this.rpc.handle("parseClipboardQr",async i=>{const n=l.BrowserWindow.fromWebContents(i.sender),r=await Zr(this.core,"otpauth");return n&&r.result.type==="found"&&this.windowManager.getOpWindow(n).send("ShowToastNotification",ea(r.message)),r}),this.rpc.handle("scanTotp",i=>Oa(this.core,this.windowManager.getFocusedWindow()?.browserWindow,"otpauth").then(n=>{const r=l.BrowserWindow.fromWebContents(i.sender);return r&&this.windowManager.getOpWindow(r).send("ShowToastNotification",ea(n.message)),n?.value})),this.rpc.handle("showOpenDialogWithOptions",(i,n)=>this.windowManager.showOpenDialogWithOptions({defaultPath:l.app.getPath("downloads"),...n})),this.rpc.handle("openSettings",(i,n)=>{this.windowManager.showSettings(n)}),this.rpc.handle("dismissSsoEnrollmentCodeModal",()=>{this.windowManager.primaryWindow?.send("DismissSsoEnrollmentCodeModal",void 0)}),this.rpc.handle("setSettingsWindowTitle",(i,n)=>{this.windowManager.setSettingsWindowTitle(n)}),this.rpc.handle("setPrimaryWindowFloatingSidebarOverride",(i,n)=>{this.windowManager.setPrimaryWindowFloatingSidebarOverride(n),this.menu.reload([])}),this.rpc.handle("showAuthPrompt",i=>this.windowManager.showAuthPrompt()),this.rpc.handle("showPasskeyPrompt",i=>this.windowManager.showPasskeyPrompt()),this.rpc.handle("focusAuthPrompt",i=>this.windowManager.focusAuthPrompt()),this.rpc.handle("focusPasskeyPrompt",i=>this.windowManager.focusPasskeyPrompt()),this.rpc.handle("closeAuthPrompt",i=>this.windowManager.closeAuthPrompt()),this.rpc.handle("registerPasskeySelection",(i,n)=>{this.windowManager.registerPasskeySelection(n)}),this.rpc.handle("signInPasskeySelection",(i,n)=>{this.windowManager.signInPasskeySelection(n)}),this.rpc.handle("setAuthPromptAlwaysOnTop",(i,n)=>{this.windowManager.setAuthPromptAlwaysOnTop(n)}),this.rpc.handle("generateSsoRedirectUrl",(i,n)=>this.core.invoke({type:"GenerateSsoRedirectUrl",content:n})),this.rpc.handle("authPromptFallbackApprovalMethod",async(i,n)=>{const r=await this.core.invoke({type:"AuthPrompt",content:{type:"fallback",content:n}});if(this.windowManager.removeEmbeddedAuthFromAuthPrompt(),r.type==="failureAndFallback")return r.content.fallbackMethodViewModel;throw TypeError("Incorrect response type.")}),this.rpc.handle("authPromptUnlock",(i,n)=>this.core.invoke({type:"AuthPrompt",content:{type:"unlock",content:n}})),this.rpc.handle("authPromptApprove",(i,n)=>{this.windowManager.authPromptWindow?.approve(n)}),this.rpc.handle("captureTrustedDeviceSignInResponse",(i,n)=>{this.urlService.captureTrustedDeviceSignInResponse(n)}),this.rpc.handle("showInFileBrowser",(i,n)=>{l.shell.showItemInFolder(n)}),this.rpc.handle("saveContentToFile",async(i,n,r,a,c)=>new Promise(async(h,w)=>{const{filePath:_}=await l.dialog.showSaveDialog(c?{...c,defaultPath:A.join(l.app.getPath(a),r)}:{defaultPath:A.join(l.app.getPath(a),r)});if(!_)return w("No file path");(0,ta.writeFileSync)(_,n),l.shell.openPath(_),h()})),this.rpc.handle("hasPrinter",async i=>(await new l.BrowserWindow({show:!1}).webContents.getPrintersAsync()).length>0),this.rpc.handle("downloadHtmlAsImage",(i,n)=>{const h=new l.BrowserWindow({show:!1,width:318,height:318,useContentSize:!0,webPreferences:{contextIsolation:!0}});h.loadURL(`data:text/html;charset=utf-8,${encodeURI(n)}`),h.webContents.on("did-finish-load",()=>{const w=A.join(l.app.getPath("downloads"),"wifiQrCode.png");h.webContents.capturePage().then(_=>{(0,ta.writeFileSync)(w,_.toPNG()),l.shell.openPath(w),h.close()})})}),this.rpc.handle("print",(i,n)=>new Promise((r,a)=>{const c=new l.BrowserWindow({show:!1});c.loadURL(`data:text/html;charset=utf-8,<pre>${encodeURI(n)}</pre>`),c.webContents.once("did-finish-load",()=>{c.webContents.print({},(h,w)=>{h?r():a(w),c.close()})})})),this.rpc.handle("selectDotEnvFileMountPath",async(i,n)=>{const{filePath:r}=await l.dialog.showSaveDialog({defaultPath:".env",properties:["showHiddenFiles"],...n});return r}),this.rpc.handle("getDotEnvFilePath",async(i,n)=>await this.windowManager.showOpenDialogWithOptions({properties:["openFile","showHiddenFiles"],...n})||"")}}function Ca(e){switch(e.type){case"Vault":return{type:e.type,content:{type:"VaultId",content:e.content.rowId}};default:return e}}function Ge(e){return e.includes(":")?{type:"Components",content:xa(e)}:{type:"ItemId",content:e}}function xa(e){const t=e.split(":");if(t.length!==3)throw new Error(`Invalid itemId format: ${e}. Expected format is accountUuid:vaultUuid:itemUuid`);return{accountUuid:t[0],vaultUuid:t[1],itemUuid:t[2]}}class Ha{constructor(t,i,n,r,a){this.core=t,this.windowManager=i,this.state=n,this.settings=r,this.urlService=a}#e=!1;#t=[];#i=!1;#n;init=()=>{this.reload([]),this.settings.on("change",()=>{this.settings.get("floatingSidebar")!==this.settings.previous("floatingSidebar")&&this.reload([])}),this.core.on("LockStateChanged",()=>{this.reload([])}),l.app.on("browser-window-focus",()=>{this.reload([])}),l.app.on("browser-window-blur",()=>{this.windowManager.focusedWindow==="none"&&this.reload([])})};setRevealStatus=t=>{this.#e=t,this.reload([])};reload=async t=>{if(this.#i){this.#n=t;return}else{this.#i=!0;let i=t;for(;i;){try{await this._reload(i)}catch(n){this.core.log(W.Error,E`Failed to reload main menu`)}i=this.#n,this.#n=void 0}this.#i=!1}};_reload=async t=>{const i=this.windowManager.getFocusedWindow()?.getRoute(),n=()=>{if(!(i?.type!=="ItemDetail"&&i?.type!=="EditItem"))return Ge(i.content.itemId)},r=await this.core.invoke({type:"MainMenu",content:{isEditing:i?.type==="EditItem",itemListType:i?.type==="ItemList"?i.content.content.properties.itemListType:void 0,itemSpecifier:n(),windowContext:this.windowManager.getWindowContext(),collections:t,currentItemRevealInverted:this.#e}});this.#t=r.menuElements,l.Menu.setApplicationMenu(this.mainMenu())};mainMenu=()=>l.Menu.buildFromTemplate(this.#t?.map(this.convertMenuElement));convertMenuElement=t=>{switch(t.type){case"MenuOptionElement":return{label:t.content.title.replaceAll("&","&&"),role:t.content.role,submenu:t.content.submenu.length>0?t.content.submenu.map(this.convertMenuElement):void 0,accelerator:t.content.shortcut,visible:t.content.visible,enabled:t.content.enabled,click:async()=>{if(t.content.action)switch(t.content.action.type){case"AddAccount":this.windowManager.showModal("signIn");break;case"AccountFromEmergencyKit":this.urlService.captureUrlFromOpenDialog();break;case"OpenUrl":this.urlService.openUrlInBrowser(t.content.action.content.url);break;case"OpenRoute":switch(this.windowManager.focusedWindow){case"quickAccess":let n;switch(t.content.action.content.route.type){case"Unlocked":n=t.content.action.content.route.content;case"Locked":n=t.content.action.content.route.content;break;default:z(t.content.action.content.route)}n&&this.windowManager.changeQxCollection(n);break;case"primary":default:const r=t.content.action.content.route;r.type==="Locked"?this.windowManager.showModal("unlockAccount",{collectionUuid:r.content}):this.windowManager.openRoute({type:"ItemList",content:{type:"ItemList",content:{unlockedRoute:{collectionUuid:r.content},properties:{itemListType:{type:"AllItems"}}}}})}break;case"ShowKeyboardShortcuts":this.windowManager.showModal("keyboardShortcuts");break;case"OpenLogsFolder":this.core.invoke({type:"OpenLogsDirectory",content:void 0});break;case"SendDiagnostics":this.core.invoke({type:"ShowDiagnosticsAlert",content:void 0});break;case"UpdateWatchtowerDefinitions":this.core.invoke({type:"UpdateWatchtowerDefinitions",content:void 0});break;case"RediscoverSafariExtensions":this.core.invoke({type:"RediscoverSafariExtensions",content:void 0});break;case"OpenSettingsWindow":this.windowManager.showSettings(t.content.action.content.category),t.content.action.content.checkForUpdates&&this.core.invoke({type:"CheckForOnlineUpdate",content:{force:!0,user_initiated:!0}});break;case"EditSelectedItem":this.windowManager.primaryWindow?.send("EditSelectedItem");break;case"SaveSelectedItem":this.windowManager.primaryWindow?.send("SaveSelectedItem");break;case"MakeUpperCase":this.windowManager.getFocusedWindow()?.textTransform("uppercase");break;case"MakeLowerCase":this.windowManager.getFocusedWindow()?.textTransform("lowercase");break;case"Capitalize":this.windowManager.getFocusedWindow()?.textTransform("capitalize");break;case"Share":this.windowManager.showModal("shareItem",{itemSpecifier:Ge(t.content.action.content)});break;case"OpenInNewWindow":this.windowManager.showItemDetailsInNewWindow({itemListRoute:{type:"ItemList",content:{unlockedRoute:{collectionUuid:t.content.action.content.collectionUuid},properties:{itemListType:{type:"AllItems"}}}},itemId:t.content.action.content.itemId});break;case"Search":this.windowManager.showSearch();break;case"Find":this.windowManager.showSearchFilter();break;case"Lock":this.core.invoke({type:"Lock",content:void 0});break;case"Quit":l.app.quit();break;case"CreateNewItem":this.windowManager.showModal("itemCatalog",{initialEditItemContext:t.content.action.content.context});break;case"CreateNewItemShortcut":this.windowManager.createNewItem();break;case"SyncAll":this.core.invoke({type:"SyncAll",content:t.content.action.content});break;case"MigrateDataUsingImport":this.core.invoke({type:"MigrateDataUsingImport",content:t.content.action.content.request}).then(n=>{n&&this.windowManager.showModal("migrateYourData",{initialViewModel:n})});break;case"MigrateYourDataGuide":this.core.invoke({type:"MigrateYourDataGuide",content:t.content.action.content}).then(n=>{n&&this.windowManager.showModal("importGuide",{initialViewModel:n})});break;case"Export":this.windowManager.showModal("export",{accountUuid:t.content.action.content.request.accountUuid});break;case"CreateNewVault":this.core.invoke({type:"CreateVaultViewModel",content:t.content.action.content.request}).then(n=>{n.type==="viewModel"&&this.windowManager.showModal("createVault",{initialViewModel:n.content})});break;case"SignOut":this.core.invoke({type:"SignOutAccount",content:t.content.action.content.request});break;case"SetUpAnotherDevice":const i=t.content.action.content.accountUuid;this.windowManager.showModal("setupAnotherDevice",{accountUuid:i});break;case"Back":this.windowManager.goBack();break;case"Forward":this.windowManager.goForward();break;case"RevealOrConcealPasswords":this.windowManager.getFocusedWindow()?.send("RevealOrConcealPasswords");break;case"Undo":{this.windowManager.getFocusedWindow()?.undo();break}case"Redo":{this.windowManager.getFocusedWindow()?.redo();break}case"Copy":{this.windowManager.getFocusedWindow()?.browserWindow.webContents.copy();break}case"Cut":{this.windowManager.getFocusedWindow()?.browserWindow.webContents.cut();break}case"Paste":{this.windowManager.getFocusedWindow()?.browserWindow.webContents.paste();break}case"SelectAll":{this.windowManager.getFocusedWindow()?.selectAll();break}case"ToggleSidebar":{this.core.invoke({type:"SidebarAction",content:{type:"toggleFloating",content:void 0}});break}case"PerformItemActionRequest":this.core.invoke({type:"ItemAction",content:{...t.content.action.content,itemListType:t.content.action.content.itemListType?Ca(t.content.action.content.itemListType):void 0}});break;case"PerformMoveItemRequest":this.windowManager.showModal("moveItem",t.content.action.content);break;case"PerformSettingsRequest":this.core.invoke({type:"Settings",content:t.content.action.content.request});break}}};case"SeparatorElement":return{type:"separator"}}}}class Ia{constructor(t,i,n){this.core=t,this.windowManager=i,this.state=n,t.on("LockStateChanged",c=>{c===N.Locked&&this.#e.closePopup()});const r=async(c,h)=>{const w=this.windowManager.getOpWindow(c);let _;try{_=await w.getSelectionContext()}catch{this.core.log(W.Error,E`Could not show context menu`);return}if(!_)return;const{noCopy:U,sensitive:I,concealed:M}=_,H=h.selectionText.length>0,S=h.isEditable,P=!M&&!U,T=!M&&!U&&!I,$=pe=>{const we=()=>{return;try{ke=l.systemPreferences.getUserDefault("NSPreferredWebServices","dictionary")}catch{return}};let be="Google",Se="https://google.com/search";const $e=we();if($e)switch(be=$e.name,$e.id){case"com.duckduckgo":Se="https://duckduckgo.com/search";break;case"com.yahoo.www":Se="https://yahoo.com/search";break;case"com.bing.www":Se="https://bing.com/search";break;case"org.ecosia.www":Se="https://ecosia.org/search";break}return{id:"searchSelection",label:"Search with "+be,click(){const ke=new URL(Se);ke.searchParams.set("q",pe.selectionText),l.shell.openExternal(ke.toString())}}},G=S&&H&&T&&!!h.misspelledWord,_e=G?h.dictionarySuggestions.map(pe=>({label:pe,click:(we,be)=>{be instanceof l.BrowserWindow&&be?.webContents.replaceMisspelling(we.label)}})):[],Qe=G?{label:"Learn Spelling",click:(pe,we)=>{we instanceof l.BrowserWindow&&we?.webContents.session.addWordToSpellCheckerDictionary(h.selectionText)}}:void 0,Wc=h.selectionText.trim().length>30?h.selectionText.trim().slice(0,30)+"\u2026":h.selectionText.trim(),lc=void 0,dc=S?{label:"Cut",enabled:H&&S&&P,click:()=>{c.webContents.cut()}}:void 0,hc=S||H||h.linkURL?{label:"Copy",enabled:H&&P||!!h.linkURL,click:()=>{c.webContents.copy()}}:void 0,uc=S?{label:"Paste",enabled:h.editFlags.canPaste,click:()=>{c.webContents.paste()}}:void 0,pc=H&&T?$(h):void 0,wc=void 0,gc=void 0,fc=void 0,mc=void 0,ue={type:"separator",visible:!1},Xe=[..._e,ue,Qe,ue,lc,pc,ue,dc,hc,uc,ue,wc,ue,gc,fc,ue,mc].filter(Boolean);Xe.length&&Xe.find(pe=>pe.visible!==!1)&&(this.#e=l.Menu.buildFromTemplate(Xe),this.#e.popup())},a=c=>{c instanceof l.BrowserWindow&&c.webContents.on("context-menu",(h,w)=>{r(c,w).catch(()=>{console.error("Could not show context menu")})})};for(const c of this.windowManager.getAllWindows())a(c.browserWindow);l.app.on("browser-window-created",(c,h)=>{a(h)})}#e=new l.Menu;showMenu=(t,i)=>{if(!t.length)return;const n=(c,{itemId:h})=>{if(c)switch(c.type){case"route":this.windowManager.openRoute(c.content);break;case"invocation":{if(c.content.type!=="ItemAction")return;const w=c.content.content.action;if(w.type==="OpenInNewWindow"&&h&&c.content.content.itemListType)this.windowManager.showItemDetailsInNewWindow({itemId:h,itemListRoute:{type:"ItemList",content:{unlockedRoute:{collectionUuid:c.content.content.collectionUuid},properties:{itemListType:c.content.content.itemListType}}}});else if(w.type==="Move")this.windowManager.showModal("moveItem",w.content);else if(w.type==="Share"){if(!h)throw new Error(`itemId missing for ${w.type}`);this.windowManager.showModal("shareItem",{itemSpecifier:Ge(h)})}else if(w.type==="SharingDetails"){if(!h)throw new Error(`itemId missing for ${w.type}`);this.windowManager.showModal("sharingDetails",{itemId:h})}else if(w.type==="CommitSigning"){if(!h)throw new Error(`itemId missing for ${w.type}`);this.core.invoke({type:"CommitSigning",content:{type:"modal",content:{itemId:h}}}).then(_=>{_.type!=="success"&&this.windowManager.showModal("commitSigning",{initialViewModel:_})});return}else this.core.invoke(c.content);break}case"sidebarAction":{if(c.content.type==="childAction")switch(c.content.content.action.type){case"renameTag":{this.core.invoke({type:"RenameTagViewModel",content:c.content.content.action.content}).then(w=>{w.type==="viewModel"&&c.content.type==="childAction"&&this.windowManager.showModal("renameTag",{initialViewModel:w.content,tagActionScopeCollectionUuid:c.content.content.collectionUuid})});break}case"deleteTag":{this.core.invoke({type:"SidebarAction",content:c.content});break}case"editVault":{this.core.invoke({type:"EditVaultViewModel",content:c.content.content.action.content}).then(w=>{w.type==="viewModel"&&this.windowManager.showModal("editVault",{initialViewModel:w.content})});break}case"deleteVault":{this.core.invoke({type:"DeleteVaultViewModel",content:c.content.content.action.content}).then(w=>{w.type==="viewModel"&&this.windowManager.showModal("deleteVault",{initialViewModel:w.content})});break}case"manageVault":{const w=c.content.content.action.content.vaultEntityId;this.windowManager.showModal("manageAccess",{vaultEntityId:w});break}case"manageVaultExternal":{this.core.invoke({type:"SidebarAction",content:c.content});break}case"copyVaultUUID":{this.core.invoke({type:"CopyVaultUUID",content:c.content.content.action.content});break}default:z(c.content.content.action)}break}case"fieldAction":{i?.window&&this.windowManager.getOpWindow(i.window).send("SelectFieldAction",c.content);break}case"modalFieldAction":{i?.window&&this.windowManager.getOpWindow(i.window).send("SelectModalFieldAction",c.content);break}case"qxAction":{if(c.content.type==="changeCollection"){const w=c.content.content;this.windowManager.changeQxCollection(w)}else this.core.log(W.Error,E`Unhandled client action`);break}case"submenuAction":break;case"confirmRemoveFromList":{this.windowManager.primaryWindow?.send("ConfirmRemoveFoundAccount",c);break}case"foundAccountsRemoveFromList":{this.windowManager.primaryWindow?.send("ConfirmRemoveNewFoundAccounts",c.content);break}default:z(c)}},r=async c=>Promise.all(c.map(async h=>({label:h.label?.replaceAll("&","&&"),checked:h.checked,icon:void 0,click:()=>n(h.action,{itemId:h.itemId,windowId:h.windowId}),type:h.type||(h.checked?"checkbox":void 0),enabled:!!h.action,submenu:h.type==="submenu"&&h.submenu?await r(h.submenu):void 0})));r(t).then(c=>{this.#e=l.Menu.buildFromTemplate(c),this.#e.popup(i)})}}const sa=require("perf_hooks");var Re=b(434);const Ta=require("os"),Fa=3e4,oa=()=>l.nativeTheme.shouldUseDarkColors?"#333":"#f7f7f7",Ga=e=>({autoHideMenuBar:!0,show:!1,backgroundColor:oa(),titleBarStyle:"hidden",trafficLightPosition:{x:20,y:18},webPreferences:{preload:A.join(__dirname,"preload.js"),session:e,nodeIntegration:!1,contextIsolation:!0,sandbox:!0,disableBlinkFeatures:"Auxclick",devTools:We()}});class Z{window;core;settings;windowState;loading;name;hasOpenModals;selectedItemIds;route;titlebarOverlayEnabled;on;once;gqlChannel;secureInputEnabled=!1;rtsRegistered;constructor(t){const i=Ga(t.session);t.vibrant&&delete i.backgroundColor,this.window=new l.BrowserWindow({...i,...t.browserWindowOptions,webPreferences:{...i.webPreferences,...t.browserWindowOptions.webPreferences}}),this.on=this.window.on.bind(this.window),this.once=this.window.once.bind(this.window),this.route=void 0,this.hasOpenModals=!1,this.selectedItemIds=[],this.loading=!0,this.window.loadFile(t.rootFile),this.name="OpWindow",this.rtsRegistered=0,this.windowState=t.statePath?new q(this.window,A.join(t.statePath),a=>this.core.log(W.Error,a)):void 0,this.core=t.core,this.settings=t.settings,this.windowState&&this.windowState.load(),this.titlebarOverlayEnabled=t.titlebarOverlayEnabled,this.window.on("show",()=>{this.window.isDestroyed()||this.core.forceWindowActivation(this.window)}),this.gqlChannel=Aa(a=>{this.window.isDestroyed()||this.window.webContents.send("gqlSubscriptionResponse",a)});const n=(a,c)=>{const h=l.BrowserWindow.fromWebContents(a.sender);!h||h!==this.window||this.gqlChannel.send(c)};l.ipcMain.on("gqlSubscriptionRequest",n),this.window.once("show",()=>{this.core.setCurrentProcessAumid()}),this.window.on("focus",()=>{this.secureInputEnabled&&Z.setSecureInputGlobal(!0),this.updateWindowControlsOverlay(),this.send("Focus")}),this.on("blur",()=>{this.secureInputEnabled&&Z.setSecureInputGlobal(!1),this.updateWindowControlsOverlay(),this.send("Blur")}),this.window.on("closed",()=>{l.ipcMain.off("gqlSubscriptionReceive",n),this.gqlChannel.close(),this.secureInputEnabled&&(Z.setSecureInputGlobal(!1),this.secureInputEnabled=!1)});const r=()=>{this.window.isDestroyed()||(t.vibrant||this.window.setBackgroundColor(oa()),this.updateWindowControlsOverlay())};l.nativeTheme.on("updated",r),this.on("close",()=>{l.nativeTheme.off("updated",r)}),this.window.webContents.once("did-finish-load",()=>{this.window.isDestroyed()||(this.loading=!1,this.core.protectProcessMemory(this.osPid))}),this.updateWindowControlsOverlay()}send(t,...i){if(this.window.isDestroyed())return;const n=i[0];this.window.webContents.send(t,n)}show(){if(this.window.isDestroyed())return;const t=()=>{this.window.isDestroyed()||(this.window.isMinimized()&&this.window.restore(),this.window.setOpacity(1),this.window.setIgnoreMouseEvents(!1),this.window.isVisible()?this.core.forceWindowActivation(this.window):this.window.show())};if(!this.loading){this.loading=!1,t();return}this.rtsRegistered===0&&(this.rtsRegistered+=1,this.window.webContents.once("did-finish-load",()=>{this.window.isDestroyed()||(this.loading=!1,t())}))}close(){this.window.close()}closeFilePreview(){}getPosition(){return this.window.getPosition()}setPosition(t,i){this.window.setPosition(t,i)}focus(){this.window.focus()}destroy(){this.window.destroy()}getTitle(){return this.window.getTitle()}setTitle(t){return this.window.setTitle(t)}setRoute(t){this.route=t}getRoute(){return this.route}getModalStatus(){return this.hasOpenModals}setModalStatus(t){this.hasOpenModals=t}getSelectedItemIds(){return this.selectedItemIds}setSelectedItemIds(t){this.selectedItemIds=t}undo(){this.window.isDestroyed()||this.window.webContents.undo()}redo(){this.window.isDestroyed()||this.window.webContents.redo()}selectAll(){this.window.isDestroyed()||this.window.webContents.selectAll()}textTransform(t){this.window.isDestroyed()||this.send("TextTransform",t)}getSelectionContext=()=>{const t=()=>{l.ipcMain.removeHandler("sendSelectionContext")};t();const i=new Promise(n=>{l.ipcMain.handle("sendSelectionContext",(r,a)=>{r.sender===this.window.webContents&&n(a)}),this.send("RequestSelectionContext")}).finally(t);return Da(i,250).finally(t)};setSecureInput(t){this.secureInputEnabled=t,this.isFocused&&Z.setSecureInputGlobal(t)}static setSecureInputGlobal(t){}setVisibleOnAllWorkspaces(t){this.window.setVisibleOnAllWorkspaces(t)}matchWindow(t){return t===this.window}reloadIgnoringCache(){this.window.webContents.reloadIgnoringCache()}whenDestroyed(t){if(this.window.isDestroyed()){t();return}this.window.webContents.on("destroyed",t)}get osPid(){return this.window.webContents.getOSProcessId()}get windowSize(){const[t,i]=this.window.getSize();return{width:t,height:i}}get displayNearestToCursor(){return l.screen.getDisplayNearestPoint(l.screen.getCursorScreenPoint())}reload(t){t?this.window.webContents.reloadIgnoringCache():this.window.webContents.reload()}update(t){this.windowState?.update(t)}updateZoomFactor(){this.window.isDestroyed()||(this.window.webContents.setZoomFactor(this.settings.get("zoomLevel")/100),this.updateWindowControlsOverlay())}updateWindowControlsOverlay(){if(this.window.isDestroyed()||!this.titlebarOverlayEnabled)return;const t=Math.round(52*this.window.webContents.getZoomFactor()),i=l.nativeTheme.shouldUseDarkColors?"rgba(0,0,0,0)":"rgba(255,255,255,0)";let n;this.window.isFocused()?l.nativeTheme.shouldUseDarkColors?n="rgba(255,255,255,0.70)":n="rgba(0,0,0,0.70)":l.nativeTheme.shouldUseDarkColors?n="rgba(255,255,255,0.30)":n="rgba(0,0,0,0.30)";try{this.window.setTitleBarOverlay({color:i,symbolColor:n,height:t})}catch{console.error("Updating WCO failed. Is the titlebar overlay enabled on the window?")}}static isVibrancyAvailable(){return(()=>{if(!je()||l.app.commandLine.hasSwitch("disable-gpu"))return!1;const n=Ta.release().match(/\d+\.\d+\.(\d+)/)?.[1];if(!n)return!1;try{return parseInt(n,10)>=22621}catch{return!1}})()||!1}get isDestroyed(){return this.window.isDestroyed()}get isFocused(){return this.window.isFocused()}get isVisible(){return this.window.isVisible()}get browserWindow(){return this.window}}class Ve extends Z{centeringDeferred=!1;constructor(t){super({...t,browserWindowOptions:{alwaysOnTop:!0,frame:!1,resizable:!1,show:!1,skipTaskbar:!0,title:"",titleBarStyle:void 0,type:void 0,webPreferences:{enablePreferredSizeMode:!0},...t.browserWindowOptions}}),this.window.setAlwaysOnTop(!0,"pop-up-menu"),this.window.center(),l.screen.on("display-metrics-changed",(i,n,r)=>{this.window.isDestroyed()||r.length===1&&r[0]==="workArea"||this.deferOrCenterIfVisible()}),l.screen.on("display-removed",(i,n)=>{this.deferOrCenterIfVisible()})}showIfNotVisible(){this.isVisible||this.show()}show(){const t=this.displayNearestToCursor,i=l.screen.getDisplayMatching(this.window.getBounds());(t.id!==i.id||this.centeringDeferred)&&(this.centeringDeferred=!1,q.moveWindowToScreen(this.window,t.workArea),this.window.center()),super.show()}close(){this.isDestroyed||this.window.close()}updateZoomFactor(){}deferOrCenterIfVisible(){this.window.isDestroyed()||(this.window.isVisible()?this.window.center():this.centeringDeferred=!0)}}class X extends Ve{static MAX_WIDTH=550;static MIN_HEIGHT=108;static MAX_HEIGHT=432;maxHeight;timeout;constructor(t){super({...t,vibrant:!1,browserWindowOptions:{vibrancy:void 0,backgroundMaterial:void 0,titleBarStyle:"hidden",maxHeight:X.MAX_HEIGHT,minHeight:X.MIN_HEIGHT,height:X.MIN_HEIGHT,width:X.MAX_WIDTH}}),this.name="QuickAccessWindow",this.maxHeight=X.MAX_HEIGHT,this.window.webContents.on("preferred-size-changed",(n,r)=>{const a=r.height<=X.MIN_HEIGHT?X.MIN_HEIGHT:r.height;this.window.setBounds({width:X.MAX_WIDTH,height:a})}),this.window.on("show",()=>{this.clearTimeout()}),this.window.on("blur",()=>{this.window.isDestroyed()||(this.window.hide(),this.clearTimeout(),this.setTimeout(()=>{this.send("ClearQuickAccess")},Fa))}),this.window.on("closed",()=>{this.clearTimeout()}),this.window.on("hide",()=>{this.core.invoke({type:"FrontendEvent",content:{type:"QuickAccessHidden",content:void 0}})})}hide(){this.window.hide()}setTimeout(t,i){this.timeout=setTimeout(t,i)}clearTimeout(){this.timeout&&clearTimeout(this.timeout)}}class ae extends Z{static WINDOW_WIDTH=1024;static WINDOW_HEIGHT=800;static MIN_WIDTH=784;static MIN_HEIGHT=400;#e=!1;constructor(t){super({...t,browserWindowOptions:{...t.browserWindowOptions,title:"1Password",width:ae.WINDOW_WIDTH,height:ae.WINDOW_HEIGHT,minWidth:ae.MIN_WIDTH,minHeight:ae.MIN_HEIGHT,acceptFirstMouse:!0}}),this.name="PrimaryWindow",this.window.on("maximize",()=>{this.window.isDestroyed()||this.send("Maximize")}),this.window.on("unmaximize",()=>{this.window.isDestroyed()||this.send("Unmaximize")}),this.show()}get isFloatingSidebarOverrideActive(){return this.#e}set isFloatingSidebarOverrideActive(t){this.#e=t}}class Va extends Z{characteristics;params;title;constructor(t){super({...t,statePath:t.characteristics.statePath,browserWindowOptions:{...t.characteristics.browserWindow,title:t.params.title,titleBarStyle:"default",acceptFirstMouse:!0}}),this.name="SecondaryWindow",this.title=t.params.title,this.params=t.params,this.characteristics=t.characteristics,t.params.alwaysOnTop!==void 0&&!t.params.alwaysOnTop&&this.window.setAlwaysOnTop(!1),t.params.preventHide&&this.window.on("hide",()=>{this.window.show()}),this.window.setAutoHideMenuBar(!1),this.window.setMenuBarVisibility(!1),this.window.once("ready-to-show",()=>{this.window.isDestroyed()||this.send("SecondaryWindowParams",this.params)}),this.characteristics.hidden||this.show()}get viewType(){return this.params.viewType}get sleepInhibitingId(){return this.params.sleepInhibitingId}get windowId(){return this.params.windowId}updateZoomFactor(){this.characteristics.zoomable&&super.updateZoomFactor()}}class K extends Ve{static MAX_WIDTH=400;static MIN_HEIGHT=100;static MAX_HEIGHT=790;embeddedTouchIdState="uninitialized";embeddedAuthViewManager;isSso;onCompleteCallbacks=[];onCompleteCallbackArgs;constructor(t){super({...t,vibrant:!1,browserWindowOptions:{vibrancy:void 0,backgroundMaterial:void 0,titleBarStyle:"hidden",height:K.MIN_HEIGHT,maxHeight:K.MAX_HEIGHT,minHeight:K.MIN_HEIGHT,width:K.MAX_WIDTH}}),this.embeddedAuthViewManager=t.embeddedAuthViewManager,this.isSso=t.isSso,this.name="AuthPromptWindow",this.window.webContents.on("preferred-size-changed",(n,r)=>{const a=na(r.height+1,K.MIN_HEIGHT,K.MAX_HEIGHT);if(this.window.setBounds({width:K.MAX_WIDTH,height:a}),this.embeddedTouchIdState==="uninitialized"&&this.embeddedAuthViewManager){this.embeddedTouchIdState="active";const c=24,h=32;this.embeddedAuthViewManager.embedAuthView(this.window,K.MAX_WIDTH-c-h,a-c+1).then(w=>{w?this.send("EmbeddedAuthApproved"):this.isDestroyed||this.send("EmbeddedAuthFallback")}).catch(w=>{this.isDestroyed||(this.send("EmbeddedAuthFallback"),this.showIfNotVisible())}),this.core.once("SystemAuthViewEmbedded",()=>this.showIfNotVisible())}else this.showIfNotVisible()}),this.window.on("close",()=>{this.removeEmbeddedAuth()}),this.window.on("closed",()=>{if(!this.onCompleteCallbackArgs){this.runOnCompleteCallbacks({type:"deny"});return}this.runOnCompleteCallbacks(this.onCompleteCallbackArgs)})}close(){super.close()}approve(t){this.onCompleteCallbackArgs={type:"approve",content:t},this.close()}deny(){this.onCompleteCallbackArgs={type:"deny"},this.close()}addOnCompleteCallback(t){this.onCompleteCallbacks.push(t)}setAlwaysOnTop(t){this.window.setAlwaysOnTop(t)}removeEmbeddedAuth(){}runOnCompleteCallbacks(t){for(let i=this.onCompleteCallbacks.length-1;i>=0;i--)this.onCompleteCallbacks[i](t);this.onCompleteCallbacks=[]}}class ce extends Ve{static MIN_WIDTH=400;static MAX_WIDTH=400;static MIN_HEIGHT=128;static MAX_HEIGHT=920;registerPromptCompleter;signInPromptCompleter;constructor(t){super({...t,vibrant:!1,browserWindowOptions:{vibrancy:void 0,backgroundMaterial:void 0,titleBarStyle:"hidden",minHeight:ce.MIN_HEIGHT,maxHeight:ce.MAX_HEIGHT,height:ce.MIN_HEIGHT,width:ce.MAX_WIDTH}});let n;const r=new Promise(h=>{n=h});this.registerPromptCompleter={resolve:h=>n(h),promise:r};let a;const c=new Promise(h=>{a=h});this.signInPromptCompleter={resolve:h=>a(h),promise:c},this.name="PasskeyPromptWindow",this.window.webContents.on("preferred-size-changed",(h,w)=>{const _=na(w.height+1,K.MIN_HEIGHT,K.MAX_HEIGHT);this.window.setBounds({width:K.MAX_WIDTH,height:_}),this.showIfNotVisible()}),this.window.on("closed",()=>{this.registerPromptCompleter.resolve({type:"cancel"}),this.signInPromptCompleter.resolve({type:"cancel"})}),this.core.log(W.Debug,E`passkey window prompt class created`)}close(){super.close()}setAlwaysOnTop(t){this.window.setAlwaysOnTop(t)}async waitForRegisterSelection(){return this.registerPromptCompleter.promise}async waitForSignInSelection(){return this.signInPromptCompleter.promise}signInPasskeySelection(t){this.signInPromptCompleter.resolve(t),super.close()}registerPasskeySelection(t){this.registerPromptCompleter.resolve(t),super.close()}}const Na=require("crypto"),le=()=>(0,Na.randomBytes)(16).toString("hex"),Ne=780,Be=680,Ba={largeType:{allowsMultipleInstances:!0,zoomable:!1,hidden:!0,browserWindow:{alwaysOnTop:!0,title:"",width:1,height:1,minWidth:100,minHeight:98}},itemDetails:{allowsMultipleInstances:!0,hidden:!0,zoomable:!0,statePath:A.join(l.app.getPath("userData"),"itemDetailsWindowState"),browserWindow:{alwaysOnTop:!0,width:330,height:420,minWidth:330,minHeight:420}},keyboardShortcutsQX:{allowsMultipleInstances:!1,hidden:!1,zoomable:!1,statePath:A.join(l.app.getPath("userData"),"keyboardShortcutsQXWindowState"),browserWindow:{width:400,height:750,minWidth:400,minHeight:500,alwaysOnTop:!0,frame:!1}},settings:{allowsMultipleInstances:!1,hidden:!1,zoomable:!0,statePath:A.join(l.app.getPath("userData"),"settingsWindowState"),browserWindow:{fullscreenable:!1,width:Ne,height:Be,minHeight:Be,minWidth:Ne,maxWidth:Ne,maxHeight:Be,resizable:!1,maximizable:!1,minimizable:!1,alwaysOnTop:!1,frame:!0}},autofillAccessibility:{allowsMultipleInstances:!1,hidden:!1,zoomable:!1,browserWindow:{fullscreenable:!1,width:462,height:500,resizable:!1,maximizable:!1,minimizable:!1,alwaysOnTop:!1,frame:!0}},largeQrCode:{allowsMultipleInstances:!0,hidden:!1,zoomable:!1,statePath:A.join(l.app.getPath("userData"),"largeQrCodeWindowState"),browserWindow:{alwaysOnTop:!1,width:330,height:390,minWidth:330,minHeight:390,maxWidth:330,maxHeight:390,resizable:!1,fullscreenable:!1}}};class Ke{constructor(t,i,n,r){this.core=t,this.settings=i,this.browserSession=n,this.state=r,this.session=this.browserSession,this.core.on("LockStateChanged",a=>{switch(this.sendToAllWindows("LockStateChanged",a),a){case N.Locked:this.#e&&(this.primaryWindow?.reload(!0),this.primaryWindow?.isVisible||this.primaryWindow?.close(),this.session.clearCache());const[c]=this.getAllWindows();c?.closeFilePreview(),this.closeSecondaryWindows(),this.quickAccessWindow?.close(),this.#t?.close(),this.#i?.close();break;case N.Unlocked:this.quickAccessWindow||this.createQuickAccessWindow();break;default:z(a)}}),this.core.on("ShowWindowTitle",a=>{this.primaryWindow?.setTitle(a)}),this.core.on("RequestSsoMigrationFlow",a=>{a.type==="initialize"&&this.core.invoke({type:"MigrateToSso",content:a}).then(c=>{this.showModal("migrationToSso",{view:c})})}),this.core.preventNotificationAutoForward("ShowToastNotification"),this.core.on("ShowToastNotification",a=>{switch(a.behavior){case oe.Persistent:case oe.ImportantEphemeral:this.sendEventWhenPrimaryWindowReady("ShowToastNotification",a);break;case oe.Ephemeral:this.getFocusedWindow()?.send("ShowToastNotification",a);break;default:z(a.behavior)}}),this.core.preventNotificationAutoForward("ShowAlert"),this.core.on("ShowAlert",a=>{this.sendEventWhenPrimaryWindowReady("ShowAlert",a),this.showPrimaryWindow()}),this.core.on("ShowExportStatus",a=>{this.showModal("exportStatus",{exportStatusData:a})}),this.core.on("ProxyAuthenticationRequired",a=>{this.showModal("proxyAuthentication",{request:a})}),this.core.on("ShowSignIn",a=>{this.closeModal("inAppPurchase"),this.showModal("signIn",{params:a})}),this.core.on("MustReauthenticate",async a=>{const c=a.context.type==="passwordAndSecretKey"?a.context.content.lastKnownValidSecretKey:void 0;this.showModal("signIn",{reauthData:{...a,secretKey:c}})}),this.core.on("RequestSsoEnrollmentViewModel",a=>{switch(a.type){case"allowDevicePrompt":case"updateAppPrompt":case"enrollmentCodeDisplayModal":this.core.invoke({type:"SsoEnrollmentViewModel",content:a}).then(c=>{switch(c.type){case"promptViewModel":this.showModal("ssoAllowNewDevice",{initialViewModel:c.content});break;case"dismissed":this.closeModal("ssoAllowNewDevice");break}});break;case"updateApp":this.core.invoke({type:"CheckForOnlineUpdate",content:{force:!0,user_initiated:!0}});break;case"dismiss":this.closeModal("ssoAllowNewDevice");break}}),this.core.on("ShowUnlockAccount",a=>{this.showModal("unlockAccount",{collectionUuid:a})}),this.core.on("ShowSettingsScreen",a=>{this.showSettings(a)}),this.core.on("ShowPrimaryWindow",()=>{this.showPrimaryWindow()}),this.core.on("PreviewFile",a=>{}),this.core.on("ShowMoveItemConfirmation",a=>{this.showModal("moveItemConfirm",{response:a})}),this.core.on("ShuttingDown",()=>{this.#e?.update(E`Attempted to update the window state after it was destroyed. Caused by core ShuttingDown event.`)}),this.core.on("ShowNativeNotification",({title:a,message:c})=>{const h={title:a,body:c};this.nativeNotification=new l.Notification(h),this.nativeNotification.on("click",w=>{this.showPrimaryWindow()}),this.nativeNotification.show()}),this.core.on("TogglePrimaryWindow",()=>this.togglePrimaryWindow()),this.core.on("ToggleQuickAccess",()=>this.toggleQuickAccess()),this.core.on("AutoFillTriggered",()=>this.handleAutoFillShortcut()),this.core.on("ShowCreateItem",({context:a})=>{this.showModal("itemCatalog",{initialEditItemContext:a})}),this.core.on("NavigateToDestination",a=>{let c;switch(a.type){case"collection":{c={type:"ItemList",content:{type:"ItemList",content:{unlockedRoute:{collectionUuid:a.content},properties:{itemListType:{type:"AllItems"}}}}};break}case"viewItem":{c={type:"ItemDetail",content:{itemId:re(a.content.itemSpecifier.itemUuidComponents),itemListRoute:{type:"ItemList",content:{unlockedRoute:{collectionUuid:a.content.collectionUuid},properties:{itemListType:{type:"AllItems"}}}}}};break}case"editItem":{c={type:"EditItem",content:{itemId:re(a.content.itemSpecifier.itemUuidComponents),itemListRoute:{type:"ItemList",content:{unlockedRoute:{collectionUuid:a.content.collectionUuid},properties:{itemListType:{type:"AllItems"}}}}}};break}case"watchtowerDeveloper":{c={type:"WatchtowerDeveloper",content:{unlockedRoute:{collectionUuid:"everything"}}};break}default:z(a)}this.openRoute(c)}),this.core.on("ShowAutofillAccessibility",({windowTitle:a})=>{this.showAutofillAccessibility(a)}),this.core.on("AuthPromptTimeout",a=>{this.closeAuthPrompt()}),this.core.on("DuoMfaTimeout",a=>{this.core.log(W.Warn,E`Duo MFA timeout expired.`),this.primaryWindow?.send("DuoMfaTimeout",a)}),this.settings.on("change",()=>{this.updateZoomFactor(),this.configure()}),l.systemPreferences.on("accent-color-changed",()=>{this.configure()})}#e;secondaryWindows=[];quickAccessWindow;#t;#i;getFocusedWindow=()=>this.getAllWindows().find(t=>t.isFocused);#n=[];#s=new Re.EventEmitter;#o=!1;#r=!1;session;nativeNotification;submitDuoResponse;setPrimaryWindowFloatingSidebarOverride(t){this.primaryWindow&&(this.primaryWindow.isFloatingSidebarOverrideActive=t)}silentUnlock=async t=>{if(this.core.lockState===N.Unlocked)return;const i=await this.core.invoke({type:"SilentUnlock",content:{reason:t}});switch(i){case Le.Accepted:return;case Le.Denied:throw new Error("Silent unlock denied");default:z(i)}};get primaryWindow(){if(!this.#e?.isDestroyed)return this.#e}get authPromptWindow(){if(!this.#t?.isDestroyed)return this.#t}get passkeyPromptWindow(){if(!this.#i?.isDestroyed)return this.#i;this.core.log(W.Info,E`could not get passkey prompt - previously destroyed`)}backgroundColor=()=>l.nativeTheme.shouldUseDarkColors?"#333":"#f7f7f7";async getFrontEndConfig(){const t=await this.core.invoke({type:"Config",content:void 0}),i=()=>{if(!(this.settings.get("useSystemAccentColor")&&!0))return;const r={accentColor:void 0,selectedContentBackground:void 0,keyboardFocusIndicator:void 0},a=l.systemPreferences.getAccentColor();return a&&(r.accentColor=a),r};return{isMac:!1,alwaysShowScrollbars:!1,holdToRevealMode:this.settings.get("holdToRevealMode"),useCsd:this.settings.get("useCustomTitleBar"),lockState:t.lockState,onboarding:!t.hasAccount,bestShortDateFormat:t.bestAvailableDateFormat,vibrancy:!1,floatingSidebar:this.settings.get("floatingSidebar"),interfaceDensity:this.settings.get("interfaceDensity"),systemAccentColor:i()}}on=(t,i)=>{this.#s.on(t,i)};goBack=()=>{this.primaryWindow?.send("GoBack")};goForward=()=>{this.primaryWindow?.send("GoForward")};showSearch=(t=!0)=>{this.sendEventWhenPrimaryWindowReady("ShowSearch",t),this.showPrimaryWindow()};showSearchFilter=()=>{this.sendEventWhenPrimaryWindowReady("ShowSearchFilter"),this.showPrimaryWindow()};sendPendingEvent=t=>{for(let i=0;i<this.#n.length;i++){const n=this.#n[i];if(n.channel===t){n.send(),this.#n.splice(i,1);return}}};sendEventWhenPrimaryWindowReady(t,...i){const n=i[0],r=()=>this.primaryWindow?.send(t,n);this.#n.push({channel:t,send:r}),this.primaryWindow?.send("SendPendingEvent",t)}showModal(t,...[i]){this.sendEventWhenPrimaryWindowReady("ShowModal",{id:t,props:i}),this.showPrimaryWindow()}closeModal(t){this.primaryWindow?.send("CloseModal",t)}showLargeType(t){const n=this.settings.get("blockSleepEnabled")?l.powerSaveBlocker.start("prevent-display-sleep"):void 0;this.createSecondaryWindow({viewType:B.LargeType,largeTypeValue:t.styledText,title:t.title,windowId:le(),sleepInhibitingId:n})}showKeyboardShortcutsQX(){this.createSecondaryWindow({viewType:B.KeyboardShortcutsQX,windowId:le()})}showLargeQrCodeWindow(t,i){this.createSecondaryWindow({viewType:B.LargeQrCode,windowId:le(),itemId:t,title:i})}showSettings(t){const i=this.secondaryWindows.find(n=>n.viewType==="settings");i?(i.send("OpenSettings",t),setTimeout(()=>{i.show()},0)):this.createSecondaryWindow({viewType:B.Settings,title:Y({type:"SettingsWindowTitle"}),category:t,windowId:le(),forceActivationPolicy:"regular"})}showAutofillAccessibility(t){this.createSecondaryWindow({viewType:B.AutofillAccessibility,windowId:le(),title:t,preventHide:!0})}showItemDetailsInNewWindow(t){const i=this.settings.get("itemDetailWindowsOnTop");this.createSecondaryWindow({viewType:B.ItemDetails,itemDetailRoute:t,title:this.primaryWindow?.getTitle(),holdToRevealMode:this.settings.get("holdToRevealMode"),windowId:le(),alwaysOnTop:i})}createNewItem(){this.sendEventWhenPrimaryWindowReady("CreateNewItem"),this.showPrimaryWindow()}openRoute(t){this.sendEventWhenPrimaryWindowReady("OpenRoute",t),this.showPrimaryWindow()}promptMyceliumConfirmationCode=t=>(this.sendEventWhenPrimaryWindowReady("PromptMycelium",t),this.showPrimaryWindow(),new Promise((i,n)=>{l.ipcMain.handleOnce("sendMyceliumConfirmationCode",(r,a)=>{a!==void 0?i(a):n()})}));promptMfa=t=>(this.sendEventWhenPrimaryWindowReady("PromptMfa",t),this.showPrimaryWindow(),new Promise((i,n)=>{const r=()=>{n(),l.ipcMain.removeHandler("sendMfaSubmission"),this.core.removeAllListeners("CloseMfa"),this.core.addListener("CloseMfa",()=>{}),this.sendToAllWindows("CloseMfa")};l.ipcMain.handleOnce("sendMfaSubmission",(a,c)=>{c===void 0?n():i(c)}),this.core.addListener("CloseMfa",r),this.primaryWindow?.on("close",r),this.submitDuoResponse=a=>{this.core.log(W.Info,E`Duo MFA: received auth code from Duo; sending to Core`),i(a),l.ipcMain.removeHandler("sendMfaSubmission"),this.submitDuoResponse=void 0}}));promptManualOverride(t){if(!t.alwaysAllow)return;const i=t.allowOnce.action;if(!i)return;const n=t.alwaysAllow.action;n&&this.quickAccessWindow&&l.dialog.showMessageBox(this.quickAccessWindow.browserWindow,{message:t.message??"",type:"warning",buttons:[t.allowOnce.label,t.alwaysAllow.label,t.cancel.label],defaultId:0}).then(({response:a})=>{const c=this.quickAccessWindow;if(c)switch(this.hide(c.browserWindow.webContents,!0),a){case 0:this.core.invoke({type:"DesktopConfirmFill",content:i});break;case 1:this.core.invoke({type:"DesktopConfirmFill",content:n});break;default:}})}promptAuth=(t,i)=>{const n="type"in t.approvalMethod&&t.approvalMethod.type==="embeddedSystemAuth";return this.createAuthPromptWindow(t,n?i:void 0)};promptPasskey=t=>this.createPasskeyPromptWindow(t);showAuthPrompt=()=>this.#t?.show();showPasskeyPrompt=()=>this.#i?.show();focusAuthPrompt=()=>this.#t?.focus();focusPasskeyPrompt=()=>this.#i?.focus();closeAuthPrompt=()=>this.#t?.close();closePasskeyPrompt=()=>this.#i?.close();registerPasskeySelection=t=>this.#i?.registerPasskeySelection(t);signInPasskeySelection=t=>this.#i?.signInPasskeySelection(t);setAuthPromptAlwaysOnTop=t=>this.#t?.setAlwaysOnTop(t);removeEmbeddedAuthFromAuthPrompt=()=>this.#t?.removeEmbeddedAuth();showMessageBox=t=>new Promise(n=>{const r=t.cancelId,a=t.defaultId,c=t.detail,h={type:t.msgBoxType,title:t.title,message:t.message,buttons:t.buttons,cancelId:r,defaultId:a},w=this.primaryWindow;c&&(h.detail=c),this.primaryWindow?.show(),(w?l.dialog.showMessageBox(w.browserWindow,h):l.dialog.showMessageBox(h)).then(_=>{const U=_.response;return n(U)}).catch(()=>n(r))});maximize(t){const i=this.getBrowserWindow(t);!i||!i.isMaximizable()||(i.isMaximized()?i.unmaximize():i.maximize())}minimize(t){const i=this.getBrowserWindow(t);i&&i.isMinimizable()&&!i.isMinimized()&&i.minimize()}close(t){this.getBrowserWindow(t)?.close()}async fade(t,i="out",n=250,r=!1,a=!1){const c=sa.performance.now(),h=c+n,w=60;return new Promise(_=>{const I=setInterval(()=>{const M=this.getBrowserWindow(t);if(!M){clearInterval(I);return}const H=sa.performance.now();if(H>h)return clearInterval(I),i==="out"?(M.setOpacity(0),r?(M.hide(),a&&this.core.restoreActiveApp(ve.QuickAccess)):M.setIgnoreMouseEvents(!0)):(M.setIgnoreMouseEvents(!1),M.setOpacity(1)),_();const S=(H-c)/(h-c);M.setOpacity(i==="out"?1-S:S)},1/w*1e3)})}hide(t,i=!1){const n=this.getBrowserWindow(t);n&&(n.blur(),n.hide()),i&&this.core.restoreActiveApp(ve.QuickAccess)}setAccessoryMode(){}setRegularMode(){}setTitle(t,i){this.getBrowserWindow(t)?.setTitle(i)}closeAll(){const t=this.getAllWindows();for(const i of t)t.indexOf(i)===0&&i?.closeFilePreview(),i.close()}setSettingsWindowTitle(t){for(const i of this.secondaryWindows)if(i.viewType==="settings"){i.setTitle(t);break}}showMenu(t,i){const n=this.getBrowserWindow(t);n&&l.Menu.getApplicationMenu()?.popup({window:n,...i})}async showOpenDialog(){return this.showOpenDialogWithOptions({properties:["openFile"]})}async showOpenDialogWithOptions(t){if(!this.primaryWindow)return;let i;return i=await l.dialog.showOpenDialog(this.primaryWindow.browserWindow,t),i.filePaths.length?i.filePaths[0]:void 0}getOpWindow(t){const i=this.getAllWindows().find(n=>n.matchWindow(t));if(i===void 0)throw new Error("Unable to find OpWindow matching BrowserWindow: "+t.title);return i}async showQuickAccess(t){if(this.state.dispatch({type:"SetQXOpenedBy",qxOpenedBy:t}),this.core.lockState===N.Locked)try{if(!(await this.core.invoke({type:"Config",content:void 0})).hasAccount){this.showPrimaryWindow();return}await this.silentUnlock(Oe.QuickAccess)}catch{this.core.log(W.Info,E`Silent Unlock failed or was cancelled while opening Quick Access`);return}this.core.captureActiveApp(ve.QuickAccess),(this.quickAccessWindow??this.createQuickAccessWindow()).show()}getQXWindowSize(){return this.quickAccessWindow?this.quickAccessWindow.windowSize:{width:0,height:0}}async handleAutoFillShortcut(){try{this.core.lockState===N.Locked&&await this.silentUnlock(Oe.Autofill),await this.core.invoke({type:"AutoFillFromShortcut",content:void 0})||this.showQuickAccess(se.AutofillShortcut)}catch{console.error("Silent unlock failed while handling autofill shortcut.")}}toggleQuickAccess(){this.quickAccessWindow?.isFocused?this.quickAccessWindow.hide():this.showQuickAccess(se.QuickAccessShortcut)}showPrimaryWindow(){this.primaryWindow?(this.primaryWindow.show(),this.autoPromptSystemAuthIfNeeded()):this.createPrimaryWindow()}togglePrimaryWindow(){this.primaryWindow?.isFocused?this.primaryWindow?.close():this.showPrimaryWindow()}configure(){this.sendToAllWindows("Configure")}changeQxCollection(t){this.sendToAllWindows("ChangeQxCollection",t)}get focusedWindow(){return this.primaryWindow?.isFocused?B.Primary:this.quickAccessWindow?.isFocused?B.QuickAccess:this.#t?.isFocused?B.AuthPrompt:this.#i?.isFocused?B.PasskeyPrompt:this.secondaryWindows.find(t=>t.isFocused)?.viewType??B.None}getWindowContext(){return{focusedWindow:this.focusedWindow,focusedWindowHasOpenModal:!!this.getFocusedWindow()?.getModalStatus(),primaryWindowVisible:!!this.primaryWindow?.isVisible,sidebarHiddenByFrontEnd:this.primaryWindow?.isFloatingSidebarOverrideActive??!1,selectedItemIds:this.getFocusedWindow()?.getSelectedItemIds()??[]}}setSecureInput(t,i){const n=l.BrowserWindow.fromWebContents(t);if(!n)return;this.getOpWindow(n).setSecureInput(i)}static disableSecureInputGlobal(){Z.setSecureInputGlobal(!1)}hasActiveWindows(){return this.getAllWindows().some(t=>!this.quickAccessWindow?.matchWindow(t.browserWindow)||t.isVisible)}getAllWindows(){const t=[...this.secondaryWindows];return this.#e&&t.push(this.#e),this.quickAccessWindow&&t.push(this.quickAccessWindow),this.#t&&t.push(this.#t),this.#i&&t.push(this.#i),t}onWindowDisused=()=>{this.hasActiveWindows()};getBrowserWindow(t){if(t.isDestroyed())return null;const i=l.BrowserWindow.fromWebContents(t);if(!i)throw new Error("No window for webContents");return i.isDestroyed()?null:i}createPrimaryWindow(){if(this.#e)return this.#e;const t=this.settings.get("useCustomTitleBar"),i=!1,n=new ae({core:this.core,settings:this.settings,rootFile:A.join(__dirname,"primary.html"),session:this.session,statePath:A.join(l.app.getPath("userData"),"primaryWindowState"),browserWindowOptions:{vibrancy:i?"sidebar":void 0,frame:!t,autoHideMenuBar:!0,show:!1,titleBarStyle:t?"hidden":"default",titleBarOverlay:t},vibrant:i,titlebarOverlayEnabled:t});return n.on("restore",()=>{this.autoPromptSystemAuthIfNeeded()}),n.on("closed",()=>{this.#e=void 0,this.#s.emit("primary-window-closed"),this.onWindowDisused()}),n.once("show",()=>{this.autoPromptSystemAuthIfNeeded(),this.#s.emit("primary-window-created"),this.primaryWindow?.updateZoomFactor()}),this.#e=n,this.#e}createSecondaryWindow(t){const i=Ba[t.viewType];if(!i.allowsMultipleInstances){const a=this.secondaryWindows.find(c=>c.viewType===t.viewType);if(a)return a.focus(),a}const n=new Va({core:this.core,settings:this.settings,rootFile:A.join(__dirname,"secondary.html"),session:this.session,params:t,characteristics:i});this.secondaryWindows.push(n),n.on("closed",()=>{const a=this.secondaryWindows.indexOf(n),c=this.secondaryWindows[a];c.sleepInhibitingId!=null&&l.powerSaveBlocker.stop(c.sleepInhibitingId),delete this.secondaryWindows[a],this.secondaryWindows.splice(a,1),this.onWindowDisused()});const r=this.secondaryWindows.filter(a=>a!==n&&a.viewType===t.viewType);if(r.length){const[a,c]=r[r.length-1].getPosition();n.setPosition(a+25,c+25)}return n}createQuickAccessWindow(){if(this.quickAccessWindow)return this.quickAccessWindow;const t=new X({core:this.core,settings:this.settings,rootFile:A.join(__dirname,"quickAccess.html"),session:this.session});return t.on("closed",()=>{this.quickAccessWindow&&(this.quickAccessWindow=void 0)}),t.on("hide",()=>{this.onWindowDisused(),this.core.quickAccessHidden()}),t.whenDestroyed(()=>this.quickAccessWindow=void 0),this.quickAccessWindow=t,this.quickAccessWindow}createPasskeyPromptWindow(t){if(this.#i){this.core.log(W.Debug,E`passkey prompt exists - skipping creation`);return}const i=new ce({core:this.core,rootFile:A.join(__dirname,"passkeyPrompt.html"),session:this.session,settings:this.settings});return i.once("ready-to-show",()=>{if(i.isDestroyed){this.core.log(W.Debug,E`passkey prompt was destroyed as soon as it was ready to be shown - abort sending viewModel`);return}i.send("InitialPasskeyPromptData",t)}),i.on("closed",()=>{if(!this.#i){this.core.log(W.Error,E`state error: received passkey close event for an orphaned passkey window`);return}this.core.log(W.Debug,E`closing passkey prompt`),this.#i=void 0,this.onWindowDisused()}),i.show(),this.#i=i,this.#i}createAuthPromptWindow(t,i){if(!this.#t){const n="sso"in t.approvalMethod||"type"in t.approvalMethod&&t.approvalMethod.type==="sso",r=new K({core:this.core,rootFile:A.join(__dirname,"authPrompt.html"),session:this.session,settings:this.settings,embeddedAuthViewManager:i,isSso:n});r.once("ready-to-show",()=>{r.isDestroyed||r.send("InitialAuthPromptData",{viewModel:t})}),r.on("closed",()=>{this.#t&&(this.#t=void 0,this.onWindowDisused())}),this.#t=r}return this.#t}closeSecondaryWindows(){this.secondaryWindows.filter(t=>!t.characteristics.remainsOpenOnLock).forEach(t=>t.close())}autoPromptSystemAuthIfNeeded=async()=>{const t=!this.#r;this.#r=!1,this.core.lockState===N.Locked&&this.settings.get("authenticatedUnlockAutomatic")&&t&&this.sendEventWhenPrimaryWindowReady("AutoPromptSystemAuth")};sendToAllWindows(t,...i){const n=i[0];for(const r of this.getAllWindows())r.send(t,n)}displayNearestToCursor(){return l.screen.getDisplayNearestPoint(l.screen.getCursorScreenPoint())}updateZoomFactor(){for(const t of this.getAllWindows())t.updateZoomFactor()}}class Ka{constructor(t,i,n){this.core=t,this.windowManager=i,this.userSettings=n,this.userSettings.on("change",()=>{this.userSettings.get("keepInTray")?this.tray||this.init():this.destroy()})}tray;contextMenu;hasPrompt=!1;#e=new Re.EventEmitter;#t=N.Locked;init(){this.tray||this.userSettings.get("keepInTray")&&(this.#t=this.core.lockState,this.tray=new l.Tray(this.getTrayImagePath(this.#t)),this.tray.setIgnoreDoubleClickEvents(!0),this.core.on("LockStateChanged",this.onLockStateChange),this.core.on("BackgroundPrompt",this.onBackgroundPromptChange),this.core.on("AuthPromptTimeout",this.onAuthPromptTimeout),this.userSettings.on("change",this.onSettingsChange),this.core.on("ShuttingDown",this.destroy),this.reload())}reload=()=>{this.tray&&(this.setupTrayIcon(),this.setupMenu())};onClick=t=>{if(t.ctrlKey||this.hasPrompt)return this.onRightClick();const i=this.userSettings.get("trayAction");switch(i){case ne.QuickAccess:this.windowManager.toggleQuickAccess();break;case ne.MainWindow:this.windowManager.togglePrimaryWindow();break;case ne.Menu:this.onRightClick();break;default:z(i)}};onRightClick=()=>{this.tray?.popUpContextMenu(this.contextMenu)};onLockStateChange=t=>{this.#t=t,this.reload()};onBackgroundPromptChange=()=>{this.hasPrompt=!0,this.reload()};onAuthPromptTimeout=t=>{t===Fe.Ssh&&(this.clearBackgroundPromptNotifications(),this.reload())};onSettingsChange=()=>{this.reload()};setupTrayIcon=()=>{this.tray&&(this.tray.setImage(this.getTrayImagePath(this.#t)),this.tray.setToolTip("1Password"),this.tray.off("click",this.onClick),this.tray.on("click",this.onClick),this.tray.off("right-click",this.onRightClick),this.tray.on("right-click",this.onRightClick))};setupMenu=()=>{if(!this.tray)return;const t=[];if(this.hasPrompt&&t.push({label:Y({type:"SshRequestWaiting"}),click:this.showBackgroundSshPrompt}),t.push({label:Y({type:"Open1Password"}),accelerator:this.userSettings.get("keybindingOpen")||void 0,click:()=>{this.windowManager.showPrimaryWindow()}},{label:Y({type:"OpenQuickAccess"}),accelerator:this.userSettings.get("keybindingQuickAccess")||void 0,click:()=>{this.windowManager.showQuickAccess(se.QuickAccessShortcut)}}),this.userSettings.get("snippetsEnabled")){const i=this.userSettings.get("snippetsShortcutMonitoringEnabled")?"DisableSnippetsTray":"EnableSnippetsTray";t.push({label:Y({type:i}),accelerator:void 0,click:()=>{this.core.invoke({type:"SnippetsShortcutMonitoringEnabled",content:!this.userSettings.get("snippetsShortcutMonitoringEnabled")})}})}t.push({type:"separator"}),t.push({label:Y({type:"Lock"}),accelerator:this.userSettings.get("keybindingLock")||void 0,click:()=>{this.core.invoke({type:"Lock",content:void 0})},enabled:this.#t!==N.Locked}),t.push({label:Y({type:"SettingsWindowTitle"}),click:()=>{this.windowManager.showSettings()}}),t.push({label:Y({type:"Quit"}),click:()=>{this.#e.emit("quit")}}),this.contextMenu=l.Menu.buildFromTemplate(t),this.userSettings.get("trayAction")===ne.Menu?this.tray.setContextMenu(this.contextMenu):this.tray.setContextMenu(null)};getTrayImagePath=t=>this.hasPrompt?A.join(__dirname,"images/application_icons/windows_notification_area/notification_area_prompt.ico"):A.join(__dirname,`images/application_icons/windows_notification_area/notification_area_${t===N.Locked?"locked":"unlocked"}.ico`);showBackgroundSshPrompt=()=>{this.core.invoke({type:"ShowBackgroundPrompt",content:void 0}),this.clearBackgroundPromptNotifications(),this.reload()};clearBackgroundPromptNotifications=()=>{this.hasPrompt=!1};on(t,i){this.#e.on(t,i)}off(t,i){this.#e.off(t,i)}destroy(){this.tray?.off("click",this.onClick),this.core.off("LockStateChanged",this.onLockStateChange),this.core.off("BackgroundPrompt",this.onBackgroundPromptChange),this.core.off("AuthPromptTimeout",this.onAuthPromptTimeout),this.userSettings.off("change",this.onSettingsChange),this.core.off("ShuttingDown",this.destroy),this.tray?.destroy(),this.tray=void 0}}class za{#e=new Re.EventEmitter;#t=[];#i=new Set;#n=[];#s=N.Locked;#o;executeGql=Sa;constructor(t){try{xe(t,(i,n)=>{this.#n?this.#n.push([i,n]):this.dispatchPrompt(i,n)},i=>{const n=JSON.parse(i);this.#t?this.#t.push(n):this.dispatchNotification(n)})}catch(i){l.dialog.showMessageBox({type:"error",message:i instanceof Error?i.message:""}).then(()=>l.app.quit())}this.on("LockStateChanged",i=>{this.#s=i})}get lockState(){return this.#s}dispatchNotification(t){this.#i.has(t.type)||this.#o?.sendToAllWindows(t.type,t.content),this.#e.emit(t.type,t.content)}preventNotificationAutoForward(t){this.#i.add(t)}async dispatchPrompt(t,i){switch(i.type){case"MessageBox":{const S=T=>{C(t,{type:"MessageBox",content:{buttonId:T}})},P=()=>{C(t,{type:"MessageBox",content:{buttonId:i.content.cancelId}})};this.windowManager.showMessageBox(i.content).then(S).catch(P);break}case"DesktopMfaRequest":{const S=T=>{C(t,{type:"Mfa",content:T})},P=()=>{C(t,{type:"Mfa",content:{type:"Cancel",content:void 0}})};this.windowManager.promptMfa(i.content).then(S).catch(P);break}case"WindowStateCheck":{C(t,{type:"WindowStateCheck",content:{windowsOpen:this.windowManager.hasActiveWindows()}});break}case"SelectMfaType":const n=i.content.selectors.filter(S=>S.response.type!=="Webauthn");C(t,{type:"SelectMfaType",content:n[0]?.response??{type:"Totp",content:6}});break;case"ConfirmMyceliumNewDeviceWithCode":const r=S=>{C(t,{type:"ConfirmMyceliumNewDeviceWithCode",content:{userResponse:{type:"allow",content:S},longTermPairing:!1}})},a=()=>{C(t,{type:"ConfirmMyceliumNewDeviceWithCode",content:{userResponse:{type:"dismiss"},longTermPairing:!1}})};this.windowManager.promptMyceliumConfirmationCode(i).then(r).catch(a);break;case"ConfirmMyceliumNewDevice":break;case"AuthPrompt":case"UnlockPrompt":const c=i.type==="UnlockPrompt",h=()=>{C(t,{type:c?"UnlockPromptResponse":"AuthPrompt",content:{type:"denied"}})};if(this.windowManager.authPromptWindow){h();break}const w=S=>{C(t,{type:c?"UnlockPromptResponse":"AuthPrompt",content:{type:"approved",content:S}})};this.windowManager.promptAuth(i.content,{embedAuthView:this.embeddedAuthenticationUnlock,removeAuthView:this.removeEmbeddedAuthSubview}).addOnCompleteCallback(S=>{switch(S.type){case"approve":w(S.content);break;case"deny":h();break}});break;case"SigninPasskey":const U=this.windowManager.promptPasskey({type:"signin",content:i.content});if(!U){this.log(W.Error,E`could not create passkey prompt`),C(t,{type:"SigninPasskey",content:{type:"cancel"}});return}const I=await U.waitForSignInSelection();C(t,{type:"SigninPasskey",content:I});break;case"ShowCreateItem":this.windowManager.showModal("itemCatalog",{initialEditItemContext:i.content.context,notifyFinish:!0}),l.ipcMain.handleOnce("notifyCreateItemFinish",(S,P)=>{C(t,{type:"ShowCreateItem",content:P?De.ItemCreated:De.Cancelled})});break;case"RegisterPasskey":const M=this.windowManager.promptPasskey({type:"register",content:i.content});if(!M){this.log(W.Error,E`could not create passkey prompt`),C(t,{type:"RegisterPasskey",content:{type:"cancel"}});return}const H=await M.waitForRegisterSelection();C(t,{type:"RegisterPasskey",content:H});break}}clientReady(t){if(this.#o=t,this.#t){const i=this.#t;this.#t=null;for(const n of i)this.dispatchNotification(n)}if(this.#n){const i=this.#n;this.#n=null;for(const[n,r]of i)this.dispatchPrompt(n,r)}}async invoke(t){const i=await ee(t);return i.type!==t.type&&i.type!=="Nothing"&&this.log(W.Error,ye(`Response is of wrong type ("${i.type}" expecting "${t.type}"), the app may misbehave.`)),i.content}on(t,i){this.#e.on(t,i)}off(t,i){this.#e.off(t,i)}once(t,i){this.#e.once(t,i)}addListener(t,i){this.#e.addListener(t,i)}removeAllListeners(t){this.#e.removeAllListeners(t)}async getLockScreen(t){return(await Pe(t)).content}async scanQrCode(t,i,n){return(await _a({imageBytes:t,imageSource:i,scheme:n})).content}unlockWithSystem(t){return this.invoke({type:"SystemUnlock",content:t})}async getSettings(){return this.invoke({type:"ClientSettings",content:void 0})}async generateTotp(t){return this.invoke({type:"Totp",content:{url:t}})}async getLargeTypeData(t){return this.invoke({type:"LargeType",content:t})}async getFormattedLargeTypeData(t){return this.invoke({type:"LargeTypeClientFormatted",content:t})}log(t,i){Me(t)&&ie(t,{type:"freeformLog",content:`${i}`})}profile(t,i){return D(t,i)}async getResource(t){return s(t)}forceWindowActivation(t){{const i=t.getNativeWindowHandle();return o(i)}}embeddedAuthenticationUnlock(t,i,n){return f(t.getNativeWindowHandle(),i,n)}removeEmbeddedAuthSubview(t){return g(t.getNativeWindowHandle())}focusNonActivatingPanel(t){return m(t.getNativeWindowHandle())}webauthnSign(t){return v(t)}setCurrentProcessAumid(){return L()}showOnAutoStart(){return F()}protectProcessMemory(t){return R(t)}captureActiveApp(t){return Ie(JSON.stringify(t))}restoreActiveApp(t){return ga(JSON.stringify(t))}quickAccessHidden(){return fa()}takeSilentFromUserDefaults(){return ma()}takeLaunchedFromB5xFromUserDefaults(){return va()}localize(t){return Y(t)}getLocale(){return ya()}bhReconnect(){return ba()}get windowManager(){if(!this.#o)throw new Error("Attempting to use OpWindowManager instance in OpCore before it is injected");return this.#o}}var qa=(e=>(e[e.Activating=0]="Activating",e[e.AddingAccount=1]="AddingAccount",e[e.AuthenticatingDuo=2]="AuthenticatingDuo",e[e.CreatingItem=3]="CreatingItem",e[e.ImportingSshKey=4]="ImportingSshKey",e[e.EditingItem=5]="EditingItem",e[e.ViewingItem=6]="ViewingItem",e[e.OpeningCredits=7]="OpeningCredits",e[e.OpeningItemLink=8]="OpeningItemLink",e[e.OpeningSettings=9]="OpeningSettings",e[e.SsoContinue=10]="SsoContinue",e[e.UnlockingAccount=11]="UnlockingAccount",e[e.ImportLoginSso=12]="ImportLoginSso",e[e.ReconnectingBrowserHelper=13]="ReconnectingBrowserHelper",e))(qa||{});const ra=e=>({type:"ItemDetail",content:{itemId:re(e.collectionItem.itemSpecifier.itemUuidComponents),itemListRoute:{type:"ItemList",content:{unlockedRoute:{collectionUuid:e.collectionItem.collectionUuid},properties:{itemListType:{type:"AllItems"}}}}}});class Qa{constructor(t,i){this.core=t,this.windowManager=i}async classifyAppUrl(t){return(await this.core.invoke({type:"ClassifyAppUrl",content:{url:t}})).classification}async captureUrlFromArgs({url:t}){if(t)try{return await this.captureUrl(t)}catch{return null}return null}async captureUrlFromClipboard(){const t=l.clipboard.readText();if(!t){await l.dialog.showMessageBox({type:"info",title:"Copy URL from clipboard",message:"Clipboard is empty.",buttons:["OK"]});return}try{await this.captureUrl(t)}catch{const{url:i}=await this.core.invoke({type:"AppUrlFromEmergencyKit",content:{emergencyKitPath:t}});try{await this.captureUrl(i)}catch{await l.dialog.showMessageBox({type:"info",title:"Add Account to 1Password",message:"No valid onepassword:// URL or Emergency Kit path was detected in the clipboard.",buttons:["OK"]})}}}async captureUrlFromOpenDialog(){const t=await this.getUrlFromOpenDialog();if(!t)return!1;try{return await this.captureUrl(t),!0}catch{return await l.dialog.showMessageBox({type:"error",title:"1Password",message:"Your Emergency Kit is corrupt and cannot be opened. Please select another Emergency Kit.",buttons:["OK"]}),!1}}async getUrlFromOpenDialog(){const t=await this.windowManager.showOpenDialogWithOptions({title:"Choose Emergency Kit",defaultPath:l.app.getPath("downloads"),filters:[{name:"Emergency Kits",extensions:["pdf"]},{name:"All Files",extensions:["*"]}],properties:["openFile"],message:"Select your 1Password Emergency Kit"});if(!t)return null;try{const{url:i}=await this.core.invoke({type:"AppUrlFromEmergencyKit",content:{emergencyKitPath:t}});return i}catch{return""}}captureSignInComponents(t){this.windowManager.showModal("signIn",{params:{components:t,forceShowFields:!1,closeSigninWindows:!1}})}captureTrustedDeviceSignInResponse(t,i=!1){switch(t.type){case"showDeviceCodeInputFor2ndPlusTrustedDevice":t.data.type==="viewModel"&&this.windowManager.primaryWindow?.send("ShowDeviceCode",t.data.content),t.data.type==="cancelled"&&this.windowManager.primaryWindow?.send("DismissSsoEnrollmentCodeModal",void 0);break;case"signInSuccessful":if(t.data.type==="finished")switch(t.data.data.type){case"lockScreen":this.windowManager.primaryWindow?.send("UnlockWithSso",t.data.data.content.accounts);break;case"unlock":this.windowManager.primaryWindow?.send("UnlockWithSso",void 0);break;case"authPrompt":const n=t.data.data.content.accounts;n&&this.windowManager.primaryWindow?.send("UnlockWithSso",n),this.windowManager.authPromptWindow?.send("AuthPromptSsoAuthSucceded");break;case"reauthenticationPrompt":this.windowManager.primaryWindow?.send("UnlockWithSso",void 0);break}else t.data.type==="migration"&&this.core.invoke({type:"MigrateToSsoSuccess"});break;case"error":i&&this.windowManager.primaryWindow?.send("SsoUnlockFailure",t.data);break;default:z(t)}}async captureUrl(t){let i;try{const n=new URL(t).toString();i=await this.classifyAppUrl(n)}catch{throw new Error("Not a valid URL")}switch(i?.type){case"B5SignIn":return this.captureSignInComponents(i.content),1;case"B5SsoSignIn":const n=await this.core.invoke({type:"SsoSignInValidation",content:i.content});return n?this.windowManager.showModal("migrationToSso",{view:n}):this.captureSignInComponents(i.content),1;case"SsoRedirect":return i.content.type==="Granted"?await this.core.invoke({type:"SsoFinalize",content:{oauthAuthorized:{state:i.content.content.state,code:i.content.content.code}}}).then(a=>this.captureTrustedDeviceSignInResponse(a,!0)):await this.core.invoke({type:"SsoUnlockFailure",content:i.content.content}).then(a=>this.windowManager.primaryWindow?.send("SsoUnlockFailure",a)),this.windowManager.authPromptWindow||this.windowManager.primaryWindow?.focus(),10;case"B5ItemLink":return await this.openB5ItemRoute(i.content),8;case"Activate":return 0;case"BHReconnect":return this.core.bhReconnect(),13;case"DuoMfa":return this.windowManager.submitDuoResponse?.({type:"Duo",content:{response_url:i.content}}),2;case"UnlockAccount":return this.windowManager.showModal("unlockAccount",{collectionUuid:i.content}),11;case"OpenSettings":return this.windowManager.showSettings(i.content),9;case"EditItem":return await this.openItemRoute(i.content),5;case"ViewItem":return await this.openItemRoute(i.content),6;case"CreateItem":return await this.showCreateItem(i.content),3;case"ImportSshKey":return await this.showImportSshKeyItem(i.content),4;case"OpenCredits":const r=A.join(A.resolve(__dirname,"../app.asar.unpacked/"),"CREDITS.html");return l.shell.openPath(r),7;case"ImportLoginSso":return this.windowManager.primaryWindow?.send("ImportLoginSso",i.content),12;default:throw new Error("Unknown url type")}}async openB5ItemRoute(t){t&&this.core.invoke({type:"ItemRoute",content:{type:"b5ItemLinkComponents",content:{components:t}}}).then(i=>{switch(i.type){case"success":this.windowManager.openRoute(ra(i.content));break;case"failure":l.dialog.showMessageBox({type:"info",title:"Add Account to 1Password",message:i.content,buttons:["OK"]});break;default:z(i)}})}async openItemRoute(t){if(t){const i=await this.core.invoke({type:"ItemRoute",content:{type:"itemRouteComponents",content:{components:t}}});switch(i.type){case"success":this.windowManager.openRoute(ra(i.content));break;case"failure":break;default:z(i)}}}async showCreateItem(t){const i=await this.core.invoke({type:"CreateItemContext",content:{type:"itemCategory",content:t}});this.windowManager.showModal("itemCatalog",{initialEditItemContext:i.context})}async showImportSshKeyItem(t){await this.core.invoke({type:"ImportSshKey",content:{type:"File",content:t}})}async openUrlInBrowser(t){const i=new URL(t);if(i.protocol!=="https:"&&i.protocol!=="http:"&&i.protocol!=="onepassword:"&&i.protocol!=="onepassword8:"&&i.protocol!=="mailto:"&&i.protocol!=="x-safari-https:")throw new Error("URL does not have a valid protocol");return l.shell.openExternal(i.toString())}async openCustomUrl(t){this.openUrlInBrowser(t)}}class Xa{constructor(t,i){this.core=t,this.#t=i,this.core.on("ClientSettingsChanged",this.updateSettings)}#e;#t;#i=new Re.EventEmitter;get(t){return this.#t[t]}previous(t){return this.#e?this.#e[t]:void 0}on(t,i){this.#i.on(t,i)}off(t,i){this.#i.off(t,i)}updateSettings=t=>{this.#e!==void 0&&this.core.log(W.Info,E`Settings file changed.`),this.#e=this.#t,this.#t=t,this.#i.emit("change")}}const{dialog:aa}=b(157);function $a(e){aa.showMessageBoxSync({title:"\u26A0\uFE0F Warning \u26A0\uFE0F",message:e})}function ja(){aa.showMessageBoxSync({title:"Expiration Notice",message:"This application has passed its expiration date. Please get the newer version."})}var de=b(796);function ze(e=process.argv){const t=new de.Command;t.description(`1Password - 8.11.12
The 1Password desktop experience.`).arguments("[url]").name("1password").usage(`[options] [url]
Accepts an optional onepassword:// URL (e.g. for adding an account).`).option("--disable-gpu","disable GPU hardware acceleration").option("--lock","lock 1Password if it is unlocked").addOption(new de.Option("--log <level>","output logs").choices(["error","warn","info","debug","trace","off"])).addOption(new de.Option("--quick-access","open 1Password's quick access")).option("--silent","open to the system tray without showing the main window").option("--toggle","show or hide the main window").version("8.11.12","--version","show version information").helpOption("-h, --help","show this message").addHelpText("afterAll",`
Check out 'op', the 1Password CLI: https://support.1password.com/command-line.
Documentation and support: https://support.1password.com/.
Built with \u2665 by the 1Password team in Canada and around the world.`).allowUnknownOption(),t.addOption(new de.Option("--uninstall").hideHelp()),t.addOption(new de.Option("--keep-alive").hideHelp()),t.addOption(new de.Option("--auto-start").hideHelp()),t.parse(e,{from:"electron"});const i=t.opts();return i.log&&(process.env.OP_LOG_LEVEL=`${i.log}`,process.env.RUST_LOG=`${i.log}`),{url:t.args[t.args.length-1],uninstall:!!i.uninstall,toggle:i.toggle,silent:!!i.silent,lock:!!i.lock,quickAccess:!!i.quickAccess,keepAlive:!!i.keepAlive,autoStart:!!i.autoStart}}class Ya{showMenu=(t,i)=>{new l.ShareMenu(t).popup(i)}}function x(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var ca=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),qe=function(){return Math.random().toString(36).substring(7).split("").join(".")},he={INIT:"@@redux/INIT"+qe(),REPLACE:"@@redux/REPLACE"+qe(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+qe()}};function la(e){if(typeof e!="object"||e===null)return!1;for(var t=e;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function _c(e){if(e===void 0)return"undefined";if(e===null)return"null";var t=typeof e;switch(t){case"boolean":case"string":case"number":case"symbol":case"function":return t}if(Array.isArray(e))return"array";if(ec(e))return"date";if(Ja(e))return"error";var i=Za(e);switch(i){case"Symbol":case"Promise":case"WeakMap":case"WeakSet":case"Map":case"Set":return i}return t.slice(8,-1).toLowerCase().replace(/\s/g,"")}function Za(e){return typeof e.constructor=="function"?e.constructor.name:null}function Ja(e){return e instanceof Error||typeof e.message=="string"&&e.constructor&&typeof e.constructor.stackTraceLimit=="number"}function ec(e){return e instanceof Date?!0:typeof e.toDateString=="function"&&typeof e.getDate=="function"&&typeof e.setDate=="function"}function tc(e){var t=typeof e;return t}function da(e,t,i){var n;if(typeof t=="function"&&typeof i=="function"||typeof i=="function"&&typeof arguments[3]=="function")throw new Error(x(0));if(typeof t=="function"&&typeof i>"u"&&(i=t,t=void 0),typeof i<"u"){if(typeof i!="function")throw new Error(x(1));return i(da)(e,t)}if(typeof e!="function")throw new Error(x(2));var r=e,a=t,c=[],h=c,w=!1;function _(){h===c&&(h=c.slice())}function U(){if(w)throw new Error(x(3));return a}function I(P){if(typeof P!="function")throw new Error(x(4));if(w)throw new Error(x(5));var T=!0;return _(),h.push(P),function(){if(T){if(w)throw new Error(x(6));T=!1,_();var G=h.indexOf(P);h.splice(G,1),c=null}}}function M(P){if(!la(P))throw new Error(x(7));if(typeof P.type>"u")throw new Error(x(8));if(w)throw new Error(x(9));try{w=!0,a=r(a,P)}finally{w=!1}for(var T=c=h,$=0;$<T.length;$++){var G=T[$];G()}return P}function H(P){if(typeof P!="function")throw new Error(x(10));r=P,M({type:he.REPLACE})}function S(){var P,T=I;return P={subscribe:function(G){if(typeof G!="object"||G===null)throw new Error(x(11));function _e(){G.next&&G.next(U())}_e();var Qe=T(_e);return{unsubscribe:Qe}}},P[ca]=function(){return this},P}return M({type:he.INIT}),n={dispatch:M,subscribe:I,getState:U,replaceReducer:H},n[ca]=S,n}var bc=null;function Sc(e){typeof console<"u"&&typeof console.error=="function"&&console.error(e);try{throw new Error(e)}catch{}}function kc(e,t,i,n){var r=Object.keys(t),a=i&&i.type===he.INIT?"preloadedState argument passed to createStore":"previous state received by the reducer";if(r.length===0)return"Store does not have a valid reducer. Make sure the argument passed to combineReducers is an object whose values are reducers.";if(!la(e))return"The "+a+' has unexpected type of "'+tc(e)+'". Expected argument to be an object with the following '+('keys: "'+r.join('", "')+'"');var c=Object.keys(e).filter(function(h){return!t.hasOwnProperty(h)&&!n[h]});if(c.forEach(function(h){n[h]=!0}),!(i&&i.type===he.REPLACE)&&c.length>0)return"Unexpected "+(c.length>1?"keys":"key")+" "+('"'+c.join('", "')+'" found in '+a+". ")+"Expected to find one of the known reducer keys instead: "+('"'+r.join('", "')+'". Unexpected keys will be ignored.')}function ic(e){Object.keys(e).forEach(function(t){var i=e[t],n=i(void 0,{type:he.INIT});if(typeof n>"u")throw new Error(x(12));if(typeof i(void 0,{type:he.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(x(13))})}function Ac(e){for(var t=Object.keys(e),i={},n=0;n<t.length;n++){var r=t[n];typeof e[r]=="function"&&(i[r]=e[r])}var a=Object.keys(i),c,h;try{ic(i)}catch(w){h=w}return function(_,U){if(_===void 0&&(_={}),h)throw h;if(!1)var I;for(var M=!1,H={},S=0;S<a.length;S++){var P=a[S],T=i[P],$=_[P],G=T($,U);if(typeof G>"u"){var _e=U&&U.type;throw new Error(x(14))}H[P]=G,M=M||G!==$}return M=M||a.length!==Object.keys(_).length,M?H:_}}function ha(e,t){return function(){return t(e.apply(this,arguments))}}function Pc(e,t){if(typeof e=="function")return ha(e,t);if(typeof e!="object"||e===null)throw new Error(x(16));var i={};for(var n in e){var r=e[n];typeof r=="function"&&(i[n]=ha(r,t))}return i}function nc(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return t.length===0?function(n){return n}:t.length===1?t[0]:t.reduce(function(n,r){return function(){return n(r.apply(void 0,arguments))}})}function Mc(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(n){return function(){var r=n.apply(void 0,arguments),a=function(){throw new Error(x(15))},c={getState:r.getState,dispatch:function(){return a.apply(void 0,arguments)}},h=t.map(function(w){return w(c)});return a=nc.apply(void 0,h)(r.dispatch),_objectSpread(_objectSpread({},r),{},{dispatch:a})}}}const sc=(e,t)=>{switch(e||(e={qxCollection:void 0,qxOpenedBy:se.QuickAccessShortcut}),t.type){case"SetQXOpenedBy":return{...e,qxOpenedBy:t.qxOpenedBy};default:break}return e},oc=()=>da(sc);async function rc(e){l.app.enableSandbox(),l.protocol.registerSchemesAsPrivileged([{scheme:"resource",privileges:{bypassCSP:!0,supportFetchAPI:!0,standard:!0}},{scheme:"file-icon",privileges:{bypassCSP:!0,supportFetchAPI:!0,standard:!0}}]),je()||l.app.disableHardwareAcceleration(),await l.app.whenReady(),await new Promise(r=>setTimeout(r,0)),l.protocol.handle("http",()=>new Response),l.protocol.handle("https",()=>new Response),l.protocol.handle("ws",()=>new Response),l.protocol.handle("wss",()=>new Response),l.app.configureHostResolver({enableBuiltInResolver:!1,secureDnsMode:"off"});const t=JSON.stringify(e);if(d(t))switch((await l.dialog.showMessageBox({title:"1Password quit unexpectedly",message:"Click Report to send more information to the 1Password team.",buttons:["Send Later","Ignore","Report"]})).response){case 0:break;case 1:{u(t);break}case 2:{p(t);break}}const n=new za(e);n.protectProcessMemory(0),n.setCurrentProcessAumid();try{await n.invoke({type:"FrontendInitialized",content:void 0});const r=await n.invoke({type:"ClientSettings",content:void 0}),a=new Xa(n,r),c=l.session.fromPartition("persist:1password",{cache:!1});c.protocol.handle("http",()=>new Response),c.protocol.handle("https",()=>new Response),c.protocol.handle("ws",()=>new Response),c.protocol.handle("wss",()=>new Response);const h=oc(),w=new Ke(n,a,c,h);new ac(n,a,c,h,w).init(),n.clientReady(w)}catch(r){if(r.toString().includes("AppExpired"))ja();else throw r}}class ac{constructor(t,i,n,r,a){this.core=t,this.userSettings=i,this.session=n,this.state=r,this.windowManager=a,this.urlService=new Qa(t,this.windowManager),this.menu=new Ha(t,this.windowManager,this.state,this.userSettings,this.urlService),this.contextMenu=new Ia(this.core,this.windowManager,this.state),this.shareMenu=new Ya,this.tray=new Ka(t,this.windowManager,this.userSettings),this.rpc=new Ra(t,this.windowManager,this.urlService,this.menu,this.contextMenu,this.shareMenu,this.state)}urlService;menu;contextMenu;shareMenu;tray;rpc;init(){const t=()=>{l.nativeTheme.themeSource=process.env.OP_THEME?.match(/light|dark|system/)?.[0]??this.userSettings.get("appTheme")};if(t(),this.userSettings.on("change",()=>{t()}),this.core.on("ShowExpireWarning",r=>{$a(r)}),this.core.on("SecondInstanceStarted",r=>{l.app.emit("second-instance","",r)}),l.app.on("open-url",(r,a)=>{this.urlService.captureUrl(a).catch(()=>{})}),l.app.on("second-instance",(r,a)=>{const c=a.filter(w=>w!=="--enable-crashpad"&&w!=="--allow-file-access-from-files"&&!w.startsWith("--original-process-start-time=")),h=ze(c);h.lock?this.core.invoke({type:"Lock",content:void 0}):h.quickAccess?this.windowManager.toggleQuickAccess():h.toggle?this.windowManager.togglePrimaryWindow():this.urlService.captureUrlFromArgs(h).then(w=>{!w&&!h.silent&&this.windowManager.showPrimaryWindow()})}),l.app.on("open-file",(r,a)=>{this.windowManager.sendEventWhenPrimaryWindowReady("DropFiles",[a]),this.windowManager.showPrimaryWindow()}),l.app.on("web-contents-created",(r,a)=>{a.on("will-attach-webview",c=>{c.preventDefault()}),a.on("will-navigate",(c,h)=>{c.preventDefault(),this.urlService.openUrlInBrowser(h)}),a.setWindowOpenHandler(c=>(this.urlService.openUrlInBrowser(c.url),{action:"deny"}))}),l.app.on("window-all-closed",()=>{if(Ke.disableSecureInputGlobal(),!this.userSettings.get("keepInTray")){l.app.quit();return}}),!1)var i;else this.tray.on("quit",()=>{l.app.quit()});let n=!1;l.app.on("will-quit",r=>{n||(r.preventDefault(),this.tray.destroy(),Ke.disableSecureInputGlobal(),this.core.invoke({type:"FrontendEvent",content:{type:"WillQuit",content:void 0}}).catch(console.error).then(()=>{n=!0,l.app.quit()}))}),this.windowManager.on("primary-window-closed",()=>{this.core.invoke({type:"FrontendEvent",content:{type:"WindowClosed",content:void 0}})}),this.windowManager.on("primary-window-created",()=>{this.core.invoke({type:"FrontendEvent",content:{type:"MainWindowOpened",content:void 0}})}),this.session.protocol.handle("resource",()=>(this.core.log(W.Warn,E`Custom resource protocol handler is deprecated, please transition your feature to the ffi call instead`),new Response(void 0,{status:404}))),this.session.protocol.handle("file-icon",r=>{const a=A.basename(r.url);return l.app.getFileIcon(a,{size:"normal"}).then(c=>new Response(c.toPNG({scaleFactor:2}),{headers:{"Cache-Control":"max-age=300","Content-Type":"image/png"}}))}),this.onReady()}onReady(){const t=new URL("file://"+A.join(__dirname,"primary.html")).toString();this.session.setPermissionRequestHandler((n,r,a)=>{a(r==="media"&&t===n?.getURL())}),this.session.setPermissionCheckHandler((n,r,a,c)=>c.mediaType!=="video"?!1:r==="media"&&t===n?.getURL()),this.rpc.serve(),this.tray.init(),this.menu.init();const i=ze();this.urlService.captureUrlFromArgs(i).then(()=>{{const n=i.autoStart&&!this.core.showOnAutoStart();!i.silent&&!n&&this.windowManager.showPrimaryWindow()}})}}function cc(e){const{app:t}=l;let i=t.getPath("userData");process.env.LOCALAPPDATA&&(i=A.join(process.env.LOCALAPPDATA,t.getName()));const n={dbPath:i,desktopResourcesPath:t.getAppPath()};if(te(n,{electron:l}),!t.requestSingleInstanceLock()&&!(e.uninstall||e.keepAlive)){ie(W.Info,{type:"clientAlreadyRunning"}),t.quit();return}ie(W.Info,{type:"clientStarting"}),rc(n)}cc(ze())},508:k=>{k.exports=require("./index.node")},317:k=>{"use strict";k.exports=require("child_process")},157:k=>{"use strict";k.exports=require("electron")},434:k=>{"use strict";k.exports=require("events")},896:k=>{"use strict";k.exports=require("fs")},928:k=>{"use strict";k.exports=require("path")},796:(k,O,b)=>{const A=b(434).EventEmitter,fe=b(317),j=b(928),me=b(896);class y{constructor(){this.helpWidth=void 0,this.sortSubcommands=!1,this.sortOptions=!1}visibleCommands(s){const o=s.commands.filter(d=>!d._hidden);if(s._hasImplicitHelpCommand()){const d=s._helpCommandnameAndArgs.split(/ +/),u=s.createCommand(d.shift()).helpOption(!1);u.description(s._helpCommandDescription),u._parseExpectedArgs(d),o.push(u)}return this.sortSubcommands&&o.sort((d,u)=>d.name().localeCompare(u.name())),o}visibleOptions(s){const o=s.options.filter(p=>!p.hidden),d=s._hasHelpOption&&s._helpShortFlag&&!s._findOption(s._helpShortFlag),u=s._hasHelpOption&&!s._findOption(s._helpLongFlag);if(d||u){let p;d?u?p=s.createOption(s._helpFlags,s._helpDescription):p=s.createOption(s._helpShortFlag,s._helpDescription):p=s.createOption(s._helpLongFlag,s._helpDescription),o.push(p)}if(this.sortOptions){const p=f=>f.short?f.short.replace(/^-/,""):f.long.replace(/^--/,"");o.sort((f,g)=>p(f).localeCompare(p(g)))}return o}visibleArguments(s){return s._argsDescription&&s._args.length?s._args.map(o=>({term:o.name,description:s._argsDescription[o.name]||""}),0):[]}subcommandTerm(s){const o=s._args.map(d=>C(d)).join(" ");return s._name+(s._aliases[0]?"|"+s._aliases[0]:"")+(s.options.length?" [options]":"")+(o?" "+o:"")}optionTerm(s){return s.flags}longestSubcommandTermLength(s,o){return o.visibleCommands(s).reduce((d,u)=>Math.max(d,o.subcommandTerm(u).length),0)}longestOptionTermLength(s,o){return o.visibleOptions(s).reduce((d,u)=>Math.max(d,o.optionTerm(u).length),0)}longestArgumentTermLength(s,o){return o.visibleArguments(s).reduce((d,u)=>Math.max(d,u.term.length),0)}commandUsage(s){let o=s._name;s._aliases[0]&&(o=o+"|"+s._aliases[0]);let d="";for(let u=s.parent;u;u=u.parent)d=u.name()+" "+d;return d+o+" "+s.usage()}commandDescription(s){return s.description()}subcommandDescription(s){return s.description()}optionDescription(s){if(s.negate)return s.description;const o=[];return s.argChoices&&o.push(`choices: ${s.argChoices.map(d=>JSON.stringify(d)).join(", ")}`),s.defaultValue!==void 0&&o.push(`default: ${s.defaultValueDescription||JSON.stringify(s.defaultValue)}`),o.length>0?`${s.description} (${o.join(", ")})`:s.description}formatHelp(s,o){const d=o.padWidth(s,o),u=o.helpWidth||80,p=2,f=2;function g(V,We){if(We){const Ie=`${V.padEnd(d+f)}${We}`;return o.wrap(Ie,u-p,d+f)}return V}function m(V){return V.join(`
`).replace(/^/gm," ".repeat(p))}let v=[`Usage: ${o.commandUsage(s)}`,""];const L=o.commandDescription(s);L.length>0&&(v=v.concat([L,""]));const F=o.visibleArguments(s).map(V=>g(V.term,V.description));F.length>0&&(v=v.concat(["Arguments:",m(F),""]));const R=o.visibleOptions(s).map(V=>g(o.optionTerm(V),o.optionDescription(V)));R.length>0&&(v=v.concat(["Options:",m(R),""]));const J=o.visibleCommands(s).map(V=>g(o.subcommandTerm(V),o.subcommandDescription(V)));return J.length>0&&(v=v.concat(["Commands:",m(J),""])),v.join(`
`)}padWidth(s,o){return Math.max(o.longestOptionTermLength(s,o),o.longestSubcommandTermLength(s,o),o.longestArgumentTermLength(s,o))}wrap(s,o,d,u=40){if(s.match(/[\n]\s+/))return s;const p=o-d;if(p<u)return s;const f=s.substr(0,d),g=s.substr(d),m=" ".repeat(d),v=new RegExp(".{1,"+(p-1)+"}([\\s\u200B]|$)|[^\\s\u200B]+?([\\s\u200B]|$)","g"),L=g.match(v)||[];return f+L.map((F,R)=>(F.slice(-1)===`
`&&(F=F.slice(0,F.length-1)),(R>0?m:"")+F.trimRight())).join(`
`)}}class Ae{constructor(s,o){this.flags=s,this.description=o||"",this.required=s.includes("<"),this.optional=s.includes("["),this.variadic=/\w\.\.\.[>\]]$/.test(s),this.mandatory=!1;const d=ie(s);this.short=d.shortFlag,this.long=d.longFlag,this.negate=!1,this.long&&(this.negate=this.long.startsWith("--no-")),this.defaultValue=void 0,this.defaultValueDescription=void 0,this.parseArg=void 0,this.hidden=!1,this.argChoices=void 0}default(s,o){return this.defaultValue=s,this.defaultValueDescription=o,this}argParser(s){return this.parseArg=s,this}makeOptionMandatory(s=!0){return this.mandatory=!!s,this}hideHelp(s=!0){return this.hidden=!!s,this}_concatValue(s,o){return o===this.defaultValue||!Array.isArray(o)?[s]:o.concat(s)}choices(s){return this.argChoices=s,this.parseArg=(o,d)=>{if(!s.includes(o))throw new Pe(`Allowed choices are ${s.join(", ")}.`);return this.variadic?this._concatValue(o,d):o},this}name(){return this.long?this.long.replace(/^--/,""):this.short.replace(/^-/,"")}attributeName(){return xe(this.name().replace(/^no-/,""))}is(s){return this.short===s||this.long===s}}class ee extends Error{constructor(s,o,d){super(d),Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.code=o,this.exitCode=s,this.nestedError=void 0}}class Pe extends ee{constructor(s){super(1,"commander.invalidOptionArgument",s),Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name}}class te extends A{constructor(s){super(),this.commands=[],this.options=[],this.parent=null,this._allowUnknownOption=!1,this._allowExcessArguments=!0,this._args=[],this.rawArgs=null,this._scriptPath=null,this._name=s||"",this._optionValues={},this._storeOptionsAsProperties=!1,this._actionResults=[],this._actionHandler=null,this._executableHandler=!1,this._executableFile=null,this._defaultCommandName=null,this._exitCallback=null,this._aliases=[],this._combineFlagAndOptionalValue=!0,this._description="",this._argsDescription=void 0,this._enablePositionalOptions=!1,this._passThroughOptions=!1,this._outputConfiguration={writeOut:o=>process.stdout.write(o),writeErr:o=>process.stderr.write(o),getOutHelpWidth:()=>process.stdout.isTTY?process.stdout.columns:void 0,getErrHelpWidth:()=>process.stderr.isTTY?process.stderr.columns:void 0,outputError:(o,d)=>d(o)},this._hidden=!1,this._hasHelpOption=!0,this._helpFlags="-h, --help",this._helpDescription="display help for command",this._helpShortFlag="-h",this._helpLongFlag="--help",this._addImplicitHelpCommand=void 0,this._helpCommandName="help",this._helpCommandnameAndArgs="help [command]",this._helpCommandDescription="display help for command",this._helpConfiguration={}}command(s,o,d){let u=o,p=d;typeof u=="object"&&u!==null&&(p=u,u=null),p=p||{};const f=s.split(/ +/),g=this.createCommand(f.shift());return u&&(g.description(u),g._executableHandler=!0),p.isDefault&&(this._defaultCommandName=g._name),g._outputConfiguration=this._outputConfiguration,g._hidden=!!(p.noHelp||p.hidden),g._hasHelpOption=this._hasHelpOption,g._helpFlags=this._helpFlags,g._helpDescription=this._helpDescription,g._helpShortFlag=this._helpShortFlag,g._helpLongFlag=this._helpLongFlag,g._helpCommandName=this._helpCommandName,g._helpCommandnameAndArgs=this._helpCommandnameAndArgs,g._helpCommandDescription=this._helpCommandDescription,g._helpConfiguration=this._helpConfiguration,g._exitCallback=this._exitCallback,g._storeOptionsAsProperties=this._storeOptionsAsProperties,g._combineFlagAndOptionalValue=this._combineFlagAndOptionalValue,g._allowExcessArguments=this._allowExcessArguments,g._enablePositionalOptions=this._enablePositionalOptions,g._executableFile=p.executableFile||null,this.commands.push(g),g._parseExpectedArgs(f),g.parent=this,u?this:g}createCommand(s){return new te(s)}createHelp(){return Object.assign(new y,this.configureHelp())}configureHelp(s){return s===void 0?this._helpConfiguration:(this._helpConfiguration=s,this)}configureOutput(s){return s===void 0?this._outputConfiguration:(Object.assign(this._outputConfiguration,s),this)}addCommand(s,o){if(!s._name)throw new Error("Command passed to .addCommand() must have a name");function d(u){u.forEach(p=>{if(p._executableHandler&&!p._executableFile)throw new Error(`Must specify executableFile for deeply nested executable: ${p.name()}`);d(p.commands)})}return d(s.commands),o=o||{},o.isDefault&&(this._defaultCommandName=s._name),(o.noHelp||o.hidden)&&(s._hidden=!0),this.commands.push(s),s.parent=this,this}arguments(s){return this._parseExpectedArgs(s.split(/ +/))}addHelpCommand(s,o){return s===!1?this._addImplicitHelpCommand=!1:(this._addImplicitHelpCommand=!0,typeof s=="string"&&(this._helpCommandName=s.split(" ")[0],this._helpCommandnameAndArgs=s),this._helpCommandDescription=o||this._helpCommandDescription),this}_hasImplicitHelpCommand(){return this._addImplicitHelpCommand===void 0?this.commands.length&&!this._actionHandler&&!this._findCommand("help"):this._addImplicitHelpCommand}_parseExpectedArgs(s){if(s.length)return s.forEach(o=>{const d={required:!1,name:"",variadic:!1};switch(o[0]){case"<":d.required=!0,d.name=o.slice(1,-1);break;case"[":d.name=o.slice(1,-1);break}d.name.length>3&&d.name.slice(-3)==="..."&&(d.variadic=!0,d.name=d.name.slice(0,-3)),d.name&&this._args.push(d)}),this._args.forEach((o,d)=>{if(o.variadic&&d<this._args.length-1)throw new Error(`only the last argument can be variadic '${o.name}'`)}),this}exitOverride(s){return s?this._exitCallback=s:this._exitCallback=o=>{if(o.code!=="commander.executeSubCommandAsync")throw o},this}_exit(s,o,d){this._exitCallback&&this._exitCallback(new ee(s,o,d)),process.exit(s)}action(s){const o=d=>{const u=this._args.length,p=d.slice(0,u);this._storeOptionsAsProperties?p[u]=this:p[u]=this.opts(),p.push(this);const f=s.apply(this,p);let g=this;for(;g.parent;)g=g.parent;g._actionResults.push(f)};return this._actionHandler=o,this}createOption(s,o){return new Ae(s,o)}addOption(s){const o=s.name(),d=s.attributeName();let u=s.defaultValue;if(s.negate||s.optional||s.required||typeof u=="boolean"){if(s.negate){const p=s.long.replace(/^--no-/,"--");u=this._findOption(p)?this._getOptionValue(d):!0}u!==void 0&&this._setOptionValue(d,u)}return this.options.push(s),this.on("option:"+o,p=>{const f=this._getOptionValue(d);if(p!==null&&s.parseArg)try{p=s.parseArg(p,f===void 0?u:f)}catch(g){if(g.code==="commander.invalidOptionArgument"){const m=`error: option '${s.flags}' argument '${p}' is invalid. ${g.message}`;this._displayError(g.exitCode,g.code,m)}throw g}else p!==null&&s.variadic&&(p=s._concatValue(p,f));typeof f=="boolean"||typeof f>"u"?p==null?this._setOptionValue(d,s.negate?!1:u||!0):this._setOptionValue(d,p):p!==null&&this._setOptionValue(d,s.negate?!1:p)}),this}_optionEx(s,o,d,u,p){const f=this.createOption(o,d);if(f.makeOptionMandatory(!!s.mandatory),typeof u=="function")f.default(p).argParser(u);else if(u instanceof RegExp){const g=u;u=(m,v)=>{const L=g.exec(m);return L?L[0]:v},f.default(p).argParser(u)}else f.default(u);return this.addOption(f)}option(s,o,d,u){return this._optionEx({},s,o,d,u)}requiredOption(s,o,d,u){return this._optionEx({mandatory:!0},s,o,d,u)}combineFlagAndOptionalValue(s=!0){return this._combineFlagAndOptionalValue=!!s,this}allowUnknownOption(s=!0){return this._allowUnknownOption=!!s,this}allowExcessArguments(s=!0){return this._allowExcessArguments=!!s,this}enablePositionalOptions(s=!0){return this._enablePositionalOptions=!!s,this}passThroughOptions(s=!0){if(this._passThroughOptions=!!s,this.parent&&s&&!this.parent._enablePositionalOptions)throw new Error("passThroughOptions can not be used without turning on enablePositionalOptions for parent command(s)");return this}storeOptionsAsProperties(s=!0){if(this._storeOptionsAsProperties=!!s,this.options.length)throw new Error("call .storeOptionsAsProperties() before adding options");return this}_setOptionValue(s,o){this._storeOptionsAsProperties?this[s]=o:this._optionValues[s]=o}_getOptionValue(s){return this._storeOptionsAsProperties?this[s]:this._optionValues[s]}parse(s,o){if(s!==void 0&&!Array.isArray(s))throw new Error("first parameter to parse must be array or undefined");o=o||{},s===void 0&&(s=process.argv,process.versions&&process.versions.electron&&(o.from="electron")),this.rawArgs=s.slice();let d;switch(o.from){case void 0:case"node":this._scriptPath=s[1],d=s.slice(2);break;case"electron":process.defaultApp?(this._scriptPath=s[1],d=s.slice(2)):d=s.slice(1);break;case"user":d=s.slice(0);break;default:throw new Error(`unexpected parse option { from: '${o.from}' }`)}return!this._scriptPath&&b.c[b.s]&&(this._scriptPath=b.c[b.s].filename),this._name=this._name||this._scriptPath&&j.basename(this._scriptPath,j.extname(this._scriptPath)),this._parseCommand([],d),this}parseAsync(s,o){return this.parse(s,o),Promise.all(this._actionResults).then(()=>this)}_executeSubCommand(s,o){o=o.slice();let d=!1;const u=[".js",".ts",".tsx",".mjs",".cjs"];this._checkForMissingMandatoryOptions();let p=this._scriptPath;!p&&b.c[b.s]&&(p=b.c[b.s].filename);let f;try{const R=me.realpathSync(p);f=j.dirname(R)}catch{f="."}let g=j.basename(p,j.extname(p))+"-"+s._name;s._executableFile&&(g=s._executableFile);const m=j.join(f,g);me.existsSync(m)?g=m:u.forEach(R=>{me.existsSync(`${m}${R}`)&&(g=`${m}${R}`)}),d=u.includes(j.extname(g));let v;process.platform!=="win32"?d?(o.unshift(g),o=Me(process.execArgv).concat(o),v=fe.spawn(process.argv[0],o,{stdio:"inherit"})):v=fe.spawn(g,o,{stdio:"inherit"}):(o.unshift(g),o=Me(process.execArgv).concat(o),v=fe.spawn(process.execPath,o,{stdio:"inherit"})),["SIGUSR1","SIGUSR2","SIGTERM","SIGINT","SIGHUP"].forEach(R=>{process.on(R,()=>{v.killed===!1&&v.exitCode===null&&v.kill(R)})});const F=this._exitCallback;F?v.on("close",()=>{F(new ee(process.exitCode||0,"commander.executeSubCommandAsync","(close)"))}):v.on("close",process.exit.bind(process)),v.on("error",R=>{if(R.code==="ENOENT"){const J=`'${g}' does not exist
 - if '${s._name}' is not meant to be an executable command, remove description parameter from '.command()' and use '.description()' instead
 - if the default executable name is not suitable, use the executableFile option to supply a custom name`;throw new Error(J)}else if(R.code==="EACCES")throw new Error(`'${g}' not executable`);if(!F)process.exit(1);else{const J=new ee(1,"commander.executeSubCommandAsync","(error)");J.nestedError=R,F(J)}}),this.runningCommand=v}_dispatchSubcommand(s,o,d){const u=this._findCommand(s);u||this.help({error:!0}),u._executableHandler?this._executeSubCommand(u,o.concat(d)):u._parseCommand(o,d)}_parseCommand(s,o){const d=this.parseOptions(o);if(s=s.concat(d.operands),o=d.unknown,this.args=s.concat(o),s&&this._findCommand(s[0]))this._dispatchSubcommand(s[0],s.slice(1),o);else if(this._hasImplicitHelpCommand()&&s[0]===this._helpCommandName)s.length===1?this.help():this._dispatchSubcommand(s[1],[],[this._helpLongFlag]);else if(this._defaultCommandName)He(this,o),this._dispatchSubcommand(this._defaultCommandName,s,o);else{this.commands.length&&this.args.length===0&&!this._actionHandler&&!this._defaultCommandName&&this.help({error:!0}),He(this,d.unknown),this._checkForMissingMandatoryOptions();const u=()=>{d.unknown.length>0&&this.unknownOption(d.unknown[0])},p=`command:${this.name()}`;if(this._actionHandler){u();const f=this.args.slice();this._args.forEach((g,m)=>{g.required&&f[m]==null?this.missingArgument(g.name):g.variadic&&(f[m]=f.splice(m),f.length=Math.min(m+1,f.length))}),f.length>this._args.length&&this._excessArguments(f),this._actionHandler(f),this.parent&&this.parent.emit(p,s,o)}else this.parent&&this.parent.listenerCount(p)?(u(),this.parent.emit(p,s,o)):s.length?this._findCommand("*")?this._dispatchSubcommand("*",s,o):this.listenerCount("command:*")?this.emit("command:*",s,o):this.commands.length?this.unknownCommand():u():this.commands.length?this.help({error:!0}):u()}}_findCommand(s){if(s)return this.commands.find(o=>o._name===s||o._aliases.includes(s))}_findOption(s){return this.options.find(o=>o.is(s))}_checkForMissingMandatoryOptions(){for(let s=this;s;s=s.parent)s.options.forEach(o=>{o.mandatory&&s._getOptionValue(o.attributeName())===void 0&&s.missingMandatoryOptionValue(o)})}parseOptions(s){const o=[],d=[];let u=o;const p=s.slice();function f(m){return m.length>1&&m[0]==="-"}let g=null;for(;p.length;){const m=p.shift();if(m==="--"){u===d&&u.push(m),u.push(...p);break}if(g&&!f(m)){this.emit(`option:${g.name()}`,m);continue}if(g=null,f(m)){const v=this._findOption(m);if(v){if(v.required){const L=p.shift();L===void 0&&this.optionMissingArgument(v),this.emit(`option:${v.name()}`,L)}else if(v.optional){let L=null;p.length>0&&!f(p[0])&&(L=p.shift()),this.emit(`option:${v.name()}`,L)}else this.emit(`option:${v.name()}`);g=v.variadic?v:null;continue}}if(m.length>2&&m[0]==="-"&&m[1]!=="-"){const v=this._findOption(`-${m[1]}`);if(v){v.required||v.optional&&this._combineFlagAndOptionalValue?this.emit(`option:${v.name()}`,m.slice(2)):(this.emit(`option:${v.name()}`),p.unshift(`-${m.slice(2)}`));continue}}if(/^--[^=]+=/.test(m)){const v=m.indexOf("="),L=this._findOption(m.slice(0,v));if(L&&(L.required||L.optional)){this.emit(`option:${L.name()}`,m.slice(v+1));continue}}if(f(m)&&(u=d),(this._enablePositionalOptions||this._passThroughOptions)&&o.length===0&&d.length===0){if(this._findCommand(m)){o.push(m),p.length>0&&d.push(...p);break}else if(m===this._helpCommandName&&this._hasImplicitHelpCommand()){o.push(m),p.length>0&&o.push(...p);break}else if(this._defaultCommandName){d.push(m),p.length>0&&d.push(...p);break}}if(this._passThroughOptions){u.push(m),p.length>0&&u.push(...p);break}u.push(m)}return{operands:o,unknown:d}}opts(){if(this._storeOptionsAsProperties){const s={},o=this.options.length;for(let d=0;d<o;d++){const u=this.options[d].attributeName();s[u]=u===this._versionOptionName?this._version:this[u]}return s}return this._optionValues}_displayError(s,o,d){this._outputConfiguration.outputError(`${d}
`,this._outputConfiguration.writeErr),this._exit(s,o,d)}missingArgument(s){const o=`error: missing required argument '${s}'`;this._displayError(1,"commander.missingArgument",o)}optionMissingArgument(s){const o=`error: option '${s.flags}' argument missing`;this._displayError(1,"commander.optionMissingArgument",o)}missingMandatoryOptionValue(s){const o=`error: required option '${s.flags}' not specified`;this._displayError(1,"commander.missingMandatoryOptionValue",o)}unknownOption(s){if(this._allowUnknownOption)return;const o=`error: unknown option '${s}'`;this._displayError(1,"commander.unknownOption",o)}_excessArguments(s){if(this._allowExcessArguments)return;const o=this._args.length,d=o===1?"":"s",p=`error: too many arguments${this.parent?` for '${this.name()}'`:""}. Expected ${o} argument${d} but got ${s.length}.`;this._displayError(1,"commander.excessArguments",p)}unknownCommand(){const s=[this.name()];for(let u=this.parent;u;u=u.parent)s.unshift(u.name());const o=s.join(" "),d=`error: unknown command '${this.args[0]}'.`+(this._hasHelpOption?` See '${o} ${this._helpLongFlag}'.`:"");this._displayError(1,"commander.unknownCommand",d)}version(s,o,d){if(s===void 0)return this._version;this._version=s,o=o||"-V, --version",d=d||"output the version number";const u=this.createOption(o,d);return this._versionOptionName=u.attributeName(),this.options.push(u),this.on("option:"+u.name(),()=>{this._outputConfiguration.writeOut(`${s}
`),this._exit(0,"commander.version",s)}),this}description(s,o){return s===void 0&&o===void 0?this._description:(this._description=s,this._argsDescription=o,this)}alias(s){if(s===void 0)return this._aliases[0];let o=this;if(this.commands.length!==0&&this.commands[this.commands.length-1]._executableHandler&&(o=this.commands[this.commands.length-1]),s===o._name)throw new Error("Command alias can't be the same as its name");return o._aliases.push(s),this}aliases(s){return s===void 0?this._aliases:(s.forEach(o=>this.alias(o)),this)}usage(s){if(s===void 0){if(this._usage)return this._usage;const o=this._args.map(d=>C(d));return[].concat(this.options.length||this._hasHelpOption?"[options]":[],this.commands.length?"[command]":[],this._args.length?o:[]).join(" ")}return this._usage=s,this}name(s){return s===void 0?this._name:(this._name=s,this)}helpInformation(s){const o=this.createHelp();return o.helpWidth===void 0&&(o.helpWidth=s&&s.error?this._outputConfiguration.getErrHelpWidth():this._outputConfiguration.getOutHelpWidth()),o.formatHelp(this,o)}_getHelpContext(s){s=s||{};const o={error:!!s.error};let d;return o.error?d=u=>this._outputConfiguration.writeErr(u):d=u=>this._outputConfiguration.writeOut(u),o.write=s.write||d,o.command=this,o}outputHelp(s){let o;typeof s=="function"&&(o=s,s=void 0);const d=this._getHelpContext(s),u=[];let p=this;for(;p;)u.push(p),p=p.parent;u.slice().reverse().forEach(g=>g.emit("beforeAllHelp",d)),this.emit("beforeHelp",d);let f=this.helpInformation(d);if(o&&(f=o(f),typeof f!="string"&&!Buffer.isBuffer(f)))throw new Error("outputHelp callback must return a string or a Buffer");d.write(f),this.emit(this._helpLongFlag),this.emit("afterHelp",d),u.forEach(g=>g.emit("afterAllHelp",d))}helpOption(s,o){if(typeof s=="boolean")return this._hasHelpOption=s,this;this._helpFlags=s||this._helpFlags,this._helpDescription=o||this._helpDescription;const d=ie(this._helpFlags);return this._helpShortFlag=d.shortFlag,this._helpLongFlag=d.longFlag,this}help(s){this.outputHelp(s);let o=process.exitCode||0;o===0&&s&&typeof s!="function"&&s.error&&(o=1),this._exit(o,"commander.help","(outputHelp)")}addHelpText(s,o){const d=["beforeAll","before","after","afterAll"];if(!d.includes(s))throw new Error(`Unexpected value for position to addHelpText.
Expecting one of '${d.join("', '")}'`);const u=`${s}Help`;return this.on(u,p=>{let f;typeof o=="function"?f=o({error:p.error,command:p.command}):f=o,f&&p.write(`${f}
`)}),this}}O=k.exports=new te,O.program=O,O.Command=te,O.Option=Ae,O.CommanderError=ee,O.InvalidOptionArgumentError=Pe,O.Help=y;function xe(D){return D.split("-").reduce((s,o)=>s+o[0].toUpperCase()+o.slice(1))}function He(D,s){D._hasHelpOption&&s.find(d=>d===D._helpLongFlag||d===D._helpShortFlag)&&(D.outputHelp(),D._exit(0,"commander.helpDisplayed","(outputHelp)"))}function C(D){const s=D.name+(D.variadic===!0?"...":"");return D.required?"<"+s+">":"["+s+"]"}function ie(D){let s,o;const d=D.split(/[ |,]+/);return d.length>1&&!/^[[<]/.test(d[1])&&(s=d.shift()),o=d.shift(),!s&&/^-[^-]$/.test(o)&&(s=o,o=void 0),{shortFlag:s,longFlag:o}}function Me(D){return D.map(s=>{if(!s.startsWith("--inspect"))return s;let o,d="127.0.0.1",u="9229",p;return(p=s.match(/^(--inspect(-brk)?)$/))!==null?o=p[1]:(p=s.match(/^(--inspect(-brk|-port)?)=([^:]+)$/))!==null?(o=p[1],/^\d+$/.test(p[3])?u=p[3]:d=p[3]):(p=s.match(/^(--inspect(-brk|-port)?)=([^:]+):(\d+)$/))!==null&&(o=p[1],d=p[3],u=p[4]),o&&u!=="0"?`${o}=${d}:${parseInt(u)+1}`:s})}}},Ce={};function Q(k){var O=Ce[k];if(O!==void 0)return O.exports;var b=Ce[k]={exports:{}};return wa[k](b,b.exports,Q),b.exports}Q.c=Ce,Q.n=k=>{var O=k&&k.__esModule?()=>k.default:()=>k;return Q.d(O,{a:O}),O},Q.d=(k,O)=>{for(var b in O)Q.o(O,b)&&!Q.o(k,b)&&Object.defineProperty(k,b,{enumerable:!0,get:O[b]})},Q.o=(k,O)=>Object.prototype.hasOwnProperty.call(k,O);var vc=Q(Q.s=996)})();

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoiO0FBaUJBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUM2T0E7QUFvQ0E7QUE4Q0E7QUFJQTtBQTZpQ0E7QUFDQTtBQTJUQTtBQThHQTtBQW9PQTtBQWFBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vQDFwYXNzd29yZC9vcGgvLi9zcmMvbWFpbi9jbGkudHMiLCJ3ZWJwYWNrOi8vQDFwYXNzd29yZC9vcGgvLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL2NvbW1hbmRlckA3LjIuMC9ub2RlX21vZHVsZXMvY29tbWFuZGVyL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbW1hbmQsIE9wdGlvbiB9IGZyb20gXCJjb21tYW5kZXJcIjtcblxuZXhwb3J0IGludGVyZmFjZSBPUENvbW1hbmRMaW5lQXJndW1lbnRzIHtcblx0dXJsOiBzdHJpbmcgfCB1bmRlZmluZWQ7XG5cdHNpbGVudDogYm9vbGVhbjtcblx0dW5pbnN0YWxsOiBib29sZWFuO1xuXHR0b2dnbGU6IGJvb2xlYW47XG5cdGxvY2s6IGJvb2xlYW47XG5cdHF1aWNrQWNjZXNzOiBib29sZWFuO1xuXHRrZWVwQWxpdmU6IGJvb2xlYW47XG5cdGF1dG9TdGFydDogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlQ2xpQXJncyhhcmdzID0gcHJvY2Vzcy5hcmd2KTogT1BDb21tYW5kTGluZUFyZ3VtZW50cyB7XG5cdC8vIFdlIHJlY3JlYXRlIHRoZSBwcm9ncmFtIGVhY2ggdGltZSBzbyBpdCByZXNldHMgcHJldmlvdXMgYXJndW1lbnRzXG5cdGNvbnN0IHByb2dyYW0gPSBuZXcgQ29tbWFuZCgpO1xuXG5cdHByb2dyYW1cblx0XHQuZGVzY3JpcHRpb24oXG5cdFx0XHRgMVBhc3N3b3JkIC0gJHtPUEhfVkVSU0lPTn1gICsgXCJcXG5UaGUgMVBhc3N3b3JkIGRlc2t0b3AgZXhwZXJpZW5jZS5cIixcblx0XHQpXG5cdFx0LmFyZ3VtZW50cyhcIlt1cmxdXCIpXG5cdFx0Lm5hbWUoXCIxcGFzc3dvcmRcIilcblx0XHQudXNhZ2UoXG5cdFx0XHRcIltvcHRpb25zXSBbdXJsXVwiICtcblx0XHRcdFx0XCJcXG5BY2NlcHRzIGFuIG9wdGlvbmFsIG9uZXBhc3N3b3JkOi8vIFVSTCAoZS5nLiBmb3IgYWRkaW5nIGFuIGFjY291bnQpLlwiLFxuXHRcdClcblx0XHQub3B0aW9uKFwiLS1kaXNhYmxlLWdwdVwiLCBcImRpc2FibGUgR1BVIGhhcmR3YXJlIGFjY2VsZXJhdGlvblwiKVxuXHRcdC5vcHRpb24oXCItLWxvY2tcIiwgXCJsb2NrIDFQYXNzd29yZCBpZiBpdCBpcyB1bmxvY2tlZFwiKVxuXHRcdC5hZGRPcHRpb24oXG5cdFx0XHRuZXcgT3B0aW9uKFwiLS1sb2cgPGxldmVsPlwiLCBcIm91dHB1dCBsb2dzXCIpLmNob2ljZXMoW1xuXHRcdFx0XHRcImVycm9yXCIsXG5cdFx0XHRcdFwid2FyblwiLFxuXHRcdFx0XHRcImluZm9cIixcblx0XHRcdFx0XCJkZWJ1Z1wiLFxuXHRcdFx0XHRcInRyYWNlXCIsXG5cdFx0XHRcdFwib2ZmXCIsXG5cdFx0XHRdKSxcblx0XHQpXG5cdFx0LmFkZE9wdGlvbihuZXcgT3B0aW9uKFwiLS1xdWljay1hY2Nlc3NcIiwgXCJvcGVuIDFQYXNzd29yZCdzIHF1aWNrIGFjY2Vzc1wiKSlcblx0XHQub3B0aW9uKFxuXHRcdFx0XCItLXNpbGVudFwiLFxuXHRcdFx0XCJvcGVuIHRvIHRoZSBzeXN0ZW0gdHJheSB3aXRob3V0IHNob3dpbmcgdGhlIG1haW4gd2luZG93XCIsXG5cdFx0KVxuXHRcdC5vcHRpb24oXCItLXRvZ2dsZVwiLCBcInNob3cgb3IgaGlkZSB0aGUgbWFpbiB3aW5kb3dcIilcblx0XHQudmVyc2lvbihPUEhfVkVSU0lPTiwgXCItLXZlcnNpb25cIiwgXCJzaG93IHZlcnNpb24gaW5mb3JtYXRpb25cIilcblx0XHQuaGVscE9wdGlvbihcIi1oLCAtLWhlbHBcIiwgXCJzaG93IHRoaXMgbWVzc2FnZVwiKVxuXHRcdC5hZGRIZWxwVGV4dChcblx0XHRcdFwiYWZ0ZXJBbGxcIixcblx0XHRcdFwiXFxuQ2hlY2sgb3V0ICdvcCcsIHRoZSAxUGFzc3dvcmQgQ0xJOiBodHRwczovL3N1cHBvcnQuMXBhc3N3b3JkLmNvbS9jb21tYW5kLWxpbmUuXCIgK1xuXHRcdFx0XHRcIlxcbkRvY3VtZW50YXRpb24gYW5kIHN1cHBvcnQ6IGh0dHBzOi8vc3VwcG9ydC4xcGFzc3dvcmQuY29tLy5cIiArXG5cdFx0XHRcdFwiXFxuQnVpbHQgd2l0aCDimaUgYnkgdGhlIDFQYXNzd29yZCB0ZWFtIGluIENhbmFkYSBhbmQgYXJvdW5kIHRoZSB3b3JsZC5cIixcblx0XHQpXG5cdFx0Ly8gQWxsb3cgRWxlY3Ryb24gb3B0aW9uc1xuXHRcdC5hbGxvd1Vua25vd25PcHRpb24oKTtcblxuXHRpZiAoSVNfV0lORE9XUykge1xuXHRcdC8vIEFsbG93cyB0aGUgV2luZG93cyBhcHAgdG8gYmUgdW5pbnN0YWxsZWRcblx0XHRwcm9ncmFtLmFkZE9wdGlvbihuZXcgT3B0aW9uKFwiLS11bmluc3RhbGxcIikuaGlkZUhlbHAoKSk7XG5cdFx0Ly8gQWxsb3dzIHRoZSBXaW5kb3dzIGFwcCB0byBsYXVuY2ggYSBwcmlvcml0eSBpbnN0YW5jZSB0byByZXNvbHZlIGNvbmZsaWN0aW5nIGluc3RhbGxzLlxuXHRcdHByb2dyYW0uYWRkT3B0aW9uKG5ldyBPcHRpb24oXCItLWtlZXAtYWxpdmVcIikuaGlkZUhlbHAoKSk7XG5cdFx0Ly8gTGF1bmNoIHRoZSBXaW5kb3dzIGFwcCwgYnV0IHVzZSB0aGUgT3BlbkFwcE9uU3RhcnR1cCBzZXR0aW5nIHRvIGNvbnRyb2wgdGhlIHNpbGVuY2UuXG5cdFx0cHJvZ3JhbS5hZGRPcHRpb24obmV3IE9wdGlvbihcIi0tYXV0by1zdGFydFwiKS5oaWRlSGVscCgpKTtcblx0fVxuXG5cdHByb2dyYW0ucGFyc2UoYXJncywgeyBmcm9tOiBcImVsZWN0cm9uXCIgfSk7XG5cdGNvbnN0IG9wdHMgPSBwcm9ncmFtLm9wdHMoKTtcblx0aWYgKG9wdHMubG9nKSB7XG5cdFx0cHJvY2Vzcy5lbnYuT1BfTE9HX0xFVkVMID0gYCR7b3B0cy5sb2d9YDtcblx0XHQvLyBOb3Qgc3RyaWN0bHkgbmVlZGVkLCBidXQgdXNlZnVsIGZvciBkZWJ1ZyBidWlsZHNcblx0XHQvLyB0aGF0IGRvIHJlc3BlY3QgYFJVU1RfTE9HYC4gVGhpcyB2YWx1ZSBpcyBpZ25vcmVkIGluIHJlbGVhc2Vcblx0XHQvLyBDb3JlIGJ1aWxkcy5cblx0XHRwcm9jZXNzLmVudi5SVVNUX0xPRyA9IGAke29wdHMubG9nfWA7XG5cdH1cblxuXHRyZXR1cm4ge1xuXHRcdHVybDogcHJvZ3JhbS5hcmdzW3Byb2dyYW0uYXJncy5sZW5ndGggLSAxXSxcblx0XHR1bmluc3RhbGw6ICEhb3B0cy51bmluc3RhbGwsXG5cdFx0dG9nZ2xlOiBvcHRzLnRvZ2dsZSxcblx0XHRzaWxlbnQ6ICEhb3B0cy5zaWxlbnQsXG5cdFx0bG9jazogISFvcHRzLmxvY2ssXG5cdFx0cXVpY2tBY2Nlc3M6ICEhb3B0cy5xdWlja0FjY2Vzcyxcblx0XHRrZWVwQWxpdmU6ICEhb3B0cy5rZWVwQWxpdmUsXG5cdFx0YXV0b1N0YXJ0OiAhIW9wdHMuYXV0b1N0YXJ0LFxuXHR9O1xufVxuIiwiLyoqXG4gKiBNb2R1bGUgZGVwZW5kZW5jaWVzLlxuICovXG5cbmNvbnN0IEV2ZW50RW1pdHRlciA9IHJlcXVpcmUoJ2V2ZW50cycpLkV2ZW50RW1pdHRlcjtcbmNvbnN0IGNoaWxkUHJvY2VzcyA9IHJlcXVpcmUoJ2NoaWxkX3Byb2Nlc3MnKTtcbmNvbnN0IHBhdGggPSByZXF1aXJlKCdwYXRoJyk7XG5jb25zdCBmcyA9IHJlcXVpcmUoJ2ZzJyk7XG5cbi8vIEB0cy1jaGVja1xuXG4vLyBBbHRob3VnaCB0aGlzIGlzIGEgY2xhc3MsIG1ldGhvZHMgYXJlIHN0YXRpYyBpbiBzdHlsZSB0byBhbGxvdyBvdmVycmlkZSB1c2luZyBzdWJjbGFzcyBvciBqdXN0IGZ1bmN0aW9ucy5cbmNsYXNzIEhlbHAge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmhlbHBXaWR0aCA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLnNvcnRTdWJjb21tYW5kcyA9IGZhbHNlO1xuICAgIHRoaXMuc29ydE9wdGlvbnMgPSBmYWxzZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgYW4gYXJyYXkgb2YgdGhlIHZpc2libGUgc3ViY29tbWFuZHMuIEluY2x1ZGVzIGEgcGxhY2Vob2xkZXIgZm9yIHRoZSBpbXBsaWNpdCBoZWxwIGNvbW1hbmQsIGlmIHRoZXJlIGlzIG9uZS5cbiAgICpcbiAgICogQHBhcmFtIHtDb21tYW5kfSBjbWRcbiAgICogQHJldHVybnMge0NvbW1hbmRbXX1cbiAgICovXG5cbiAgdmlzaWJsZUNvbW1hbmRzKGNtZCkge1xuICAgIGNvbnN0IHZpc2libGVDb21tYW5kcyA9IGNtZC5jb21tYW5kcy5maWx0ZXIoY21kID0+ICFjbWQuX2hpZGRlbik7XG4gICAgaWYgKGNtZC5faGFzSW1wbGljaXRIZWxwQ29tbWFuZCgpKSB7XG4gICAgICAvLyBDcmVhdGUgYSBjb21tYW5kIG1hdGNoaW5nIHRoZSBpbXBsaWNpdCBoZWxwIGNvbW1hbmQuXG4gICAgICBjb25zdCBhcmdzID0gY21kLl9oZWxwQ29tbWFuZG5hbWVBbmRBcmdzLnNwbGl0KC8gKy8pO1xuICAgICAgY29uc3QgaGVscENvbW1hbmQgPSBjbWQuY3JlYXRlQ29tbWFuZChhcmdzLnNoaWZ0KCkpXG4gICAgICAgIC5oZWxwT3B0aW9uKGZhbHNlKTtcbiAgICAgIGhlbHBDb21tYW5kLmRlc2NyaXB0aW9uKGNtZC5faGVscENvbW1hbmREZXNjcmlwdGlvbik7XG4gICAgICBoZWxwQ29tbWFuZC5fcGFyc2VFeHBlY3RlZEFyZ3MoYXJncyk7XG4gICAgICB2aXNpYmxlQ29tbWFuZHMucHVzaChoZWxwQ29tbWFuZCk7XG4gICAgfVxuICAgIGlmICh0aGlzLnNvcnRTdWJjb21tYW5kcykge1xuICAgICAgdmlzaWJsZUNvbW1hbmRzLnNvcnQoKGEsIGIpID0+IHtcbiAgICAgICAgcmV0dXJuIGEubmFtZSgpLmxvY2FsZUNvbXBhcmUoYi5uYW1lKCkpO1xuICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiB2aXNpYmxlQ29tbWFuZHM7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGFuIGFycmF5IG9mIHRoZSB2aXNpYmxlIG9wdGlvbnMuIEluY2x1ZGVzIGEgcGxhY2Vob2xkZXIgZm9yIHRoZSBpbXBsaWNpdCBoZWxwIG9wdGlvbiwgaWYgdGhlcmUgaXMgb25lLlxuICAgKlxuICAgKiBAcGFyYW0ge0NvbW1hbmR9IGNtZFxuICAgKiBAcmV0dXJucyB7T3B0aW9uW119XG4gICAqL1xuXG4gIHZpc2libGVPcHRpb25zKGNtZCkge1xuICAgIGNvbnN0IHZpc2libGVPcHRpb25zID0gY21kLm9wdGlvbnMuZmlsdGVyKChvcHRpb24pID0+ICFvcHRpb24uaGlkZGVuKTtcbiAgICAvLyBJbXBsaWNpdCBoZWxwXG4gICAgY29uc3Qgc2hvd1Nob3J0SGVscEZsYWcgPSBjbWQuX2hhc0hlbHBPcHRpb24gJiYgY21kLl9oZWxwU2hvcnRGbGFnICYmICFjbWQuX2ZpbmRPcHRpb24oY21kLl9oZWxwU2hvcnRGbGFnKTtcbiAgICBjb25zdCBzaG93TG9uZ0hlbHBGbGFnID0gY21kLl9oYXNIZWxwT3B0aW9uICYmICFjbWQuX2ZpbmRPcHRpb24oY21kLl9oZWxwTG9uZ0ZsYWcpO1xuICAgIGlmIChzaG93U2hvcnRIZWxwRmxhZyB8fCBzaG93TG9uZ0hlbHBGbGFnKSB7XG4gICAgICBsZXQgaGVscE9wdGlvbjtcbiAgICAgIGlmICghc2hvd1Nob3J0SGVscEZsYWcpIHtcbiAgICAgICAgaGVscE9wdGlvbiA9IGNtZC5jcmVhdGVPcHRpb24oY21kLl9oZWxwTG9uZ0ZsYWcsIGNtZC5faGVscERlc2NyaXB0aW9uKTtcbiAgICAgIH0gZWxzZSBpZiAoIXNob3dMb25nSGVscEZsYWcpIHtcbiAgICAgICAgaGVscE9wdGlvbiA9IGNtZC5jcmVhdGVPcHRpb24oY21kLl9oZWxwU2hvcnRGbGFnLCBjbWQuX2hlbHBEZXNjcmlwdGlvbik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBoZWxwT3B0aW9uID0gY21kLmNyZWF0ZU9wdGlvbihjbWQuX2hlbHBGbGFncywgY21kLl9oZWxwRGVzY3JpcHRpb24pO1xuICAgICAgfVxuICAgICAgdmlzaWJsZU9wdGlvbnMucHVzaChoZWxwT3B0aW9uKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuc29ydE9wdGlvbnMpIHtcbiAgICAgIGNvbnN0IGdldFNvcnRLZXkgPSAob3B0aW9uKSA9PiB7XG4gICAgICAgIC8vIFdZU0lXWUcgZm9yIG9yZGVyIGRpc3BsYXllZCBpbiBoZWxwIHdpdGggc2hvcnQgYmVmb3JlIGxvbmcsIG5vIHNwZWNpYWwgaGFuZGxpbmcgZm9yIG5lZ2F0ZWQuXG4gICAgICAgIHJldHVybiBvcHRpb24uc2hvcnQgPyBvcHRpb24uc2hvcnQucmVwbGFjZSgvXi0vLCAnJykgOiBvcHRpb24ubG9uZy5yZXBsYWNlKC9eLS0vLCAnJyk7XG4gICAgICB9O1xuICAgICAgdmlzaWJsZU9wdGlvbnMuc29ydCgoYSwgYikgPT4ge1xuICAgICAgICByZXR1cm4gZ2V0U29ydEtleShhKS5sb2NhbGVDb21wYXJlKGdldFNvcnRLZXkoYikpO1xuICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiB2aXNpYmxlT3B0aW9ucztcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgYW4gYXJyYXkgb2YgdGhlIGFyZ3VtZW50cyB3aGljaCBoYXZlIGRlc2NyaXB0aW9ucy5cbiAgICpcbiAgICogQHBhcmFtIHtDb21tYW5kfSBjbWRcbiAgICogQHJldHVybnMge3sgdGVybTogc3RyaW5nLCBkZXNjcmlwdGlvbjpzdHJpbmcgfVtdfVxuICAgKi9cblxuICB2aXNpYmxlQXJndW1lbnRzKGNtZCkge1xuICAgIGlmIChjbWQuX2FyZ3NEZXNjcmlwdGlvbiAmJiBjbWQuX2FyZ3MubGVuZ3RoKSB7XG4gICAgICByZXR1cm4gY21kLl9hcmdzLm1hcCgoYXJndW1lbnQpID0+IHtcbiAgICAgICAgcmV0dXJuIHsgdGVybTogYXJndW1lbnQubmFtZSwgZGVzY3JpcHRpb246IGNtZC5fYXJnc0Rlc2NyaXB0aW9uW2FyZ3VtZW50Lm5hbWVdIHx8ICcnIH07XG4gICAgICB9LCAwKTtcbiAgICB9XG4gICAgcmV0dXJuIFtdO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCB0aGUgY29tbWFuZCB0ZXJtIHRvIHNob3cgaW4gdGhlIGxpc3Qgb2Ygc3ViY29tbWFuZHMuXG4gICAqXG4gICAqIEBwYXJhbSB7Q29tbWFuZH0gY21kXG4gICAqIEByZXR1cm5zIHtzdHJpbmd9XG4gICAqL1xuXG4gIHN1YmNvbW1hbmRUZXJtKGNtZCkge1xuICAgIC8vIExlZ2FjeS4gSWdub3JlcyBjdXN0b20gdXNhZ2Ugc3RyaW5nLCBhbmQgbmVzdGVkIGNvbW1hbmRzLlxuICAgIGNvbnN0IGFyZ3MgPSBjbWQuX2FyZ3MubWFwKGFyZyA9PiBodW1hblJlYWRhYmxlQXJnTmFtZShhcmcpKS5qb2luKCcgJyk7XG4gICAgcmV0dXJuIGNtZC5fbmFtZSArXG4gICAgICAoY21kLl9hbGlhc2VzWzBdID8gJ3wnICsgY21kLl9hbGlhc2VzWzBdIDogJycpICtcbiAgICAgIChjbWQub3B0aW9ucy5sZW5ndGggPyAnIFtvcHRpb25zXScgOiAnJykgKyAvLyBzaW1wbGlzdGljIGNoZWNrIGZvciBub24taGVscCBvcHRpb25cbiAgICAgIChhcmdzID8gJyAnICsgYXJncyA6ICcnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgdGhlIG9wdGlvbiB0ZXJtIHRvIHNob3cgaW4gdGhlIGxpc3Qgb2Ygb3B0aW9ucy5cbiAgICpcbiAgICogQHBhcmFtIHtPcHRpb259IG9wdGlvblxuICAgKiBAcmV0dXJucyB7c3RyaW5nfVxuICAgKi9cblxuICBvcHRpb25UZXJtKG9wdGlvbikge1xuICAgIHJldHVybiBvcHRpb24uZmxhZ3M7XG4gIH1cblxuICAvKipcbiAgICogR2V0IHRoZSBsb25nZXN0IGNvbW1hbmQgdGVybSBsZW5ndGguXG4gICAqXG4gICAqIEBwYXJhbSB7Q29tbWFuZH0gY21kXG4gICAqIEBwYXJhbSB7SGVscH0gaGVscGVyXG4gICAqIEByZXR1cm5zIHtudW1iZXJ9XG4gICAqL1xuXG4gIGxvbmdlc3RTdWJjb21tYW5kVGVybUxlbmd0aChjbWQsIGhlbHBlcikge1xuICAgIHJldHVybiBoZWxwZXIudmlzaWJsZUNvbW1hbmRzKGNtZCkucmVkdWNlKChtYXgsIGNvbW1hbmQpID0+IHtcbiAgICAgIHJldHVybiBNYXRoLm1heChtYXgsIGhlbHBlci5zdWJjb21tYW5kVGVybShjb21tYW5kKS5sZW5ndGgpO1xuICAgIH0sIDApO1xuICB9O1xuXG4gIC8qKlxuICAgKiBHZXQgdGhlIGxvbmdlc3Qgb3B0aW9uIHRlcm0gbGVuZ3RoLlxuICAgKlxuICAgKiBAcGFyYW0ge0NvbW1hbmR9IGNtZFxuICAgKiBAcGFyYW0ge0hlbHB9IGhlbHBlclxuICAgKiBAcmV0dXJucyB7bnVtYmVyfVxuICAgKi9cblxuICBsb25nZXN0T3B0aW9uVGVybUxlbmd0aChjbWQsIGhlbHBlcikge1xuICAgIHJldHVybiBoZWxwZXIudmlzaWJsZU9wdGlvbnMoY21kKS5yZWR1Y2UoKG1heCwgb3B0aW9uKSA9PiB7XG4gICAgICByZXR1cm4gTWF0aC5tYXgobWF4LCBoZWxwZXIub3B0aW9uVGVybShvcHRpb24pLmxlbmd0aCk7XG4gICAgfSwgMCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEdldCB0aGUgbG9uZ2VzdCBhcmd1bWVudCB0ZXJtIGxlbmd0aC5cbiAgICpcbiAgICogQHBhcmFtIHtDb21tYW5kfSBjbWRcbiAgICogQHBhcmFtIHtIZWxwfSBoZWxwZXJcbiAgICogQHJldHVybnMge251bWJlcn1cbiAgICovXG5cbiAgbG9uZ2VzdEFyZ3VtZW50VGVybUxlbmd0aChjbWQsIGhlbHBlcikge1xuICAgIHJldHVybiBoZWxwZXIudmlzaWJsZUFyZ3VtZW50cyhjbWQpLnJlZHVjZSgobWF4LCBhcmd1bWVudCkgPT4ge1xuICAgICAgcmV0dXJuIE1hdGgubWF4KG1heCwgYXJndW1lbnQudGVybS5sZW5ndGgpO1xuICAgIH0sIDApO1xuICB9O1xuXG4gIC8qKlxuICAgKiBHZXQgdGhlIGNvbW1hbmQgdXNhZ2UgdG8gYmUgZGlzcGxheWVkIGF0IHRoZSB0b3Agb2YgdGhlIGJ1aWx0LWluIGhlbHAuXG4gICAqXG4gICAqIEBwYXJhbSB7Q29tbWFuZH0gY21kXG4gICAqIEByZXR1cm5zIHtzdHJpbmd9XG4gICAqL1xuXG4gIGNvbW1hbmRVc2FnZShjbWQpIHtcbiAgICAvLyBVc2FnZVxuICAgIGxldCBjbWROYW1lID0gY21kLl9uYW1lO1xuICAgIGlmIChjbWQuX2FsaWFzZXNbMF0pIHtcbiAgICAgIGNtZE5hbWUgPSBjbWROYW1lICsgJ3wnICsgY21kLl9hbGlhc2VzWzBdO1xuICAgIH1cbiAgICBsZXQgcGFyZW50Q21kTmFtZXMgPSAnJztcbiAgICBmb3IgKGxldCBwYXJlbnRDbWQgPSBjbWQucGFyZW50OyBwYXJlbnRDbWQ7IHBhcmVudENtZCA9IHBhcmVudENtZC5wYXJlbnQpIHtcbiAgICAgIHBhcmVudENtZE5hbWVzID0gcGFyZW50Q21kLm5hbWUoKSArICcgJyArIHBhcmVudENtZE5hbWVzO1xuICAgIH1cbiAgICByZXR1cm4gcGFyZW50Q21kTmFtZXMgKyBjbWROYW1lICsgJyAnICsgY21kLnVzYWdlKCk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IHRoZSBkZXNjcmlwdGlvbiBmb3IgdGhlIGNvbW1hbmQuXG4gICAqXG4gICAqIEBwYXJhbSB7Q29tbWFuZH0gY21kXG4gICAqIEByZXR1cm5zIHtzdHJpbmd9XG4gICAqL1xuXG4gIGNvbW1hbmREZXNjcmlwdGlvbihjbWQpIHtcbiAgICAvLyBAdHMtaWdub3JlOiBvdmVybG9hZGVkIHJldHVybiB0eXBlXG4gICAgcmV0dXJuIGNtZC5kZXNjcmlwdGlvbigpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCB0aGUgY29tbWFuZCBkZXNjcmlwdGlvbiB0byBzaG93IGluIHRoZSBsaXN0IG9mIHN1YmNvbW1hbmRzLlxuICAgKlxuICAgKiBAcGFyYW0ge0NvbW1hbmR9IGNtZFxuICAgKiBAcmV0dXJucyB7c3RyaW5nfVxuICAgKi9cblxuICBzdWJjb21tYW5kRGVzY3JpcHRpb24oY21kKSB7XG4gICAgLy8gQHRzLWlnbm9yZTogb3ZlcmxvYWRlZCByZXR1cm4gdHlwZVxuICAgIHJldHVybiBjbWQuZGVzY3JpcHRpb24oKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgdGhlIG9wdGlvbiBkZXNjcmlwdGlvbiB0byBzaG93IGluIHRoZSBsaXN0IG9mIG9wdGlvbnMuXG4gICAqXG4gICAqIEBwYXJhbSB7T3B0aW9ufSBvcHRpb25cbiAgICogQHJldHVybiB7c3RyaW5nfVxuICAgKi9cblxuICBvcHRpb25EZXNjcmlwdGlvbihvcHRpb24pIHtcbiAgICBpZiAob3B0aW9uLm5lZ2F0ZSkge1xuICAgICAgcmV0dXJuIG9wdGlvbi5kZXNjcmlwdGlvbjtcbiAgICB9XG4gICAgY29uc3QgZXh0cmFJbmZvID0gW107XG4gICAgaWYgKG9wdGlvbi5hcmdDaG9pY2VzKSB7XG4gICAgICBleHRyYUluZm8ucHVzaChcbiAgICAgICAgLy8gdXNlIHN0cmluZ2lmeSB0byBtYXRjaCB0aGUgZGlzcGxheSBvZiB0aGUgZGVmYXVsdCB2YWx1ZVxuICAgICAgICBgY2hvaWNlczogJHtvcHRpb24uYXJnQ2hvaWNlcy5tYXAoKGNob2ljZSkgPT4gSlNPTi5zdHJpbmdpZnkoY2hvaWNlKSkuam9pbignLCAnKX1gKTtcbiAgICB9XG4gICAgaWYgKG9wdGlvbi5kZWZhdWx0VmFsdWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgZXh0cmFJbmZvLnB1c2goYGRlZmF1bHQ6ICR7b3B0aW9uLmRlZmF1bHRWYWx1ZURlc2NyaXB0aW9uIHx8IEpTT04uc3RyaW5naWZ5KG9wdGlvbi5kZWZhdWx0VmFsdWUpfWApO1xuICAgIH1cbiAgICBpZiAoZXh0cmFJbmZvLmxlbmd0aCA+IDApIHtcbiAgICAgIHJldHVybiBgJHtvcHRpb24uZGVzY3JpcHRpb259ICgke2V4dHJhSW5mby5qb2luKCcsICcpfSlgO1xuICAgIH1cbiAgICByZXR1cm4gb3B0aW9uLmRlc2NyaXB0aW9uO1xuICB9O1xuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZSB0aGUgYnVpbHQtaW4gaGVscCB0ZXh0LlxuICAgKlxuICAgKiBAcGFyYW0ge0NvbW1hbmR9IGNtZFxuICAgKiBAcGFyYW0ge0hlbHB9IGhlbHBlclxuICAgKiBAcmV0dXJucyB7c3RyaW5nfVxuICAgKi9cblxuICBmb3JtYXRIZWxwKGNtZCwgaGVscGVyKSB7XG4gICAgY29uc3QgdGVybVdpZHRoID0gaGVscGVyLnBhZFdpZHRoKGNtZCwgaGVscGVyKTtcbiAgICBjb25zdCBoZWxwV2lkdGggPSBoZWxwZXIuaGVscFdpZHRoIHx8IDgwO1xuICAgIGNvbnN0IGl0ZW1JbmRlbnRXaWR0aCA9IDI7XG4gICAgY29uc3QgaXRlbVNlcGFyYXRvcldpZHRoID0gMjsgLy8gYmV0d2VlbiB0ZXJtIGFuZCBkZXNjcmlwdGlvblxuICAgIGZ1bmN0aW9uIGZvcm1hdEl0ZW0odGVybSwgZGVzY3JpcHRpb24pIHtcbiAgICAgIGlmIChkZXNjcmlwdGlvbikge1xuICAgICAgICBjb25zdCBmdWxsVGV4dCA9IGAke3Rlcm0ucGFkRW5kKHRlcm1XaWR0aCArIGl0ZW1TZXBhcmF0b3JXaWR0aCl9JHtkZXNjcmlwdGlvbn1gO1xuICAgICAgICByZXR1cm4gaGVscGVyLndyYXAoZnVsbFRleHQsIGhlbHBXaWR0aCAtIGl0ZW1JbmRlbnRXaWR0aCwgdGVybVdpZHRoICsgaXRlbVNlcGFyYXRvcldpZHRoKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0ZXJtO1xuICAgIH07XG4gICAgZnVuY3Rpb24gZm9ybWF0TGlzdCh0ZXh0QXJyYXkpIHtcbiAgICAgIHJldHVybiB0ZXh0QXJyYXkuam9pbignXFxuJykucmVwbGFjZSgvXi9nbSwgJyAnLnJlcGVhdChpdGVtSW5kZW50V2lkdGgpKTtcbiAgICB9XG5cbiAgICAvLyBVc2FnZVxuICAgIGxldCBvdXRwdXQgPSBbYFVzYWdlOiAke2hlbHBlci5jb21tYW5kVXNhZ2UoY21kKX1gLCAnJ107XG5cbiAgICAvLyBEZXNjcmlwdGlvblxuICAgIGNvbnN0IGNvbW1hbmREZXNjcmlwdGlvbiA9IGhlbHBlci5jb21tYW5kRGVzY3JpcHRpb24oY21kKTtcbiAgICBpZiAoY29tbWFuZERlc2NyaXB0aW9uLmxlbmd0aCA+IDApIHtcbiAgICAgIG91dHB1dCA9IG91dHB1dC5jb25jYXQoW2NvbW1hbmREZXNjcmlwdGlvbiwgJyddKTtcbiAgICB9XG5cbiAgICAvLyBBcmd1bWVudHNcbiAgICBjb25zdCBhcmd1bWVudExpc3QgPSBoZWxwZXIudmlzaWJsZUFyZ3VtZW50cyhjbWQpLm1hcCgoYXJndW1lbnQpID0+IHtcbiAgICAgIHJldHVybiBmb3JtYXRJdGVtKGFyZ3VtZW50LnRlcm0sIGFyZ3VtZW50LmRlc2NyaXB0aW9uKTtcbiAgICB9KTtcbiAgICBpZiAoYXJndW1lbnRMaXN0Lmxlbmd0aCA+IDApIHtcbiAgICAgIG91dHB1dCA9IG91dHB1dC5jb25jYXQoWydBcmd1bWVudHM6JywgZm9ybWF0TGlzdChhcmd1bWVudExpc3QpLCAnJ10pO1xuICAgIH1cblxuICAgIC8vIE9wdGlvbnNcbiAgICBjb25zdCBvcHRpb25MaXN0ID0gaGVscGVyLnZpc2libGVPcHRpb25zKGNtZCkubWFwKChvcHRpb24pID0+IHtcbiAgICAgIHJldHVybiBmb3JtYXRJdGVtKGhlbHBlci5vcHRpb25UZXJtKG9wdGlvbiksIGhlbHBlci5vcHRpb25EZXNjcmlwdGlvbihvcHRpb24pKTtcbiAgICB9KTtcbiAgICBpZiAob3B0aW9uTGlzdC5sZW5ndGggPiAwKSB7XG4gICAgICBvdXRwdXQgPSBvdXRwdXQuY29uY2F0KFsnT3B0aW9uczonLCBmb3JtYXRMaXN0KG9wdGlvbkxpc3QpLCAnJ10pO1xuICAgIH1cblxuICAgIC8vIENvbW1hbmRzXG4gICAgY29uc3QgY29tbWFuZExpc3QgPSBoZWxwZXIudmlzaWJsZUNvbW1hbmRzKGNtZCkubWFwKChjbWQpID0+IHtcbiAgICAgIHJldHVybiBmb3JtYXRJdGVtKGhlbHBlci5zdWJjb21tYW5kVGVybShjbWQpLCBoZWxwZXIuc3ViY29tbWFuZERlc2NyaXB0aW9uKGNtZCkpO1xuICAgIH0pO1xuICAgIGlmIChjb21tYW5kTGlzdC5sZW5ndGggPiAwKSB7XG4gICAgICBvdXRwdXQgPSBvdXRwdXQuY29uY2F0KFsnQ29tbWFuZHM6JywgZm9ybWF0TGlzdChjb21tYW5kTGlzdCksICcnXSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIG91dHB1dC5qb2luKCdcXG4nKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxjdWxhdGUgdGhlIHBhZCB3aWR0aCBmcm9tIHRoZSBtYXhpbXVtIHRlcm0gbGVuZ3RoLlxuICAgKlxuICAgKiBAcGFyYW0ge0NvbW1hbmR9IGNtZFxuICAgKiBAcGFyYW0ge0hlbHB9IGhlbHBlclxuICAgKiBAcmV0dXJucyB7bnVtYmVyfVxuICAgKi9cblxuICBwYWRXaWR0aChjbWQsIGhlbHBlcikge1xuICAgIHJldHVybiBNYXRoLm1heChcbiAgICAgIGhlbHBlci5sb25nZXN0T3B0aW9uVGVybUxlbmd0aChjbWQsIGhlbHBlciksXG4gICAgICBoZWxwZXIubG9uZ2VzdFN1YmNvbW1hbmRUZXJtTGVuZ3RoKGNtZCwgaGVscGVyKSxcbiAgICAgIGhlbHBlci5sb25nZXN0QXJndW1lbnRUZXJtTGVuZ3RoKGNtZCwgaGVscGVyKVxuICAgICk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFdyYXAgdGhlIGdpdmVuIHN0cmluZyB0byB3aWR0aCBjaGFyYWN0ZXJzIHBlciBsaW5lLCB3aXRoIGxpbmVzIGFmdGVyIHRoZSBmaXJzdCBpbmRlbnRlZC5cbiAgICogRG8gbm90IHdyYXAgaWYgaW5zdWZmaWNpZW50IHJvb20gZm9yIHdyYXBwaW5nIChtaW5Db2x1bW5XaWR0aCksIG9yIHN0cmluZyBpcyBtYW51YWxseSBmb3JtYXR0ZWQuXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBzdHJcbiAgICogQHBhcmFtIHtudW1iZXJ9IHdpZHRoXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBpbmRlbnRcbiAgICogQHBhcmFtIHtudW1iZXJ9IFttaW5Db2x1bW5XaWR0aD00MF1cbiAgICogQHJldHVybiB7c3RyaW5nfVxuICAgKlxuICAgKi9cblxuICB3cmFwKHN0ciwgd2lkdGgsIGluZGVudCwgbWluQ29sdW1uV2lkdGggPSA0MCkge1xuICAgIC8vIERldGVjdCBtYW51YWxseSB3cmFwcGVkIGFuZCBpbmRlbnRlZCBzdHJpbmdzIGJ5IHNlYXJjaGluZyBmb3IgbGluZSBicmVha3NcbiAgICAvLyBmb2xsb3dlZCBieSBtdWx0aXBsZSBzcGFjZXMvdGFicy5cbiAgICBpZiAoc3RyLm1hdGNoKC9bXFxuXVxccysvKSkgcmV0dXJuIHN0cjtcbiAgICAvLyBEbyBub3Qgd3JhcCBpZiBub3QgZW5vdWdoIHJvb20gZm9yIGEgd3JhcHBlZCBjb2x1bW4gb2YgdGV4dCAoYXMgY291bGQgZW5kIHVwIHdpdGggYSB3b3JkIHBlciBsaW5lKS5cbiAgICBjb25zdCBjb2x1bW5XaWR0aCA9IHdpZHRoIC0gaW5kZW50O1xuICAgIGlmIChjb2x1bW5XaWR0aCA8IG1pbkNvbHVtbldpZHRoKSByZXR1cm4gc3RyO1xuXG4gICAgY29uc3QgbGVhZGluZ1N0ciA9IHN0ci5zdWJzdHIoMCwgaW5kZW50KTtcbiAgICBjb25zdCBjb2x1bW5UZXh0ID0gc3RyLnN1YnN0cihpbmRlbnQpO1xuXG4gICAgY29uc3QgaW5kZW50U3RyaW5nID0gJyAnLnJlcGVhdChpbmRlbnQpO1xuICAgIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cCgnLnsxLCcgKyAoY29sdW1uV2lkdGggLSAxKSArICd9KFtcXFxcc1xcdTIwMEJdfCQpfFteXFxcXHNcXHUyMDBCXSs/KFtcXFxcc1xcdTIwMEJdfCQpJywgJ2cnKTtcbiAgICBjb25zdCBsaW5lcyA9IGNvbHVtblRleHQubWF0Y2gocmVnZXgpIHx8IFtdO1xuICAgIHJldHVybiBsZWFkaW5nU3RyICsgbGluZXMubWFwKChsaW5lLCBpKSA9PiB7XG4gICAgICBpZiAobGluZS5zbGljZSgtMSkgPT09ICdcXG4nKSB7XG4gICAgICAgIGxpbmUgPSBsaW5lLnNsaWNlKDAsIGxpbmUubGVuZ3RoIC0gMSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gKChpID4gMCkgPyBpbmRlbnRTdHJpbmcgOiAnJykgKyBsaW5lLnRyaW1SaWdodCgpO1xuICAgIH0pLmpvaW4oJ1xcbicpO1xuICB9XG59XG5cbmNsYXNzIE9wdGlvbiB7XG4gIC8qKlxuICAgKiBJbml0aWFsaXplIGEgbmV3IGBPcHRpb25gIHdpdGggdGhlIGdpdmVuIGBmbGFnc2AgYW5kIGBkZXNjcmlwdGlvbmAuXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBmbGFnc1xuICAgKiBAcGFyYW0ge3N0cmluZ30gW2Rlc2NyaXB0aW9uXVxuICAgKi9cblxuICBjb25zdHJ1Y3RvcihmbGFncywgZGVzY3JpcHRpb24pIHtcbiAgICB0aGlzLmZsYWdzID0gZmxhZ3M7XG4gICAgdGhpcy5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uIHx8ICcnO1xuXG4gICAgdGhpcy5yZXF1aXJlZCA9IGZsYWdzLmluY2x1ZGVzKCc8Jyk7IC8vIEEgdmFsdWUgbXVzdCBiZSBzdXBwbGllZCB3aGVuIHRoZSBvcHRpb24gaXMgc3BlY2lmaWVkLlxuICAgIHRoaXMub3B0aW9uYWwgPSBmbGFncy5pbmNsdWRlcygnWycpOyAvLyBBIHZhbHVlIGlzIG9wdGlvbmFsIHdoZW4gdGhlIG9wdGlvbiBpcyBzcGVjaWZpZWQuXG4gICAgLy8gdmFyaWFkaWMgdGVzdCBpZ25vcmVzIDx2YWx1ZSwuLi4+IGV0IGFsIHdoaWNoIG1pZ2h0IGJlIHVzZWQgdG8gZGVzY3JpYmUgY3VzdG9tIHNwbGl0dGluZyBvZiBzaW5nbGUgYXJndW1lbnRcbiAgICB0aGlzLnZhcmlhZGljID0gL1xcd1xcLlxcLlxcLls+XFxdXSQvLnRlc3QoZmxhZ3MpOyAvLyBUaGUgb3B0aW9uIGNhbiB0YWtlIG11bHRpcGxlIHZhbHVlcy5cbiAgICB0aGlzLm1hbmRhdG9yeSA9IGZhbHNlOyAvLyBUaGUgb3B0aW9uIG11c3QgaGF2ZSBhIHZhbHVlIGFmdGVyIHBhcnNpbmcsIHdoaWNoIHVzdWFsbHkgbWVhbnMgaXQgbXVzdCBiZSBzcGVjaWZpZWQgb24gY29tbWFuZCBsaW5lLlxuICAgIGNvbnN0IG9wdGlvbkZsYWdzID0gX3BhcnNlT3B0aW9uRmxhZ3MoZmxhZ3MpO1xuICAgIHRoaXMuc2hvcnQgPSBvcHRpb25GbGFncy5zaG9ydEZsYWc7XG4gICAgdGhpcy5sb25nID0gb3B0aW9uRmxhZ3MubG9uZ0ZsYWc7XG4gICAgdGhpcy5uZWdhdGUgPSBmYWxzZTtcbiAgICBpZiAodGhpcy5sb25nKSB7XG4gICAgICB0aGlzLm5lZ2F0ZSA9IHRoaXMubG9uZy5zdGFydHNXaXRoKCctLW5vLScpO1xuICAgIH1cbiAgICB0aGlzLmRlZmF1bHRWYWx1ZSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLmRlZmF1bHRWYWx1ZURlc2NyaXB0aW9uID0gdW5kZWZpbmVkO1xuICAgIHRoaXMucGFyc2VBcmcgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5oaWRkZW4gPSBmYWxzZTtcbiAgICB0aGlzLmFyZ0Nob2ljZXMgPSB1bmRlZmluZWQ7XG4gIH1cblxuICAvKipcbiAgICogU2V0IHRoZSBkZWZhdWx0IHZhbHVlLCBhbmQgb3B0aW9uYWxseSBzdXBwbHkgdGhlIGRlc2NyaXB0aW9uIHRvIGJlIGRpc3BsYXllZCBpbiB0aGUgaGVscC5cbiAgICpcbiAgICogQHBhcmFtIHthbnl9IHZhbHVlXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBbZGVzY3JpcHRpb25dXG4gICAqIEByZXR1cm4ge09wdGlvbn1cbiAgICovXG5cbiAgZGVmYXVsdCh2YWx1ZSwgZGVzY3JpcHRpb24pIHtcbiAgICB0aGlzLmRlZmF1bHRWYWx1ZSA9IHZhbHVlO1xuICAgIHRoaXMuZGVmYXVsdFZhbHVlRGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICAvKipcbiAgICogU2V0IHRoZSBjdXN0b20gaGFuZGxlciBmb3IgcHJvY2Vzc2luZyBDTEkgb3B0aW9uIGFyZ3VtZW50cyBpbnRvIG9wdGlvbiB2YWx1ZXMuXG4gICAqXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IFtmbl1cbiAgICogQHJldHVybiB7T3B0aW9ufVxuICAgKi9cblxuICBhcmdQYXJzZXIoZm4pIHtcbiAgICB0aGlzLnBhcnNlQXJnID0gZm47XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIFdoZXRoZXIgdGhlIG9wdGlvbiBpcyBtYW5kYXRvcnkgYW5kIG11c3QgaGF2ZSBhIHZhbHVlIGFmdGVyIHBhcnNpbmcuXG4gICAqXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gW21hbmRhdG9yeT10cnVlXVxuICAgKiBAcmV0dXJuIHtPcHRpb259XG4gICAqL1xuXG4gIG1ha2VPcHRpb25NYW5kYXRvcnkobWFuZGF0b3J5ID0gdHJ1ZSkge1xuICAgIHRoaXMubWFuZGF0b3J5ID0gISFtYW5kYXRvcnk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIEhpZGUgb3B0aW9uIGluIGhlbHAuXG4gICAqXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2hpZGU9dHJ1ZV1cbiAgICogQHJldHVybiB7T3B0aW9ufVxuICAgKi9cblxuICBoaWRlSGVscChoaWRlID0gdHJ1ZSkge1xuICAgIHRoaXMuaGlkZGVuID0gISFoaWRlO1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIC8qKlxuICAgKiBAYXBpIHByaXZhdGVcbiAgICovXG5cbiAgX2NvbmNhdFZhbHVlKHZhbHVlLCBwcmV2aW91cykge1xuICAgIGlmIChwcmV2aW91cyA9PT0gdGhpcy5kZWZhdWx0VmFsdWUgfHwgIUFycmF5LmlzQXJyYXkocHJldmlvdXMpKSB7XG4gICAgICByZXR1cm4gW3ZhbHVlXTtcbiAgICB9XG5cbiAgICByZXR1cm4gcHJldmlvdXMuY29uY2F0KHZhbHVlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBPbmx5IGFsbG93IG9wdGlvbiB2YWx1ZSB0byBiZSBvbmUgb2YgY2hvaWNlcy5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmdbXX0gdmFsdWVzXG4gICAqIEByZXR1cm4ge09wdGlvbn1cbiAgICovXG5cbiAgY2hvaWNlcyh2YWx1ZXMpIHtcbiAgICB0aGlzLmFyZ0Nob2ljZXMgPSB2YWx1ZXM7XG4gICAgdGhpcy5wYXJzZUFyZyA9IChhcmcsIHByZXZpb3VzKSA9PiB7XG4gICAgICBpZiAoIXZhbHVlcy5pbmNsdWRlcyhhcmcpKSB7XG4gICAgICAgIHRocm93IG5ldyBJbnZhbGlkT3B0aW9uQXJndW1lbnRFcnJvcihgQWxsb3dlZCBjaG9pY2VzIGFyZSAke3ZhbHVlcy5qb2luKCcsICcpfS5gKTtcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLnZhcmlhZGljKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jb25jYXRWYWx1ZShhcmcsIHByZXZpb3VzKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBhcmc7XG4gICAgfTtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICAvKipcbiAgICogUmV0dXJuIG9wdGlvbiBuYW1lLlxuICAgKlxuICAgKiBAcmV0dXJuIHtzdHJpbmd9XG4gICAqL1xuXG4gIG5hbWUoKSB7XG4gICAgaWYgKHRoaXMubG9uZykge1xuICAgICAgcmV0dXJuIHRoaXMubG9uZy5yZXBsYWNlKC9eLS0vLCAnJyk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLnNob3J0LnJlcGxhY2UoL14tLywgJycpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBSZXR1cm4gb3B0aW9uIG5hbWUsIGluIGEgY2FtZWxjYXNlIGZvcm1hdCB0aGF0IGNhbiBiZSB1c2VkXG4gICAqIGFzIGEgb2JqZWN0IGF0dHJpYnV0ZSBrZXkuXG4gICAqXG4gICAqIEByZXR1cm4ge3N0cmluZ31cbiAgICogQGFwaSBwcml2YXRlXG4gICAqL1xuXG4gIGF0dHJpYnV0ZU5hbWUoKSB7XG4gICAgcmV0dXJuIGNhbWVsY2FzZSh0aGlzLm5hbWUoKS5yZXBsYWNlKC9ebm8tLywgJycpKTtcbiAgfTtcblxuICAvKipcbiAgICogQ2hlY2sgaWYgYGFyZ2AgbWF0Y2hlcyB0aGUgc2hvcnQgb3IgbG9uZyBmbGFnLlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gYXJnXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAqIEBhcGkgcHJpdmF0ZVxuICAgKi9cblxuICBpcyhhcmcpIHtcbiAgICByZXR1cm4gdGhpcy5zaG9ydCA9PT0gYXJnIHx8IHRoaXMubG9uZyA9PT0gYXJnO1xuICB9O1xufVxuXG4vKipcbiAqIENvbW1hbmRlckVycm9yIGNsYXNzXG4gKiBAY2xhc3NcbiAqL1xuY2xhc3MgQ29tbWFuZGVyRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gIC8qKlxuICAgKiBDb25zdHJ1Y3RzIHRoZSBDb21tYW5kZXJFcnJvciBjbGFzc1xuICAgKiBAcGFyYW0ge251bWJlcn0gZXhpdENvZGUgc3VnZ2VzdGVkIGV4aXQgY29kZSB3aGljaCBjb3VsZCBiZSB1c2VkIHdpdGggcHJvY2Vzcy5leGl0XG4gICAqIEBwYXJhbSB7c3RyaW5nfSBjb2RlIGFuIGlkIHN0cmluZyByZXByZXNlbnRpbmcgdGhlIGVycm9yXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBtZXNzYWdlIGh1bWFuLXJlYWRhYmxlIGRlc2NyaXB0aW9uIG9mIHRoZSBlcnJvclxuICAgKiBAY29uc3RydWN0b3JcbiAgICovXG4gIGNvbnN0cnVjdG9yKGV4aXRDb2RlLCBjb2RlLCBtZXNzYWdlKSB7XG4gICAgc3VwZXIobWVzc2FnZSk7XG4gICAgLy8gcHJvcGVybHkgY2FwdHVyZSBzdGFjayB0cmFjZSBpbiBOb2RlLmpzXG4gICAgRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UodGhpcywgdGhpcy5jb25zdHJ1Y3Rvcik7XG4gICAgdGhpcy5uYW1lID0gdGhpcy5jb25zdHJ1Y3Rvci5uYW1lO1xuICAgIHRoaXMuY29kZSA9IGNvZGU7XG4gICAgdGhpcy5leGl0Q29kZSA9IGV4aXRDb2RlO1xuICAgIHRoaXMubmVzdGVkRXJyb3IgPSB1bmRlZmluZWQ7XG4gIH1cbn1cblxuLyoqXG4gKiBJbnZhbGlkT3B0aW9uQXJndW1lbnRFcnJvciBjbGFzc1xuICogQGNsYXNzXG4gKi9cbmNsYXNzIEludmFsaWRPcHRpb25Bcmd1bWVudEVycm9yIGV4dGVuZHMgQ29tbWFuZGVyRXJyb3Ige1xuICAvKipcbiAgICogQ29uc3RydWN0cyB0aGUgSW52YWxpZE9wdGlvbkFyZ3VtZW50RXJyb3IgY2xhc3NcbiAgICogQHBhcmFtIHtzdHJpbmd9IFttZXNzYWdlXSBleHBsYW5hdGlvbiBvZiB3aHkgYXJndW1lbnQgaXMgaW52YWxpZFxuICAgKiBAY29uc3RydWN0b3JcbiAgICovXG4gIGNvbnN0cnVjdG9yKG1lc3NhZ2UpIHtcbiAgICBzdXBlcigxLCAnY29tbWFuZGVyLmludmFsaWRPcHRpb25Bcmd1bWVudCcsIG1lc3NhZ2UpO1xuICAgIC8vIHByb3Blcmx5IGNhcHR1cmUgc3RhY2sgdHJhY2UgaW4gTm9kZS5qc1xuICAgIEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKHRoaXMsIHRoaXMuY29uc3RydWN0b3IpO1xuICAgIHRoaXMubmFtZSA9IHRoaXMuY29uc3RydWN0b3IubmFtZTtcbiAgfVxufVxuXG5jbGFzcyBDb21tYW5kIGV4dGVuZHMgRXZlbnRFbWl0dGVyIHtcbiAgLyoqXG4gICAqIEluaXRpYWxpemUgYSBuZXcgYENvbW1hbmRgLlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gW25hbWVdXG4gICAqL1xuXG4gIGNvbnN0cnVjdG9yKG5hbWUpIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMuY29tbWFuZHMgPSBbXTtcbiAgICB0aGlzLm9wdGlvbnMgPSBbXTtcbiAgICB0aGlzLnBhcmVudCA9IG51bGw7XG4gICAgdGhpcy5fYWxsb3dVbmtub3duT3B0aW9uID0gZmFsc2U7XG4gICAgdGhpcy5fYWxsb3dFeGNlc3NBcmd1bWVudHMgPSB0cnVlO1xuICAgIHRoaXMuX2FyZ3MgPSBbXTtcbiAgICB0aGlzLnJhd0FyZ3MgPSBudWxsO1xuICAgIHRoaXMuX3NjcmlwdFBhdGggPSBudWxsO1xuICAgIHRoaXMuX25hbWUgPSBuYW1lIHx8ICcnO1xuICAgIHRoaXMuX29wdGlvblZhbHVlcyA9IHt9O1xuICAgIHRoaXMuX3N0b3JlT3B0aW9uc0FzUHJvcGVydGllcyA9IGZhbHNlO1xuICAgIHRoaXMuX2FjdGlvblJlc3VsdHMgPSBbXTtcbiAgICB0aGlzLl9hY3Rpb25IYW5kbGVyID0gbnVsbDtcbiAgICB0aGlzLl9leGVjdXRhYmxlSGFuZGxlciA9IGZhbHNlO1xuICAgIHRoaXMuX2V4ZWN1dGFibGVGaWxlID0gbnVsbDsgLy8gY3VzdG9tIG5hbWUgZm9yIGV4ZWN1dGFibGVcbiAgICB0aGlzLl9kZWZhdWx0Q29tbWFuZE5hbWUgPSBudWxsO1xuICAgIHRoaXMuX2V4aXRDYWxsYmFjayA9IG51bGw7XG4gICAgdGhpcy5fYWxpYXNlcyA9IFtdO1xuICAgIHRoaXMuX2NvbWJpbmVGbGFnQW5kT3B0aW9uYWxWYWx1ZSA9IHRydWU7XG4gICAgdGhpcy5fZGVzY3JpcHRpb24gPSAnJztcbiAgICB0aGlzLl9hcmdzRGVzY3JpcHRpb24gPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5fZW5hYmxlUG9zaXRpb25hbE9wdGlvbnMgPSBmYWxzZTtcbiAgICB0aGlzLl9wYXNzVGhyb3VnaE9wdGlvbnMgPSBmYWxzZTtcblxuICAgIC8vIHNlZSAuY29uZmlndXJlT3V0cHV0KCkgZm9yIGRvY3NcbiAgICB0aGlzLl9vdXRwdXRDb25maWd1cmF0aW9uID0ge1xuICAgICAgd3JpdGVPdXQ6IChzdHIpID0+IHByb2Nlc3Muc3Rkb3V0LndyaXRlKHN0ciksXG4gICAgICB3cml0ZUVycjogKHN0cikgPT4gcHJvY2Vzcy5zdGRlcnIud3JpdGUoc3RyKSxcbiAgICAgIGdldE91dEhlbHBXaWR0aDogKCkgPT4gcHJvY2Vzcy5zdGRvdXQuaXNUVFkgPyBwcm9jZXNzLnN0ZG91dC5jb2x1bW5zIDogdW5kZWZpbmVkLFxuICAgICAgZ2V0RXJySGVscFdpZHRoOiAoKSA9PiBwcm9jZXNzLnN0ZGVyci5pc1RUWSA/IHByb2Nlc3Muc3RkZXJyLmNvbHVtbnMgOiB1bmRlZmluZWQsXG4gICAgICBvdXRwdXRFcnJvcjogKHN0ciwgd3JpdGUpID0+IHdyaXRlKHN0cilcbiAgICB9O1xuXG4gICAgdGhpcy5faGlkZGVuID0gZmFsc2U7XG4gICAgdGhpcy5faGFzSGVscE9wdGlvbiA9IHRydWU7XG4gICAgdGhpcy5faGVscEZsYWdzID0gJy1oLCAtLWhlbHAnO1xuICAgIHRoaXMuX2hlbHBEZXNjcmlwdGlvbiA9ICdkaXNwbGF5IGhlbHAgZm9yIGNvbW1hbmQnO1xuICAgIHRoaXMuX2hlbHBTaG9ydEZsYWcgPSAnLWgnO1xuICAgIHRoaXMuX2hlbHBMb25nRmxhZyA9ICctLWhlbHAnO1xuICAgIHRoaXMuX2FkZEltcGxpY2l0SGVscENvbW1hbmQgPSB1bmRlZmluZWQ7IC8vIERlbGliZXJhdGVseSB1bmRlZmluZWQsIG5vdCBkZWNpZGVkIHdoZXRoZXIgdHJ1ZSBvciBmYWxzZVxuICAgIHRoaXMuX2hlbHBDb21tYW5kTmFtZSA9ICdoZWxwJztcbiAgICB0aGlzLl9oZWxwQ29tbWFuZG5hbWVBbmRBcmdzID0gJ2hlbHAgW2NvbW1hbmRdJztcbiAgICB0aGlzLl9oZWxwQ29tbWFuZERlc2NyaXB0aW9uID0gJ2Rpc3BsYXkgaGVscCBmb3IgY29tbWFuZCc7XG4gICAgdGhpcy5faGVscENvbmZpZ3VyYXRpb24gPSB7fTtcbiAgfVxuXG4gIC8qKlxuICAgKiBEZWZpbmUgYSBjb21tYW5kLlxuICAgKlxuICAgKiBUaGVyZSBhcmUgdHdvIHN0eWxlcyBvZiBjb21tYW5kOiBwYXkgYXR0ZW50aW9uIHRvIHdoZXJlIHRvIHB1dCB0aGUgZGVzY3JpcHRpb24uXG4gICAqXG4gICAqIEV4YW1wbGVzOlxuICAgKlxuICAgKiAgICAgIC8vIENvbW1hbmQgaW1wbGVtZW50ZWQgdXNpbmcgYWN0aW9uIGhhbmRsZXIgKGRlc2NyaXB0aW9uIGlzIHN1cHBsaWVkIHNlcGFyYXRlbHkgdG8gYC5jb21tYW5kYClcbiAgICogICAgICBwcm9ncmFtXG4gICAqICAgICAgICAuY29tbWFuZCgnY2xvbmUgPHNvdXJjZT4gW2Rlc3RpbmF0aW9uXScpXG4gICAqICAgICAgICAuZGVzY3JpcHRpb24oJ2Nsb25lIGEgcmVwb3NpdG9yeSBpbnRvIGEgbmV3bHkgY3JlYXRlZCBkaXJlY3RvcnknKVxuICAgKiAgICAgICAgLmFjdGlvbigoc291cmNlLCBkZXN0aW5hdGlvbikgPT4ge1xuICAgKiAgICAgICAgICBjb25zb2xlLmxvZygnY2xvbmUgY29tbWFuZCBjYWxsZWQnKTtcbiAgICogICAgICAgIH0pO1xuICAgKlxuICAgKiAgICAgIC8vIENvbW1hbmQgaW1wbGVtZW50ZWQgdXNpbmcgc2VwYXJhdGUgZXhlY3V0YWJsZSBmaWxlIChkZXNjcmlwdGlvbiBpcyBzZWNvbmQgcGFyYW1ldGVyIHRvIGAuY29tbWFuZGApXG4gICAqICAgICAgcHJvZ3JhbVxuICAgKiAgICAgICAgLmNvbW1hbmQoJ3N0YXJ0IDxzZXJ2aWNlPicsICdzdGFydCBuYW1lZCBzZXJ2aWNlJylcbiAgICogICAgICAgIC5jb21tYW5kKCdzdG9wIFtzZXJ2aWNlXScsICdzdG9wIG5hbWVkIHNlcnZpY2UsIG9yIGFsbCBpZiBubyBuYW1lIHN1cHBsaWVkJyk7XG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lQW5kQXJncyAtIGNvbW1hbmQgbmFtZSBhbmQgYXJndW1lbnRzLCBhcmdzIGFyZSBgPHJlcXVpcmVkPmAgb3IgYFtvcHRpb25hbF1gIGFuZCBsYXN0IG1heSBhbHNvIGJlIGB2YXJpYWRpYy4uLmBcbiAgICogQHBhcmFtIHtPYmplY3R8c3RyaW5nfSBbYWN0aW9uT3B0c09yRXhlY0Rlc2NdIC0gY29uZmlndXJhdGlvbiBvcHRpb25zIChmb3IgYWN0aW9uKSwgb3IgZGVzY3JpcHRpb24gKGZvciBleGVjdXRhYmxlKVxuICAgKiBAcGFyYW0ge09iamVjdH0gW2V4ZWNPcHRzXSAtIGNvbmZpZ3VyYXRpb24gb3B0aW9ucyAoZm9yIGV4ZWN1dGFibGUpXG4gICAqIEByZXR1cm4ge0NvbW1hbmR9IHJldHVybnMgbmV3IGNvbW1hbmQgZm9yIGFjdGlvbiBoYW5kbGVyLCBvciBgdGhpc2AgZm9yIGV4ZWN1dGFibGUgY29tbWFuZFxuICAgKi9cblxuICBjb21tYW5kKG5hbWVBbmRBcmdzLCBhY3Rpb25PcHRzT3JFeGVjRGVzYywgZXhlY09wdHMpIHtcbiAgICBsZXQgZGVzYyA9IGFjdGlvbk9wdHNPckV4ZWNEZXNjO1xuICAgIGxldCBvcHRzID0gZXhlY09wdHM7XG4gICAgaWYgKHR5cGVvZiBkZXNjID09PSAnb2JqZWN0JyAmJiBkZXNjICE9PSBudWxsKSB7XG4gICAgICBvcHRzID0gZGVzYztcbiAgICAgIGRlc2MgPSBudWxsO1xuICAgIH1cbiAgICBvcHRzID0gb3B0cyB8fCB7fTtcbiAgICBjb25zdCBhcmdzID0gbmFtZUFuZEFyZ3Muc3BsaXQoLyArLyk7XG4gICAgY29uc3QgY21kID0gdGhpcy5jcmVhdGVDb21tYW5kKGFyZ3Muc2hpZnQoKSk7XG5cbiAgICBpZiAoZGVzYykge1xuICAgICAgY21kLmRlc2NyaXB0aW9uKGRlc2MpO1xuICAgICAgY21kLl9leGVjdXRhYmxlSGFuZGxlciA9IHRydWU7XG4gICAgfVxuICAgIGlmIChvcHRzLmlzRGVmYXVsdCkgdGhpcy5fZGVmYXVsdENvbW1hbmROYW1lID0gY21kLl9uYW1lO1xuXG4gICAgY21kLl9vdXRwdXRDb25maWd1cmF0aW9uID0gdGhpcy5fb3V0cHV0Q29uZmlndXJhdGlvbjtcblxuICAgIGNtZC5faGlkZGVuID0gISEob3B0cy5ub0hlbHAgfHwgb3B0cy5oaWRkZW4pOyAvLyBub0hlbHAgaXMgZGVwcmVjYXRlZCBvbGQgbmFtZSBmb3IgaGlkZGVuXG4gICAgY21kLl9oYXNIZWxwT3B0aW9uID0gdGhpcy5faGFzSGVscE9wdGlvbjtcbiAgICBjbWQuX2hlbHBGbGFncyA9IHRoaXMuX2hlbHBGbGFncztcbiAgICBjbWQuX2hlbHBEZXNjcmlwdGlvbiA9IHRoaXMuX2hlbHBEZXNjcmlwdGlvbjtcbiAgICBjbWQuX2hlbHBTaG9ydEZsYWcgPSB0aGlzLl9oZWxwU2hvcnRGbGFnO1xuICAgIGNtZC5faGVscExvbmdGbGFnID0gdGhpcy5faGVscExvbmdGbGFnO1xuICAgIGNtZC5faGVscENvbW1hbmROYW1lID0gdGhpcy5faGVscENvbW1hbmROYW1lO1xuICAgIGNtZC5faGVscENvbW1hbmRuYW1lQW5kQXJncyA9IHRoaXMuX2hlbHBDb21tYW5kbmFtZUFuZEFyZ3M7XG4gICAgY21kLl9oZWxwQ29tbWFuZERlc2NyaXB0aW9uID0gdGhpcy5faGVscENvbW1hbmREZXNjcmlwdGlvbjtcbiAgICBjbWQuX2hlbHBDb25maWd1cmF0aW9uID0gdGhpcy5faGVscENvbmZpZ3VyYXRpb247XG4gICAgY21kLl9leGl0Q2FsbGJhY2sgPSB0aGlzLl9leGl0Q2FsbGJhY2s7XG4gICAgY21kLl9zdG9yZU9wdGlvbnNBc1Byb3BlcnRpZXMgPSB0aGlzLl9zdG9yZU9wdGlvbnNBc1Byb3BlcnRpZXM7XG4gICAgY21kLl9jb21iaW5lRmxhZ0FuZE9wdGlvbmFsVmFsdWUgPSB0aGlzLl9jb21iaW5lRmxhZ0FuZE9wdGlvbmFsVmFsdWU7XG4gICAgY21kLl9hbGxvd0V4Y2Vzc0FyZ3VtZW50cyA9IHRoaXMuX2FsbG93RXhjZXNzQXJndW1lbnRzO1xuICAgIGNtZC5fZW5hYmxlUG9zaXRpb25hbE9wdGlvbnMgPSB0aGlzLl9lbmFibGVQb3NpdGlvbmFsT3B0aW9ucztcblxuICAgIGNtZC5fZXhlY3V0YWJsZUZpbGUgPSBvcHRzLmV4ZWN1dGFibGVGaWxlIHx8IG51bGw7IC8vIEN1c3RvbSBuYW1lIGZvciBleGVjdXRhYmxlIGZpbGUsIHNldCBtaXNzaW5nIHRvIG51bGwgdG8gbWF0Y2ggY29uc3RydWN0b3JcbiAgICB0aGlzLmNvbW1hbmRzLnB1c2goY21kKTtcbiAgICBjbWQuX3BhcnNlRXhwZWN0ZWRBcmdzKGFyZ3MpO1xuICAgIGNtZC5wYXJlbnQgPSB0aGlzO1xuXG4gICAgaWYgKGRlc2MpIHJldHVybiB0aGlzO1xuICAgIHJldHVybiBjbWQ7XG4gIH07XG5cbiAgLyoqXG4gICAqIEZhY3Rvcnkgcm91dGluZSB0byBjcmVhdGUgYSBuZXcgdW5hdHRhY2hlZCBjb21tYW5kLlxuICAgKlxuICAgKiBTZWUgLmNvbW1hbmQoKSBmb3IgY3JlYXRpbmcgYW4gYXR0YWNoZWQgc3ViY29tbWFuZCwgd2hpY2ggdXNlcyB0aGlzIHJvdXRpbmUgdG9cbiAgICogY3JlYXRlIHRoZSBjb21tYW5kLiBZb3UgY2FuIG92ZXJyaWRlIGNyZWF0ZUNvbW1hbmQgdG8gY3VzdG9taXNlIHN1YmNvbW1hbmRzLlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gW25hbWVdXG4gICAqIEByZXR1cm4ge0NvbW1hbmR9IG5ldyBjb21tYW5kXG4gICAqL1xuXG4gIGNyZWF0ZUNvbW1hbmQobmFtZSkge1xuICAgIHJldHVybiBuZXcgQ29tbWFuZChuYW1lKTtcbiAgfTtcblxuICAvKipcbiAgICogWW91IGNhbiBjdXN0b21pc2UgdGhlIGhlbHAgd2l0aCBhIHN1YmNsYXNzIG9mIEhlbHAgYnkgb3ZlcnJpZGluZyBjcmVhdGVIZWxwLFxuICAgKiBvciBieSBvdmVycmlkaW5nIEhlbHAgcHJvcGVydGllcyB1c2luZyBjb25maWd1cmVIZWxwKCkuXG4gICAqXG4gICAqIEByZXR1cm4ge0hlbHB9XG4gICAqL1xuXG4gIGNyZWF0ZUhlbHAoKSB7XG4gICAgcmV0dXJuIE9iamVjdC5hc3NpZ24obmV3IEhlbHAoKSwgdGhpcy5jb25maWd1cmVIZWxwKCkpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBZb3UgY2FuIGN1c3RvbWlzZSB0aGUgaGVscCBieSBvdmVycmlkaW5nIEhlbHAgcHJvcGVydGllcyB1c2luZyBjb25maWd1cmVIZWxwKCksXG4gICAqIG9yIHdpdGggYSBzdWJjbGFzcyBvZiBIZWxwIGJ5IG92ZXJyaWRpbmcgY3JlYXRlSGVscCgpLlxuICAgKlxuICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZ3VyYXRpb25dIC0gY29uZmlndXJhdGlvbiBvcHRpb25zXG4gICAqIEByZXR1cm4ge0NvbW1hbmR8T2JqZWN0fSBgdGhpc2AgY29tbWFuZCBmb3IgY2hhaW5pbmcsIG9yIHN0b3JlZCBjb25maWd1cmF0aW9uXG4gICAqL1xuXG4gIGNvbmZpZ3VyZUhlbHAoY29uZmlndXJhdGlvbikge1xuICAgIGlmIChjb25maWd1cmF0aW9uID09PSB1bmRlZmluZWQpIHJldHVybiB0aGlzLl9oZWxwQ29uZmlndXJhdGlvbjtcblxuICAgIHRoaXMuX2hlbHBDb25maWd1cmF0aW9uID0gY29uZmlndXJhdGlvbjtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBUaGUgZGVmYXVsdCBvdXRwdXQgZ29lcyB0byBzdGRvdXQgYW5kIHN0ZGVyci4gWW91IGNhbiBjdXN0b21pc2UgdGhpcyBmb3Igc3BlY2lhbFxuICAgKiBhcHBsaWNhdGlvbnMuIFlvdSBjYW4gYWxzbyBjdXN0b21pc2UgdGhlIGRpc3BsYXkgb2YgZXJyb3JzIGJ5IG92ZXJyaWRpbmcgb3V0cHV0RXJyb3IuXG4gICAqXG4gICAqIFRoZSBjb25maWd1cmF0aW9uIHByb3BlcnRpZXMgYXJlIGFsbCBmdW5jdGlvbnM6XG4gICAqXG4gICAqICAgIC8vIGZ1bmN0aW9ucyB0byBjaGFuZ2Ugd2hlcmUgYmVpbmcgd3JpdHRlbiwgc3Rkb3V0IGFuZCBzdGRlcnJcbiAgICogICAgd3JpdGVPdXQoc3RyKVxuICAgKiAgICB3cml0ZUVycihzdHIpXG4gICAqICAgIC8vIG1hdGNoaW5nIGZ1bmN0aW9ucyB0byBzcGVjaWZ5IHdpZHRoIGZvciB3cmFwcGluZyBoZWxwXG4gICAqICAgIGdldE91dEhlbHBXaWR0aCgpXG4gICAqICAgIGdldEVyckhlbHBXaWR0aCgpXG4gICAqICAgIC8vIGZ1bmN0aW9ucyBiYXNlZCBvbiB3aGF0IGlzIGJlaW5nIHdyaXR0ZW4gb3V0XG4gICAqICAgIG91dHB1dEVycm9yKHN0ciwgd3JpdGUpIC8vIHVzZWQgZm9yIGRpc3BsYXlpbmcgZXJyb3JzLCBhbmQgbm90IHVzZWQgZm9yIGRpc3BsYXlpbmcgaGVscFxuICAgKlxuICAgKiBAcGFyYW0ge09iamVjdH0gW2NvbmZpZ3VyYXRpb25dIC0gY29uZmlndXJhdGlvbiBvcHRpb25zXG4gICAqIEByZXR1cm4ge0NvbW1hbmR8T2JqZWN0fSBgdGhpc2AgY29tbWFuZCBmb3IgY2hhaW5pbmcsIG9yIHN0b3JlZCBjb25maWd1cmF0aW9uXG4gICAqL1xuXG4gIGNvbmZpZ3VyZU91dHB1dChjb25maWd1cmF0aW9uKSB7XG4gICAgaWYgKGNvbmZpZ3VyYXRpb24gPT09IHVuZGVmaW5lZCkgcmV0dXJuIHRoaXMuX291dHB1dENvbmZpZ3VyYXRpb247XG5cbiAgICBPYmplY3QuYXNzaWduKHRoaXMuX291dHB1dENvbmZpZ3VyYXRpb24sIGNvbmZpZ3VyYXRpb24pO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZCBhIHByZXBhcmVkIHN1YmNvbW1hbmQuXG4gICAqXG4gICAqIFNlZSAuY29tbWFuZCgpIGZvciBjcmVhdGluZyBhbiBhdHRhY2hlZCBzdWJjb21tYW5kIHdoaWNoIGluaGVyaXRzIHNldHRpbmdzIGZyb20gaXRzIHBhcmVudC5cbiAgICpcbiAgICogQHBhcmFtIHtDb21tYW5kfSBjbWQgLSBuZXcgc3ViY29tbWFuZFxuICAgKiBAcGFyYW0ge09iamVjdH0gW29wdHNdIC0gY29uZmlndXJhdGlvbiBvcHRpb25zXG4gICAqIEByZXR1cm4ge0NvbW1hbmR9IGB0aGlzYCBjb21tYW5kIGZvciBjaGFpbmluZ1xuICAgKi9cblxuICBhZGRDb21tYW5kKGNtZCwgb3B0cykge1xuICAgIGlmICghY21kLl9uYW1lKSB0aHJvdyBuZXcgRXJyb3IoJ0NvbW1hbmQgcGFzc2VkIHRvIC5hZGRDb21tYW5kKCkgbXVzdCBoYXZlIGEgbmFtZScpO1xuXG4gICAgLy8gVG8ga2VlcCB0aGluZ3Mgc2ltcGxlLCBibG9jayBhdXRvbWF0aWMgbmFtZSBnZW5lcmF0aW9uIGZvciBkZWVwbHkgbmVzdGVkIGV4ZWN1dGFibGVzLlxuICAgIC8vIEZhaWwgZmFzdCBhbmQgZGV0ZWN0IHdoZW4gYWRkaW5nIHJhdGhlciB0aGFuIGxhdGVyIHdoZW4gcGFyc2luZy5cbiAgICBmdW5jdGlvbiBjaGVja0V4cGxpY2l0TmFtZXMoY29tbWFuZEFycmF5KSB7XG4gICAgICBjb21tYW5kQXJyYXkuZm9yRWFjaCgoY21kKSA9PiB7XG4gICAgICAgIGlmIChjbWQuX2V4ZWN1dGFibGVIYW5kbGVyICYmICFjbWQuX2V4ZWN1dGFibGVGaWxlKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBNdXN0IHNwZWNpZnkgZXhlY3V0YWJsZUZpbGUgZm9yIGRlZXBseSBuZXN0ZWQgZXhlY3V0YWJsZTogJHtjbWQubmFtZSgpfWApO1xuICAgICAgICB9XG4gICAgICAgIGNoZWNrRXhwbGljaXROYW1lcyhjbWQuY29tbWFuZHMpO1xuICAgICAgfSk7XG4gICAgfVxuICAgIGNoZWNrRXhwbGljaXROYW1lcyhjbWQuY29tbWFuZHMpO1xuXG4gICAgb3B0cyA9IG9wdHMgfHwge307XG4gICAgaWYgKG9wdHMuaXNEZWZhdWx0KSB0aGlzLl9kZWZhdWx0Q29tbWFuZE5hbWUgPSBjbWQuX25hbWU7XG4gICAgaWYgKG9wdHMubm9IZWxwIHx8IG9wdHMuaGlkZGVuKSBjbWQuX2hpZGRlbiA9IHRydWU7IC8vIG1vZGlmeWluZyBwYXNzZWQgY29tbWFuZCBkdWUgdG8gZXhpc3RpbmcgaW1wbGVtZW50YXRpb25cblxuICAgIHRoaXMuY29tbWFuZHMucHVzaChjbWQpO1xuICAgIGNtZC5wYXJlbnQgPSB0aGlzO1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIC8qKlxuICAgKiBEZWZpbmUgYXJndW1lbnQgc3ludGF4IGZvciB0aGUgY29tbWFuZC5cbiAgICovXG5cbiAgYXJndW1lbnRzKGRlc2MpIHtcbiAgICByZXR1cm4gdGhpcy5fcGFyc2VFeHBlY3RlZEFyZ3MoZGVzYy5zcGxpdCgvICsvKSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIE92ZXJyaWRlIGRlZmF1bHQgZGVjaXNpb24gd2hldGhlciB0byBhZGQgaW1wbGljaXQgaGVscCBjb21tYW5kLlxuICAgKlxuICAgKiAgICBhZGRIZWxwQ29tbWFuZCgpIC8vIGZvcmNlIG9uXG4gICAqICAgIGFkZEhlbHBDb21tYW5kKGZhbHNlKTsgLy8gZm9yY2Ugb2ZmXG4gICAqICAgIGFkZEhlbHBDb21tYW5kKCdoZWxwIFtjbWRdJywgJ2Rpc3BsYXkgaGVscCBmb3IgW2NtZF0nKTsgLy8gZm9yY2Ugb24gd2l0aCBjdXN0b20gZGV0YWlsc1xuICAgKlxuICAgKiBAcmV0dXJuIHtDb21tYW5kfSBgdGhpc2AgY29tbWFuZCBmb3IgY2hhaW5pbmdcbiAgICovXG5cbiAgYWRkSGVscENvbW1hbmQoZW5hYmxlT3JOYW1lQW5kQXJncywgZGVzY3JpcHRpb24pIHtcbiAgICBpZiAoZW5hYmxlT3JOYW1lQW5kQXJncyA9PT0gZmFsc2UpIHtcbiAgICAgIHRoaXMuX2FkZEltcGxpY2l0SGVscENvbW1hbmQgPSBmYWxzZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fYWRkSW1wbGljaXRIZWxwQ29tbWFuZCA9IHRydWU7XG4gICAgICBpZiAodHlwZW9mIGVuYWJsZU9yTmFtZUFuZEFyZ3MgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHRoaXMuX2hlbHBDb21tYW5kTmFtZSA9IGVuYWJsZU9yTmFtZUFuZEFyZ3Muc3BsaXQoJyAnKVswXTtcbiAgICAgICAgdGhpcy5faGVscENvbW1hbmRuYW1lQW5kQXJncyA9IGVuYWJsZU9yTmFtZUFuZEFyZ3M7XG4gICAgICB9XG4gICAgICB0aGlzLl9oZWxwQ29tbWFuZERlc2NyaXB0aW9uID0gZGVzY3JpcHRpb24gfHwgdGhpcy5faGVscENvbW1hbmREZXNjcmlwdGlvbjtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIEByZXR1cm4ge2Jvb2xlYW59XG4gICAqIEBhcGkgcHJpdmF0ZVxuICAgKi9cblxuICBfaGFzSW1wbGljaXRIZWxwQ29tbWFuZCgpIHtcbiAgICBpZiAodGhpcy5fYWRkSW1wbGljaXRIZWxwQ29tbWFuZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXR1cm4gdGhpcy5jb21tYW5kcy5sZW5ndGggJiYgIXRoaXMuX2FjdGlvbkhhbmRsZXIgJiYgIXRoaXMuX2ZpbmRDb21tYW5kKCdoZWxwJyk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLl9hZGRJbXBsaWNpdEhlbHBDb21tYW5kO1xuICB9O1xuXG4gIC8qKlxuICAgKiBQYXJzZSBleHBlY3RlZCBgYXJnc2AuXG4gICAqXG4gICAqIEZvciBleGFtcGxlIGBbXCJbdHlwZV1cIl1gIGJlY29tZXMgYFt7IHJlcXVpcmVkOiBmYWxzZSwgbmFtZTogJ3R5cGUnIH1dYC5cbiAgICpcbiAgICogQHBhcmFtIHtBcnJheX0gYXJnc1xuICAgKiBAcmV0dXJuIHtDb21tYW5kfSBgdGhpc2AgY29tbWFuZCBmb3IgY2hhaW5pbmdcbiAgICogQGFwaSBwcml2YXRlXG4gICAqL1xuXG4gIF9wYXJzZUV4cGVjdGVkQXJncyhhcmdzKSB7XG4gICAgaWYgKCFhcmdzLmxlbmd0aCkgcmV0dXJuO1xuICAgIGFyZ3MuZm9yRWFjaCgoYXJnKSA9PiB7XG4gICAgICBjb25zdCBhcmdEZXRhaWxzID0ge1xuICAgICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICAgIG5hbWU6ICcnLFxuICAgICAgICB2YXJpYWRpYzogZmFsc2VcbiAgICAgIH07XG5cbiAgICAgIHN3aXRjaCAoYXJnWzBdKSB7XG4gICAgICAgIGNhc2UgJzwnOlxuICAgICAgICAgIGFyZ0RldGFpbHMucmVxdWlyZWQgPSB0cnVlO1xuICAgICAgICAgIGFyZ0RldGFpbHMubmFtZSA9IGFyZy5zbGljZSgxLCAtMSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ1snOlxuICAgICAgICAgIGFyZ0RldGFpbHMubmFtZSA9IGFyZy5zbGljZSgxLCAtMSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICB9XG5cbiAgICAgIGlmIChhcmdEZXRhaWxzLm5hbWUubGVuZ3RoID4gMyAmJiBhcmdEZXRhaWxzLm5hbWUuc2xpY2UoLTMpID09PSAnLi4uJykge1xuICAgICAgICBhcmdEZXRhaWxzLnZhcmlhZGljID0gdHJ1ZTtcbiAgICAgICAgYXJnRGV0YWlscy5uYW1lID0gYXJnRGV0YWlscy5uYW1lLnNsaWNlKDAsIC0zKTtcbiAgICAgIH1cbiAgICAgIGlmIChhcmdEZXRhaWxzLm5hbWUpIHtcbiAgICAgICAgdGhpcy5fYXJncy5wdXNoKGFyZ0RldGFpbHMpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHRoaXMuX2FyZ3MuZm9yRWFjaCgoYXJnLCBpKSA9PiB7XG4gICAgICBpZiAoYXJnLnZhcmlhZGljICYmIGkgPCB0aGlzLl9hcmdzLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBvbmx5IHRoZSBsYXN0IGFyZ3VtZW50IGNhbiBiZSB2YXJpYWRpYyAnJHthcmcubmFtZX0nYCk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIFJlZ2lzdGVyIGNhbGxiYWNrIHRvIHVzZSBhcyByZXBsYWNlbWVudCBmb3IgY2FsbGluZyBwcm9jZXNzLmV4aXQuXG4gICAqXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IFtmbl0gb3B0aW9uYWwgY2FsbGJhY2sgd2hpY2ggd2lsbCBiZSBwYXNzZWQgYSBDb21tYW5kZXJFcnJvciwgZGVmYXVsdHMgdG8gdGhyb3dpbmdcbiAgICogQHJldHVybiB7Q29tbWFuZH0gYHRoaXNgIGNvbW1hbmQgZm9yIGNoYWluaW5nXG4gICAqL1xuXG4gIGV4aXRPdmVycmlkZShmbikge1xuICAgIGlmIChmbikge1xuICAgICAgdGhpcy5fZXhpdENhbGxiYWNrID0gZm47XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2V4aXRDYWxsYmFjayA9IChlcnIpID0+IHtcbiAgICAgICAgaWYgKGVyci5jb2RlICE9PSAnY29tbWFuZGVyLmV4ZWN1dGVTdWJDb21tYW5kQXN5bmMnKSB7XG4gICAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIEFzeW5jIGNhbGxiYWNrIGZyb20gc3Bhd24gZXZlbnRzLCBub3QgdXNlZnVsIHRvIHRocm93LlxuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICAvKipcbiAgICogQ2FsbCBwcm9jZXNzLmV4aXQsIGFuZCBfZXhpdENhbGxiYWNrIGlmIGRlZmluZWQuXG4gICAqXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBleGl0Q29kZSBleGl0IGNvZGUgZm9yIHVzaW5nIHdpdGggcHJvY2Vzcy5leGl0XG4gICAqIEBwYXJhbSB7c3RyaW5nfSBjb2RlIGFuIGlkIHN0cmluZyByZXByZXNlbnRpbmcgdGhlIGVycm9yXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBtZXNzYWdlIGh1bWFuLXJlYWRhYmxlIGRlc2NyaXB0aW9uIG9mIHRoZSBlcnJvclxuICAgKiBAcmV0dXJuIG5ldmVyXG4gICAqIEBhcGkgcHJpdmF0ZVxuICAgKi9cblxuICBfZXhpdChleGl0Q29kZSwgY29kZSwgbWVzc2FnZSkge1xuICAgIGlmICh0aGlzLl9leGl0Q2FsbGJhY2spIHtcbiAgICAgIHRoaXMuX2V4aXRDYWxsYmFjayhuZXcgQ29tbWFuZGVyRXJyb3IoZXhpdENvZGUsIGNvZGUsIG1lc3NhZ2UpKTtcbiAgICAgIC8vIEV4cGVjdGluZyB0aGlzIGxpbmUgaXMgbm90IHJlYWNoZWQuXG4gICAgfVxuICAgIHByb2Nlc3MuZXhpdChleGl0Q29kZSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFJlZ2lzdGVyIGNhbGxiYWNrIGBmbmAgZm9yIHRoZSBjb21tYW5kLlxuICAgKlxuICAgKiBFeGFtcGxlczpcbiAgICpcbiAgICogICAgICBwcm9ncmFtXG4gICAqICAgICAgICAuY29tbWFuZCgnaGVscCcpXG4gICAqICAgICAgICAuZGVzY3JpcHRpb24oJ2Rpc3BsYXkgdmVyYm9zZSBoZWxwJylcbiAgICogICAgICAgIC5hY3Rpb24oZnVuY3Rpb24oKSB7XG4gICAqICAgICAgICAgICAvLyBvdXRwdXQgaGVscCBoZXJlXG4gICAqICAgICAgICB9KTtcbiAgICpcbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gZm5cbiAgICogQHJldHVybiB7Q29tbWFuZH0gYHRoaXNgIGNvbW1hbmQgZm9yIGNoYWluaW5nXG4gICAqL1xuXG4gIGFjdGlvbihmbikge1xuICAgIGNvbnN0IGxpc3RlbmVyID0gKGFyZ3MpID0+IHtcbiAgICAgIC8vIFRoZSAuYWN0aW9uIGNhbGxiYWNrIHRha2VzIGFuIGV4dHJhIHBhcmFtZXRlciB3aGljaCBpcyB0aGUgY29tbWFuZCBvciBvcHRpb25zLlxuICAgICAgY29uc3QgZXhwZWN0ZWRBcmdzQ291bnQgPSB0aGlzLl9hcmdzLmxlbmd0aDtcbiAgICAgIGNvbnN0IGFjdGlvbkFyZ3MgPSBhcmdzLnNsaWNlKDAsIGV4cGVjdGVkQXJnc0NvdW50KTtcbiAgICAgIGlmICh0aGlzLl9zdG9yZU9wdGlvbnNBc1Byb3BlcnRpZXMpIHtcbiAgICAgICAgYWN0aW9uQXJnc1tleHBlY3RlZEFyZ3NDb3VudF0gPSB0aGlzOyAvLyBiYWNrd2FyZHMgY29tcGF0aWJsZSBcIm9wdGlvbnNcIlxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYWN0aW9uQXJnc1tleHBlY3RlZEFyZ3NDb3VudF0gPSB0aGlzLm9wdHMoKTtcbiAgICAgIH1cbiAgICAgIGFjdGlvbkFyZ3MucHVzaCh0aGlzKTtcblxuICAgICAgY29uc3QgYWN0aW9uUmVzdWx0ID0gZm4uYXBwbHkodGhpcywgYWN0aW9uQXJncyk7XG4gICAgICAvLyBSZW1lbWJlciByZXN1bHQgaW4gY2FzZSBpdCBpcyBhc3luYy4gQXNzdW1lIHBhcnNlQXN5bmMgZ2V0dGluZyBjYWxsZWQgb24gcm9vdC5cbiAgICAgIGxldCByb290Q29tbWFuZCA9IHRoaXM7XG4gICAgICB3aGlsZSAocm9vdENvbW1hbmQucGFyZW50KSB7XG4gICAgICAgIHJvb3RDb21tYW5kID0gcm9vdENvbW1hbmQucGFyZW50O1xuICAgICAgfVxuICAgICAgcm9vdENvbW1hbmQuX2FjdGlvblJlc3VsdHMucHVzaChhY3Rpb25SZXN1bHQpO1xuICAgIH07XG4gICAgdGhpcy5fYWN0aW9uSGFuZGxlciA9IGxpc3RlbmVyO1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIC8qKlxuICAgKiBGYWN0b3J5IHJvdXRpbmUgdG8gY3JlYXRlIGEgbmV3IHVuYXR0YWNoZWQgb3B0aW9uLlxuICAgKlxuICAgKiBTZWUgLm9wdGlvbigpIGZvciBjcmVhdGluZyBhbiBhdHRhY2hlZCBvcHRpb24sIHdoaWNoIHVzZXMgdGhpcyByb3V0aW5lIHRvXG4gICAqIGNyZWF0ZSB0aGUgb3B0aW9uLiBZb3UgY2FuIG92ZXJyaWRlIGNyZWF0ZU9wdGlvbiB0byByZXR1cm4gYSBjdXN0b20gb3B0aW9uLlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gZmxhZ3NcbiAgICogQHBhcmFtIHtzdHJpbmd9IFtkZXNjcmlwdGlvbl1cbiAgICogQHJldHVybiB7T3B0aW9ufSBuZXcgb3B0aW9uXG4gICAqL1xuXG4gIGNyZWF0ZU9wdGlvbihmbGFncywgZGVzY3JpcHRpb24pIHtcbiAgICByZXR1cm4gbmV3IE9wdGlvbihmbGFncywgZGVzY3JpcHRpb24pO1xuICB9O1xuXG4gIC8qKlxuICAgKiBBZGQgYW4gb3B0aW9uLlxuICAgKlxuICAgKiBAcGFyYW0ge09wdGlvbn0gb3B0aW9uXG4gICAqIEByZXR1cm4ge0NvbW1hbmR9IGB0aGlzYCBjb21tYW5kIGZvciBjaGFpbmluZ1xuICAgKi9cbiAgYWRkT3B0aW9uKG9wdGlvbikge1xuICAgIGNvbnN0IG9uYW1lID0gb3B0aW9uLm5hbWUoKTtcbiAgICBjb25zdCBuYW1lID0gb3B0aW9uLmF0dHJpYnV0ZU5hbWUoKTtcblxuICAgIGxldCBkZWZhdWx0VmFsdWUgPSBvcHRpb24uZGVmYXVsdFZhbHVlO1xuXG4gICAgLy8gcHJlYXNzaWduIGRlZmF1bHQgdmFsdWUgZm9yIC0tbm8tKiwgW29wdGlvbmFsXSwgPHJlcXVpcmVkPiwgb3IgcGxhaW4gZmxhZyBpZiBib29sZWFuIHZhbHVlXG4gICAgaWYgKG9wdGlvbi5uZWdhdGUgfHwgb3B0aW9uLm9wdGlvbmFsIHx8IG9wdGlvbi5yZXF1aXJlZCB8fCB0eXBlb2YgZGVmYXVsdFZhbHVlID09PSAnYm9vbGVhbicpIHtcbiAgICAgIC8vIHdoZW4gLS1uby1mb28gd2UgbWFrZSBzdXJlIGRlZmF1bHQgaXMgdHJ1ZSwgdW5sZXNzIGEgLS1mb28gb3B0aW9uIGlzIGFscmVhZHkgZGVmaW5lZFxuICAgICAgaWYgKG9wdGlvbi5uZWdhdGUpIHtcbiAgICAgICAgY29uc3QgcG9zaXRpdmVMb25nRmxhZyA9IG9wdGlvbi5sb25nLnJlcGxhY2UoL14tLW5vLS8sICctLScpO1xuICAgICAgICBkZWZhdWx0VmFsdWUgPSB0aGlzLl9maW5kT3B0aW9uKHBvc2l0aXZlTG9uZ0ZsYWcpID8gdGhpcy5fZ2V0T3B0aW9uVmFsdWUobmFtZSkgOiB0cnVlO1xuICAgICAgfVxuICAgICAgLy8gcHJlYXNzaWduIG9ubHkgaWYgd2UgaGF2ZSBhIGRlZmF1bHRcbiAgICAgIGlmIChkZWZhdWx0VmFsdWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICB0aGlzLl9zZXRPcHRpb25WYWx1ZShuYW1lLCBkZWZhdWx0VmFsdWUpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIHJlZ2lzdGVyIHRoZSBvcHRpb25cbiAgICB0aGlzLm9wdGlvbnMucHVzaChvcHRpb24pO1xuXG4gICAgLy8gd2hlbiBpdCdzIHBhc3NlZCBhc3NpZ24gdGhlIHZhbHVlXG4gICAgLy8gYW5kIGNvbmRpdGlvbmFsbHkgaW52b2tlIHRoZSBjYWxsYmFja1xuICAgIHRoaXMub24oJ29wdGlvbjonICsgb25hbWUsICh2YWwpID0+IHtcbiAgICAgIGNvbnN0IG9sZFZhbHVlID0gdGhpcy5fZ2V0T3B0aW9uVmFsdWUobmFtZSk7XG5cbiAgICAgIC8vIGN1c3RvbSBwcm9jZXNzaW5nXG4gICAgICBpZiAodmFsICE9PSBudWxsICYmIG9wdGlvbi5wYXJzZUFyZykge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIHZhbCA9IG9wdGlvbi5wYXJzZUFyZyh2YWwsIG9sZFZhbHVlID09PSB1bmRlZmluZWQgPyBkZWZhdWx0VmFsdWUgOiBvbGRWYWx1ZSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgIGlmIChlcnIuY29kZSA9PT0gJ2NvbW1hbmRlci5pbnZhbGlkT3B0aW9uQXJndW1lbnQnKSB7XG4gICAgICAgICAgICBjb25zdCBtZXNzYWdlID0gYGVycm9yOiBvcHRpb24gJyR7b3B0aW9uLmZsYWdzfScgYXJndW1lbnQgJyR7dmFsfScgaXMgaW52YWxpZC4gJHtlcnIubWVzc2FnZX1gO1xuICAgICAgICAgICAgdGhpcy5fZGlzcGxheUVycm9yKGVyci5leGl0Q29kZSwgZXJyLmNvZGUsIG1lc3NhZ2UpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aHJvdyBlcnI7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAodmFsICE9PSBudWxsICYmIG9wdGlvbi52YXJpYWRpYykge1xuICAgICAgICB2YWwgPSBvcHRpb24uX2NvbmNhdFZhbHVlKHZhbCwgb2xkVmFsdWUpO1xuICAgICAgfVxuXG4gICAgICAvLyB1bmFzc2lnbmVkIG9yIGJvb2xlYW4gdmFsdWVcbiAgICAgIGlmICh0eXBlb2Ygb2xkVmFsdWUgPT09ICdib29sZWFuJyB8fCB0eXBlb2Ygb2xkVmFsdWUgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIC8vIGlmIG5vIHZhbHVlLCBuZWdhdGUgZmFsc2UsIGFuZCB3ZSBoYXZlIGEgZGVmYXVsdCwgdGhlbiB1c2UgaXQhXG4gICAgICAgIGlmICh2YWwgPT0gbnVsbCkge1xuICAgICAgICAgIHRoaXMuX3NldE9wdGlvblZhbHVlKG5hbWUsIG9wdGlvbi5uZWdhdGVcbiAgICAgICAgICAgID8gZmFsc2VcbiAgICAgICAgICAgIDogZGVmYXVsdFZhbHVlIHx8IHRydWUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuX3NldE9wdGlvblZhbHVlKG5hbWUsIHZhbCk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAodmFsICE9PSBudWxsKSB7XG4gICAgICAgIC8vIHJlYXNzaWduXG4gICAgICAgIHRoaXMuX3NldE9wdGlvblZhbHVlKG5hbWUsIG9wdGlvbi5uZWdhdGUgPyBmYWxzZSA6IHZhbCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBJbnRlcm5hbCBpbXBsZW1lbnRhdGlvbiBzaGFyZWQgYnkgLm9wdGlvbigpIGFuZCAucmVxdWlyZWRPcHRpb24oKVxuICAgKlxuICAgKiBAYXBpIHByaXZhdGVcbiAgICovXG4gIF9vcHRpb25FeChjb25maWcsIGZsYWdzLCBkZXNjcmlwdGlvbiwgZm4sIGRlZmF1bHRWYWx1ZSkge1xuICAgIGNvbnN0IG9wdGlvbiA9IHRoaXMuY3JlYXRlT3B0aW9uKGZsYWdzLCBkZXNjcmlwdGlvbik7XG4gICAgb3B0aW9uLm1ha2VPcHRpb25NYW5kYXRvcnkoISFjb25maWcubWFuZGF0b3J5KTtcbiAgICBpZiAodHlwZW9mIGZuID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICBvcHRpb24uZGVmYXVsdChkZWZhdWx0VmFsdWUpLmFyZ1BhcnNlcihmbik7XG4gICAgfSBlbHNlIGlmIChmbiBpbnN0YW5jZW9mIFJlZ0V4cCkge1xuICAgICAgLy8gZGVwcmVjYXRlZFxuICAgICAgY29uc3QgcmVnZXggPSBmbjtcbiAgICAgIGZuID0gKHZhbCwgZGVmKSA9PiB7XG4gICAgICAgIGNvbnN0IG0gPSByZWdleC5leGVjKHZhbCk7XG4gICAgICAgIHJldHVybiBtID8gbVswXSA6IGRlZjtcbiAgICAgIH07XG4gICAgICBvcHRpb24uZGVmYXVsdChkZWZhdWx0VmFsdWUpLmFyZ1BhcnNlcihmbik7XG4gICAgfSBlbHNlIHtcbiAgICAgIG9wdGlvbi5kZWZhdWx0KGZuKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5hZGRPcHRpb24ob3B0aW9uKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBEZWZpbmUgb3B0aW9uIHdpdGggYGZsYWdzYCwgYGRlc2NyaXB0aW9uYCBhbmQgb3B0aW9uYWxcbiAgICogY29lcmNpb24gYGZuYC5cbiAgICpcbiAgICogVGhlIGBmbGFnc2Agc3RyaW5nIGNvbnRhaW5zIHRoZSBzaG9ydCBhbmQvb3IgbG9uZyBmbGFncyxcbiAgICogc2VwYXJhdGVkIGJ5IGNvbW1hLCBhIHBpcGUgb3Igc3BhY2UuIFRoZSBmb2xsb3dpbmcgYXJlIGFsbCB2YWxpZFxuICAgKiBhbGwgd2lsbCBvdXRwdXQgdGhpcyB3YXkgd2hlbiBgLS1oZWxwYCBpcyB1c2VkLlxuICAgKlxuICAgKiAgICBcIi1wLCAtLXBlcHBlclwiXG4gICAqICAgIFwiLXB8LS1wZXBwZXJcIlxuICAgKiAgICBcIi1wIC0tcGVwcGVyXCJcbiAgICpcbiAgICogRXhhbXBsZXM6XG4gICAqXG4gICAqICAgICAvLyBzaW1wbGUgYm9vbGVhbiBkZWZhdWx0aW5nIHRvIHVuZGVmaW5lZFxuICAgKiAgICAgcHJvZ3JhbS5vcHRpb24oJy1wLCAtLXBlcHBlcicsICdhZGQgcGVwcGVyJyk7XG4gICAqXG4gICAqICAgICBwcm9ncmFtLnBlcHBlclxuICAgKiAgICAgLy8gPT4gdW5kZWZpbmVkXG4gICAqXG4gICAqICAgICAtLXBlcHBlclxuICAgKiAgICAgcHJvZ3JhbS5wZXBwZXJcbiAgICogICAgIC8vID0+IHRydWVcbiAgICpcbiAgICogICAgIC8vIHNpbXBsZSBib29sZWFuIGRlZmF1bHRpbmcgdG8gdHJ1ZSAodW5sZXNzIG5vbi1uZWdhdGVkIG9wdGlvbiBpcyBhbHNvIGRlZmluZWQpXG4gICAqICAgICBwcm9ncmFtLm9wdGlvbignLUMsIC0tbm8tY2hlZXNlJywgJ3JlbW92ZSBjaGVlc2UnKTtcbiAgICpcbiAgICogICAgIHByb2dyYW0uY2hlZXNlXG4gICAqICAgICAvLyA9PiB0cnVlXG4gICAqXG4gICAqICAgICAtLW5vLWNoZWVzZVxuICAgKiAgICAgcHJvZ3JhbS5jaGVlc2VcbiAgICogICAgIC8vID0+IGZhbHNlXG4gICAqXG4gICAqICAgICAvLyByZXF1aXJlZCBhcmd1bWVudFxuICAgKiAgICAgcHJvZ3JhbS5vcHRpb24oJy1DLCAtLWNoZGlyIDxwYXRoPicsICdjaGFuZ2UgdGhlIHdvcmtpbmcgZGlyZWN0b3J5Jyk7XG4gICAqXG4gICAqICAgICAtLWNoZGlyIC90bXBcbiAgICogICAgIHByb2dyYW0uY2hkaXJcbiAgICogICAgIC8vID0+IFwiL3RtcFwiXG4gICAqXG4gICAqICAgICAvLyBvcHRpb25hbCBhcmd1bWVudFxuICAgKiAgICAgcHJvZ3JhbS5vcHRpb24oJy1jLCAtLWNoZWVzZSBbdHlwZV0nLCAnYWRkIGNoZWVzZSBbbWFyYmxlXScpO1xuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gZmxhZ3NcbiAgICogQHBhcmFtIHtzdHJpbmd9IFtkZXNjcmlwdGlvbl1cbiAgICogQHBhcmFtIHtGdW5jdGlvbnwqfSBbZm5dIC0gY3VzdG9tIG9wdGlvbiBwcm9jZXNzaW5nIGZ1bmN0aW9uIG9yIGRlZmF1bHQgdmFsdWVcbiAgICogQHBhcmFtIHsqfSBbZGVmYXVsdFZhbHVlXVxuICAgKiBAcmV0dXJuIHtDb21tYW5kfSBgdGhpc2AgY29tbWFuZCBmb3IgY2hhaW5pbmdcbiAgICovXG5cbiAgb3B0aW9uKGZsYWdzLCBkZXNjcmlwdGlvbiwgZm4sIGRlZmF1bHRWYWx1ZSkge1xuICAgIHJldHVybiB0aGlzLl9vcHRpb25FeCh7fSwgZmxhZ3MsIGRlc2NyaXB0aW9uLCBmbiwgZGVmYXVsdFZhbHVlKTtcbiAgfTtcblxuICAvKipcbiAgKiBBZGQgYSByZXF1aXJlZCBvcHRpb24gd2hpY2ggbXVzdCBoYXZlIGEgdmFsdWUgYWZ0ZXIgcGFyc2luZy4gVGhpcyB1c3VhbGx5IG1lYW5zXG4gICogdGhlIG9wdGlvbiBtdXN0IGJlIHNwZWNpZmllZCBvbiB0aGUgY29tbWFuZCBsaW5lLiAoT3RoZXJ3aXNlIHRoZSBzYW1lIGFzIC5vcHRpb24oKS4pXG4gICpcbiAgKiBUaGUgYGZsYWdzYCBzdHJpbmcgY29udGFpbnMgdGhlIHNob3J0IGFuZC9vciBsb25nIGZsYWdzLCBzZXBhcmF0ZWQgYnkgY29tbWEsIGEgcGlwZSBvciBzcGFjZS5cbiAgKlxuICAqIEBwYXJhbSB7c3RyaW5nfSBmbGFnc1xuICAqIEBwYXJhbSB7c3RyaW5nfSBbZGVzY3JpcHRpb25dXG4gICogQHBhcmFtIHtGdW5jdGlvbnwqfSBbZm5dIC0gY3VzdG9tIG9wdGlvbiBwcm9jZXNzaW5nIGZ1bmN0aW9uIG9yIGRlZmF1bHQgdmFsdWVcbiAgKiBAcGFyYW0geyp9IFtkZWZhdWx0VmFsdWVdXG4gICogQHJldHVybiB7Q29tbWFuZH0gYHRoaXNgIGNvbW1hbmQgZm9yIGNoYWluaW5nXG4gICovXG5cbiAgcmVxdWlyZWRPcHRpb24oZmxhZ3MsIGRlc2NyaXB0aW9uLCBmbiwgZGVmYXVsdFZhbHVlKSB7XG4gICAgcmV0dXJuIHRoaXMuX29wdGlvbkV4KHsgbWFuZGF0b3J5OiB0cnVlIH0sIGZsYWdzLCBkZXNjcmlwdGlvbiwgZm4sIGRlZmF1bHRWYWx1ZSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEFsdGVyIHBhcnNpbmcgb2Ygc2hvcnQgZmxhZ3Mgd2l0aCBvcHRpb25hbCB2YWx1ZXMuXG4gICAqXG4gICAqIEV4YW1wbGVzOlxuICAgKlxuICAgKiAgICAvLyBmb3IgYC5vcHRpb24oJy1mLC0tZmxhZyBbdmFsdWVdJyk6XG4gICAqICAgIC5jb21iaW5lRmxhZ0FuZE9wdGlvbmFsVmFsdWUodHJ1ZSkgIC8vIGAtZjgwYCBpcyB0cmVhdGVkIGxpa2UgYC0tZmxhZz04MGAsIHRoaXMgaXMgdGhlIGRlZmF1bHQgYmVoYXZpb3VyXG4gICAqICAgIC5jb21iaW5lRmxhZ0FuZE9wdGlvbmFsVmFsdWUoZmFsc2UpIC8vIGAtZmJgIGlzIHRyZWF0ZWQgbGlrZSBgLWYgLWJgXG4gICAqXG4gICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2NvbWJpbmU9dHJ1ZV0gLSBpZiBgdHJ1ZWAgb3Igb21pdHRlZCwgYW4gb3B0aW9uYWwgdmFsdWUgY2FuIGJlIHNwZWNpZmllZCBkaXJlY3RseSBhZnRlciB0aGUgZmxhZy5cbiAgICovXG4gIGNvbWJpbmVGbGFnQW5kT3B0aW9uYWxWYWx1ZShjb21iaW5lID0gdHJ1ZSkge1xuICAgIHRoaXMuX2NvbWJpbmVGbGFnQW5kT3B0aW9uYWxWYWx1ZSA9ICEhY29tYmluZTtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICAvKipcbiAgICogQWxsb3cgdW5rbm93biBvcHRpb25zIG9uIHRoZSBjb21tYW5kIGxpbmUuXG4gICAqXG4gICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2FsbG93VW5rbm93bj10cnVlXSAtIGlmIGB0cnVlYCBvciBvbWl0dGVkLCBubyBlcnJvciB3aWxsIGJlIHRocm93blxuICAgKiBmb3IgdW5rbm93biBvcHRpb25zLlxuICAgKi9cbiAgYWxsb3dVbmtub3duT3B0aW9uKGFsbG93VW5rbm93biA9IHRydWUpIHtcbiAgICB0aGlzLl9hbGxvd1Vua25vd25PcHRpb24gPSAhIWFsbG93VW5rbm93bjtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICAvKipcbiAgICogQWxsb3cgZXhjZXNzIGNvbW1hbmQtYXJndW1lbnRzIG9uIHRoZSBjb21tYW5kIGxpbmUuIFBhc3MgZmFsc2UgdG8gbWFrZSBleGNlc3MgYXJndW1lbnRzIGFuIGVycm9yLlxuICAgKlxuICAgKiBAcGFyYW0ge0Jvb2xlYW59IFthbGxvd0V4Y2Vzcz10cnVlXSAtIGlmIGB0cnVlYCBvciBvbWl0dGVkLCBubyBlcnJvciB3aWxsIGJlIHRocm93blxuICAgKiBmb3IgZXhjZXNzIGFyZ3VtZW50cy5cbiAgICovXG4gIGFsbG93RXhjZXNzQXJndW1lbnRzKGFsbG93RXhjZXNzID0gdHJ1ZSkge1xuICAgIHRoaXMuX2FsbG93RXhjZXNzQXJndW1lbnRzID0gISFhbGxvd0V4Y2VzcztcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICAvKipcbiAgICogRW5hYmxlIHBvc2l0aW9uYWwgb3B0aW9ucy4gUG9zaXRpb25hbCBtZWFucyBnbG9iYWwgb3B0aW9ucyBhcmUgc3BlY2lmaWVkIGJlZm9yZSBzdWJjb21tYW5kcyB3aGljaCBsZXRzXG4gICAqIHN1YmNvbW1hbmRzIHJldXNlIHRoZSBzYW1lIG9wdGlvbiBuYW1lcywgYW5kIGFsc28gZW5hYmxlcyBzdWJjb21tYW5kcyB0byB0dXJuIG9uIHBhc3NUaHJvdWdoT3B0aW9ucy5cbiAgICogVGhlIGRlZmF1bHQgYmVoYXZpb3VyIGlzIG5vbi1wb3NpdGlvbmFsIGFuZCBnbG9iYWwgb3B0aW9ucyBtYXkgYXBwZWFyIGFueXdoZXJlIG9uIHRoZSBjb21tYW5kIGxpbmUuXG4gICAqXG4gICAqIEBwYXJhbSB7Qm9vbGVhbn0gW3Bvc2l0aW9uYWw9dHJ1ZV1cbiAgICovXG4gIGVuYWJsZVBvc2l0aW9uYWxPcHRpb25zKHBvc2l0aW9uYWwgPSB0cnVlKSB7XG4gICAgdGhpcy5fZW5hYmxlUG9zaXRpb25hbE9wdGlvbnMgPSAhIXBvc2l0aW9uYWw7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIFBhc3MgdGhyb3VnaCBvcHRpb25zIHRoYXQgY29tZSBhZnRlciBjb21tYW5kLWFyZ3VtZW50cyByYXRoZXIgdGhhbiB0cmVhdCB0aGVtIGFzIGNvbW1hbmQtb3B0aW9ucyxcbiAgICogc28gYWN0dWFsIGNvbW1hbmQtb3B0aW9ucyBjb21lIGJlZm9yZSBjb21tYW5kLWFyZ3VtZW50cy4gVHVybmluZyB0aGlzIG9uIGZvciBhIHN1YmNvbW1hbmQgcmVxdWlyZXNcbiAgICogcG9zaXRpb25hbCBvcHRpb25zIHRvIGhhdmUgYmVlbiBlbmFibGVkIG9uIHRoZSBwcm9ncmFtIChwYXJlbnQgY29tbWFuZHMpLlxuICAgKiBUaGUgZGVmYXVsdCBiZWhhdmlvdXIgaXMgbm9uLXBvc2l0aW9uYWwgYW5kIG9wdGlvbnMgbWF5IGFwcGVhciBiZWZvcmUgb3IgYWZ0ZXIgY29tbWFuZC1hcmd1bWVudHMuXG4gICAqXG4gICAqIEBwYXJhbSB7Qm9vbGVhbn0gW3Bhc3NUaHJvdWdoPXRydWVdXG4gICAqIGZvciB1bmtub3duIG9wdGlvbnMuXG4gICAqL1xuICBwYXNzVGhyb3VnaE9wdGlvbnMocGFzc1Rocm91Z2ggPSB0cnVlKSB7XG4gICAgdGhpcy5fcGFzc1Rocm91Z2hPcHRpb25zID0gISFwYXNzVGhyb3VnaDtcbiAgICBpZiAoISF0aGlzLnBhcmVudCAmJiBwYXNzVGhyb3VnaCAmJiAhdGhpcy5wYXJlbnQuX2VuYWJsZVBvc2l0aW9uYWxPcHRpb25zKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ3Bhc3NUaHJvdWdoT3B0aW9ucyBjYW4gbm90IGJlIHVzZWQgd2l0aG91dCB0dXJuaW5nIG9uIGVuYWJsZVBvc2l0aW9uYWxPcHRpb25zIGZvciBwYXJlbnQgY29tbWFuZChzKScpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICAvKipcbiAgICAqIFdoZXRoZXIgdG8gc3RvcmUgb3B0aW9uIHZhbHVlcyBhcyBwcm9wZXJ0aWVzIG9uIGNvbW1hbmQgb2JqZWN0LFxuICAgICogb3Igc3RvcmUgc2VwYXJhdGVseSAoc3BlY2lmeSBmYWxzZSkuIEluIGJvdGggY2FzZXMgdGhlIG9wdGlvbiB2YWx1ZXMgY2FuIGJlIGFjY2Vzc2VkIHVzaW5nIC5vcHRzKCkuXG4gICAgKlxuICAgICogQHBhcmFtIHtib29sZWFufSBbc3RvcmVBc1Byb3BlcnRpZXM9dHJ1ZV1cbiAgICAqIEByZXR1cm4ge0NvbW1hbmR9IGB0aGlzYCBjb21tYW5kIGZvciBjaGFpbmluZ1xuICAgICovXG5cbiAgc3RvcmVPcHRpb25zQXNQcm9wZXJ0aWVzKHN0b3JlQXNQcm9wZXJ0aWVzID0gdHJ1ZSkge1xuICAgIHRoaXMuX3N0b3JlT3B0aW9uc0FzUHJvcGVydGllcyA9ICEhc3RvcmVBc1Byb3BlcnRpZXM7XG4gICAgaWYgKHRoaXMub3B0aW9ucy5sZW5ndGgpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignY2FsbCAuc3RvcmVPcHRpb25zQXNQcm9wZXJ0aWVzKCkgYmVmb3JlIGFkZGluZyBvcHRpb25zJyk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIC8qKlxuICAgKiBTdG9yZSBvcHRpb24gdmFsdWVcbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IGtleVxuICAgKiBAcGFyYW0ge09iamVjdH0gdmFsdWVcbiAgICogQGFwaSBwcml2YXRlXG4gICAqL1xuXG4gIF9zZXRPcHRpb25WYWx1ZShrZXksIHZhbHVlKSB7XG4gICAgaWYgKHRoaXMuX3N0b3JlT3B0aW9uc0FzUHJvcGVydGllcykge1xuICAgICAgdGhpc1trZXldID0gdmFsdWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX29wdGlvblZhbHVlc1trZXldID0gdmFsdWU7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBSZXRyaWV2ZSBvcHRpb24gdmFsdWVcbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IGtleVxuICAgKiBAcmV0dXJuIHtPYmplY3R9IHZhbHVlXG4gICAqIEBhcGkgcHJpdmF0ZVxuICAgKi9cblxuICBfZ2V0T3B0aW9uVmFsdWUoa2V5KSB7XG4gICAgaWYgKHRoaXMuX3N0b3JlT3B0aW9uc0FzUHJvcGVydGllcykge1xuICAgICAgcmV0dXJuIHRoaXNba2V5XTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuX29wdGlvblZhbHVlc1trZXldO1xuICB9O1xuXG4gIC8qKlxuICAgKiBQYXJzZSBgYXJndmAsIHNldHRpbmcgb3B0aW9ucyBhbmQgaW52b2tpbmcgY29tbWFuZHMgd2hlbiBkZWZpbmVkLlxuICAgKlxuICAgKiBUaGUgZGVmYXVsdCBleHBlY3RhdGlvbiBpcyB0aGF0IHRoZSBhcmd1bWVudHMgYXJlIGZyb20gbm9kZSBhbmQgaGF2ZSB0aGUgYXBwbGljYXRpb24gYXMgYXJndlswXVxuICAgKiBhbmQgdGhlIHNjcmlwdCBiZWluZyBydW4gaW4gYXJndlsxXSwgd2l0aCB1c2VyIHBhcmFtZXRlcnMgYWZ0ZXIgdGhhdC5cbiAgICpcbiAgICogRXhhbXBsZXM6XG4gICAqXG4gICAqICAgICAgcHJvZ3JhbS5wYXJzZShwcm9jZXNzLmFyZ3YpO1xuICAgKiAgICAgIHByb2dyYW0ucGFyc2UoKTsgLy8gaW1wbGljaXRseSB1c2UgcHJvY2Vzcy5hcmd2IGFuZCBhdXRvLWRldGVjdCBub2RlIHZzIGVsZWN0cm9uIGNvbnZlbnRpb25zXG4gICAqICAgICAgcHJvZ3JhbS5wYXJzZShteS1hcmdzLCB7IGZyb206ICd1c2VyJyB9KTsgLy8ganVzdCB1c2VyIHN1cHBsaWVkIGFyZ3VtZW50cywgbm90aGluZyBzcGVjaWFsIGFib3V0IGFyZ3ZbMF1cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmdbXX0gW2FyZ3ZdIC0gb3B0aW9uYWwsIGRlZmF1bHRzIHRvIHByb2Nlc3MuYXJndlxuICAgKiBAcGFyYW0ge09iamVjdH0gW3BhcnNlT3B0aW9uc10gLSBvcHRpb25hbGx5IHNwZWNpZnkgc3R5bGUgb2Ygb3B0aW9ucyB3aXRoIGZyb206IG5vZGUvdXNlci9lbGVjdHJvblxuICAgKiBAcGFyYW0ge3N0cmluZ30gW3BhcnNlT3B0aW9ucy5mcm9tXSAtIHdoZXJlIHRoZSBhcmdzIGFyZSBmcm9tOiAnbm9kZScsICd1c2VyJywgJ2VsZWN0cm9uJ1xuICAgKiBAcmV0dXJuIHtDb21tYW5kfSBgdGhpc2AgY29tbWFuZCBmb3IgY2hhaW5pbmdcbiAgICovXG5cbiAgcGFyc2UoYXJndiwgcGFyc2VPcHRpb25zKSB7XG4gICAgaWYgKGFyZ3YgIT09IHVuZGVmaW5lZCAmJiAhQXJyYXkuaXNBcnJheShhcmd2KSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdmaXJzdCBwYXJhbWV0ZXIgdG8gcGFyc2UgbXVzdCBiZSBhcnJheSBvciB1bmRlZmluZWQnKTtcbiAgICB9XG4gICAgcGFyc2VPcHRpb25zID0gcGFyc2VPcHRpb25zIHx8IHt9O1xuXG4gICAgLy8gRGVmYXVsdCB0byB1c2luZyBwcm9jZXNzLmFyZ3ZcbiAgICBpZiAoYXJndiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBhcmd2ID0gcHJvY2Vzcy5hcmd2O1xuICAgICAgLy8gQHRzLWlnbm9yZTogdW5rbm93biBwcm9wZXJ0eVxuICAgICAgaWYgKHByb2Nlc3MudmVyc2lvbnMgJiYgcHJvY2Vzcy52ZXJzaW9ucy5lbGVjdHJvbikge1xuICAgICAgICBwYXJzZU9wdGlvbnMuZnJvbSA9ICdlbGVjdHJvbic7XG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMucmF3QXJncyA9IGFyZ3Yuc2xpY2UoKTtcblxuICAgIC8vIG1ha2UgaXQgYSBsaXR0bGUgZWFzaWVyIGZvciBjYWxsZXJzIGJ5IHN1cHBvcnRpbmcgdmFyaW91cyBhcmd2IGNvbnZlbnRpb25zXG4gICAgbGV0IHVzZXJBcmdzO1xuICAgIHN3aXRjaCAocGFyc2VPcHRpb25zLmZyb20pIHtcbiAgICAgIGNhc2UgdW5kZWZpbmVkOlxuICAgICAgY2FzZSAnbm9kZSc6XG4gICAgICAgIHRoaXMuX3NjcmlwdFBhdGggPSBhcmd2WzFdO1xuICAgICAgICB1c2VyQXJncyA9IGFyZ3Yuc2xpY2UoMik7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnZWxlY3Ryb24nOlxuICAgICAgICAvLyBAdHMtaWdub3JlOiB1bmtub3duIHByb3BlcnR5XG4gICAgICAgIGlmIChwcm9jZXNzLmRlZmF1bHRBcHApIHtcbiAgICAgICAgICB0aGlzLl9zY3JpcHRQYXRoID0gYXJndlsxXTtcbiAgICAgICAgICB1c2VyQXJncyA9IGFyZ3Yuc2xpY2UoMik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdXNlckFyZ3MgPSBhcmd2LnNsaWNlKDEpO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAndXNlcic6XG4gICAgICAgIHVzZXJBcmdzID0gYXJndi5zbGljZSgwKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYHVuZXhwZWN0ZWQgcGFyc2Ugb3B0aW9uIHsgZnJvbTogJyR7cGFyc2VPcHRpb25zLmZyb219JyB9YCk7XG4gICAgfVxuICAgIGlmICghdGhpcy5fc2NyaXB0UGF0aCAmJiByZXF1aXJlLm1haW4pIHtcbiAgICAgIHRoaXMuX3NjcmlwdFBhdGggPSByZXF1aXJlLm1haW4uZmlsZW5hbWU7XG4gICAgfVxuXG4gICAgLy8gR3Vlc3MgbmFtZSwgdXNlZCBpbiB1c2FnZSBpbiBoZWxwLlxuICAgIHRoaXMuX25hbWUgPSB0aGlzLl9uYW1lIHx8ICh0aGlzLl9zY3JpcHRQYXRoICYmIHBhdGguYmFzZW5hbWUodGhpcy5fc2NyaXB0UGF0aCwgcGF0aC5leHRuYW1lKHRoaXMuX3NjcmlwdFBhdGgpKSk7XG5cbiAgICAvLyBMZXQncyBnbyFcbiAgICB0aGlzLl9wYXJzZUNvbW1hbmQoW10sIHVzZXJBcmdzKTtcblxuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIC8qKlxuICAgKiBQYXJzZSBgYXJndmAsIHNldHRpbmcgb3B0aW9ucyBhbmQgaW52b2tpbmcgY29tbWFuZHMgd2hlbiBkZWZpbmVkLlxuICAgKlxuICAgKiBVc2UgcGFyc2VBc3luYyBpbnN0ZWFkIG9mIHBhcnNlIGlmIGFueSBvZiB5b3VyIGFjdGlvbiBoYW5kbGVycyBhcmUgYXN5bmMuIFJldHVybnMgYSBQcm9taXNlLlxuICAgKlxuICAgKiBUaGUgZGVmYXVsdCBleHBlY3RhdGlvbiBpcyB0aGF0IHRoZSBhcmd1bWVudHMgYXJlIGZyb20gbm9kZSBhbmQgaGF2ZSB0aGUgYXBwbGljYXRpb24gYXMgYXJndlswXVxuICAgKiBhbmQgdGhlIHNjcmlwdCBiZWluZyBydW4gaW4gYXJndlsxXSwgd2l0aCB1c2VyIHBhcmFtZXRlcnMgYWZ0ZXIgdGhhdC5cbiAgICpcbiAgICogRXhhbXBsZXM6XG4gICAqXG4gICAqICAgICAgcHJvZ3JhbS5wYXJzZUFzeW5jKHByb2Nlc3MuYXJndik7XG4gICAqICAgICAgcHJvZ3JhbS5wYXJzZUFzeW5jKCk7IC8vIGltcGxpY2l0bHkgdXNlIHByb2Nlc3MuYXJndiBhbmQgYXV0by1kZXRlY3Qgbm9kZSB2cyBlbGVjdHJvbiBjb252ZW50aW9uc1xuICAgKiAgICAgIHByb2dyYW0ucGFyc2VBc3luYyhteS1hcmdzLCB7IGZyb206ICd1c2VyJyB9KTsgLy8ganVzdCB1c2VyIHN1cHBsaWVkIGFyZ3VtZW50cywgbm90aGluZyBzcGVjaWFsIGFib3V0IGFyZ3ZbMF1cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmdbXX0gW2FyZ3ZdXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBbcGFyc2VPcHRpb25zXVxuICAgKiBAcGFyYW0ge3N0cmluZ30gcGFyc2VPcHRpb25zLmZyb20gLSB3aGVyZSB0aGUgYXJncyBhcmUgZnJvbTogJ25vZGUnLCAndXNlcicsICdlbGVjdHJvbidcbiAgICogQHJldHVybiB7UHJvbWlzZX1cbiAgICovXG5cbiAgcGFyc2VBc3luYyhhcmd2LCBwYXJzZU9wdGlvbnMpIHtcbiAgICB0aGlzLnBhcnNlKGFyZ3YsIHBhcnNlT3B0aW9ucyk7XG4gICAgcmV0dXJuIFByb21pc2UuYWxsKHRoaXMuX2FjdGlvblJlc3VsdHMpLnRoZW4oKCkgPT4gdGhpcyk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEV4ZWN1dGUgYSBzdWItY29tbWFuZCBleGVjdXRhYmxlLlxuICAgKlxuICAgKiBAYXBpIHByaXZhdGVcbiAgICovXG5cbiAgX2V4ZWN1dGVTdWJDb21tYW5kKHN1YmNvbW1hbmQsIGFyZ3MpIHtcbiAgICBhcmdzID0gYXJncy5zbGljZSgpO1xuICAgIGxldCBsYXVuY2hXaXRoTm9kZSA9IGZhbHNlOyAvLyBVc2Ugbm9kZSBmb3Igc291cmNlIHRhcmdldHMgc28gZG8gbm90IG5lZWQgdG8gZ2V0IHBlcm1pc3Npb25zIGNvcnJlY3QsIGFuZCBvbiBXaW5kb3dzLlxuICAgIGNvbnN0IHNvdXJjZUV4dCA9IFsnLmpzJywgJy50cycsICcudHN4JywgJy5tanMnLCAnLmNqcyddO1xuXG4gICAgLy8gTm90IGNoZWNraW5nIGZvciBoZWxwIGZpcnN0LiBVbmxpa2VseSB0byBoYXZlIG1hbmRhdG9yeSBhbmQgZXhlY3V0YWJsZSwgYW5kIGNhbid0IHJvYnVzdGx5IHRlc3QgZm9yIGhlbHAgZmxhZ3MgaW4gZXh0ZXJuYWwgY29tbWFuZC5cbiAgICB0aGlzLl9jaGVja0Zvck1pc3NpbmdNYW5kYXRvcnlPcHRpb25zKCk7XG5cbiAgICAvLyBXYW50IHRoZSBlbnRyeSBzY3JpcHQgYXMgdGhlIHJlZmVyZW5jZSBmb3IgY29tbWFuZCBuYW1lIGFuZCBkaXJlY3RvcnkgZm9yIHNlYXJjaGluZyBmb3Igb3RoZXIgZmlsZXMuXG4gICAgbGV0IHNjcmlwdFBhdGggPSB0aGlzLl9zY3JpcHRQYXRoO1xuICAgIC8vIEZhbGxiYWNrIGluIGNhc2Ugbm90IHNldCwgZHVlIHRvIGhvdyBDb21tYW5kIGNyZWF0ZWQgb3IgY2FsbGVkLlxuICAgIGlmICghc2NyaXB0UGF0aCAmJiByZXF1aXJlLm1haW4pIHtcbiAgICAgIHNjcmlwdFBhdGggPSByZXF1aXJlLm1haW4uZmlsZW5hbWU7XG4gICAgfVxuXG4gICAgbGV0IGJhc2VEaXI7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc29sdmVkTGluayA9IGZzLnJlYWxwYXRoU3luYyhzY3JpcHRQYXRoKTtcbiAgICAgIGJhc2VEaXIgPSBwYXRoLmRpcm5hbWUocmVzb2x2ZWRMaW5rKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBiYXNlRGlyID0gJy4nOyAvLyBkdW1teSwgcHJvYmFibHkgbm90IGdvaW5nIHRvIGZpbmQgZXhlY3V0YWJsZSFcbiAgICB9XG5cbiAgICAvLyBuYW1lIG9mIHRoZSBzdWJjb21tYW5kLCBsaWtlIGBwbS1pbnN0YWxsYFxuICAgIGxldCBiaW4gPSBwYXRoLmJhc2VuYW1lKHNjcmlwdFBhdGgsIHBhdGguZXh0bmFtZShzY3JpcHRQYXRoKSkgKyAnLScgKyBzdWJjb21tYW5kLl9uYW1lO1xuICAgIGlmIChzdWJjb21tYW5kLl9leGVjdXRhYmxlRmlsZSkge1xuICAgICAgYmluID0gc3ViY29tbWFuZC5fZXhlY3V0YWJsZUZpbGU7XG4gICAgfVxuXG4gICAgY29uc3QgbG9jYWxCaW4gPSBwYXRoLmpvaW4oYmFzZURpciwgYmluKTtcbiAgICBpZiAoZnMuZXhpc3RzU3luYyhsb2NhbEJpbikpIHtcbiAgICAgIC8vIHByZWZlciBsb2NhbCBgLi88YmluPmAgdG8gYmluIGluIHRoZSAkUEFUSFxuICAgICAgYmluID0gbG9jYWxCaW47XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIExvb2sgZm9yIHNvdXJjZSBmaWxlcy5cbiAgICAgIHNvdXJjZUV4dC5mb3JFYWNoKChleHQpID0+IHtcbiAgICAgICAgaWYgKGZzLmV4aXN0c1N5bmMoYCR7bG9jYWxCaW59JHtleHR9YCkpIHtcbiAgICAgICAgICBiaW4gPSBgJHtsb2NhbEJpbn0ke2V4dH1gO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gICAgbGF1bmNoV2l0aE5vZGUgPSBzb3VyY2VFeHQuaW5jbHVkZXMocGF0aC5leHRuYW1lKGJpbikpO1xuXG4gICAgbGV0IHByb2M7XG4gICAgaWYgKHByb2Nlc3MucGxhdGZvcm0gIT09ICd3aW4zMicpIHtcbiAgICAgIGlmIChsYXVuY2hXaXRoTm9kZSkge1xuICAgICAgICBhcmdzLnVuc2hpZnQoYmluKTtcbiAgICAgICAgLy8gYWRkIGV4ZWN1dGFibGUgYXJndW1lbnRzIHRvIHNwYXduXG4gICAgICAgIGFyZ3MgPSBpbmNyZW1lbnROb2RlSW5zcGVjdG9yUG9ydChwcm9jZXNzLmV4ZWNBcmd2KS5jb25jYXQoYXJncyk7XG5cbiAgICAgICAgcHJvYyA9IGNoaWxkUHJvY2Vzcy5zcGF3bihwcm9jZXNzLmFyZ3ZbMF0sIGFyZ3MsIHsgc3RkaW86ICdpbmhlcml0JyB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHByb2MgPSBjaGlsZFByb2Nlc3Muc3Bhd24oYmluLCBhcmdzLCB7IHN0ZGlvOiAnaW5oZXJpdCcgfSk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGFyZ3MudW5zaGlmdChiaW4pO1xuICAgICAgLy8gYWRkIGV4ZWN1dGFibGUgYXJndW1lbnRzIHRvIHNwYXduXG4gICAgICBhcmdzID0gaW5jcmVtZW50Tm9kZUluc3BlY3RvclBvcnQocHJvY2Vzcy5leGVjQXJndikuY29uY2F0KGFyZ3MpO1xuICAgICAgcHJvYyA9IGNoaWxkUHJvY2Vzcy5zcGF3bihwcm9jZXNzLmV4ZWNQYXRoLCBhcmdzLCB7IHN0ZGlvOiAnaW5oZXJpdCcgfSk7XG4gICAgfVxuXG4gICAgY29uc3Qgc2lnbmFscyA9IFsnU0lHVVNSMScsICdTSUdVU1IyJywgJ1NJR1RFUk0nLCAnU0lHSU5UJywgJ1NJR0hVUCddO1xuICAgIHNpZ25hbHMuZm9yRWFjaCgoc2lnbmFsKSA9PiB7XG4gICAgICAvLyBAdHMtaWdub3JlXG4gICAgICBwcm9jZXNzLm9uKHNpZ25hbCwgKCkgPT4ge1xuICAgICAgICBpZiAocHJvYy5raWxsZWQgPT09IGZhbHNlICYmIHByb2MuZXhpdENvZGUgPT09IG51bGwpIHtcbiAgICAgICAgICBwcm9jLmtpbGwoc2lnbmFsKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvLyBCeSBkZWZhdWx0IHRlcm1pbmF0ZSBwcm9jZXNzIHdoZW4gc3Bhd25lZCBwcm9jZXNzIHRlcm1pbmF0ZXMuXG4gICAgLy8gU3VwcHJlc3NpbmcgdGhlIGV4aXQgaWYgZXhpdENhbGxiYWNrIGRlZmluZWQgaXMgYSBiaXQgbWVzc3kgYW5kIG9mIGxpbWl0ZWQgdXNlLCBidXQgZG9lcyBhbGxvdyBwcm9jZXNzIHRvIHN0YXkgcnVubmluZyFcbiAgICBjb25zdCBleGl0Q2FsbGJhY2sgPSB0aGlzLl9leGl0Q2FsbGJhY2s7XG4gICAgaWYgKCFleGl0Q2FsbGJhY2spIHtcbiAgICAgIHByb2Mub24oJ2Nsb3NlJywgcHJvY2Vzcy5leGl0LmJpbmQocHJvY2VzcykpO1xuICAgIH0gZWxzZSB7XG4gICAgICBwcm9jLm9uKCdjbG9zZScsICgpID0+IHtcbiAgICAgICAgZXhpdENhbGxiYWNrKG5ldyBDb21tYW5kZXJFcnJvcihwcm9jZXNzLmV4aXRDb2RlIHx8IDAsICdjb21tYW5kZXIuZXhlY3V0ZVN1YkNvbW1hbmRBc3luYycsICcoY2xvc2UpJykpO1xuICAgICAgfSk7XG4gICAgfVxuICAgIHByb2Mub24oJ2Vycm9yJywgKGVycikgPT4ge1xuICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgaWYgKGVyci5jb2RlID09PSAnRU5PRU5UJykge1xuICAgICAgICBjb25zdCBleGVjdXRhYmxlTWlzc2luZyA9IGAnJHtiaW59JyBkb2VzIG5vdCBleGlzdFxuIC0gaWYgJyR7c3ViY29tbWFuZC5fbmFtZX0nIGlzIG5vdCBtZWFudCB0byBiZSBhbiBleGVjdXRhYmxlIGNvbW1hbmQsIHJlbW92ZSBkZXNjcmlwdGlvbiBwYXJhbWV0ZXIgZnJvbSAnLmNvbW1hbmQoKScgYW5kIHVzZSAnLmRlc2NyaXB0aW9uKCknIGluc3RlYWRcbiAtIGlmIHRoZSBkZWZhdWx0IGV4ZWN1dGFibGUgbmFtZSBpcyBub3Qgc3VpdGFibGUsIHVzZSB0aGUgZXhlY3V0YWJsZUZpbGUgb3B0aW9uIHRvIHN1cHBseSBhIGN1c3RvbSBuYW1lYDtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGV4ZWN1dGFibGVNaXNzaW5nKTtcbiAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgIH0gZWxzZSBpZiAoZXJyLmNvZGUgPT09ICdFQUNDRVMnKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgJyR7YmlufScgbm90IGV4ZWN1dGFibGVgKTtcbiAgICAgIH1cbiAgICAgIGlmICghZXhpdENhbGxiYWNrKSB7XG4gICAgICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IHdyYXBwZWRFcnJvciA9IG5ldyBDb21tYW5kZXJFcnJvcigxLCAnY29tbWFuZGVyLmV4ZWN1dGVTdWJDb21tYW5kQXN5bmMnLCAnKGVycm9yKScpO1xuICAgICAgICB3cmFwcGVkRXJyb3IubmVzdGVkRXJyb3IgPSBlcnI7XG4gICAgICAgIGV4aXRDYWxsYmFjayh3cmFwcGVkRXJyb3IpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gU3RvcmUgdGhlIHJlZmVyZW5jZSB0byB0aGUgY2hpbGQgcHJvY2Vzc1xuICAgIHRoaXMucnVubmluZ0NvbW1hbmQgPSBwcm9jO1xuICB9O1xuXG4gIC8qKlxuICAgKiBAYXBpIHByaXZhdGVcbiAgICovXG4gIF9kaXNwYXRjaFN1YmNvbW1hbmQoY29tbWFuZE5hbWUsIG9wZXJhbmRzLCB1bmtub3duKSB7XG4gICAgY29uc3Qgc3ViQ29tbWFuZCA9IHRoaXMuX2ZpbmRDb21tYW5kKGNvbW1hbmROYW1lKTtcbiAgICBpZiAoIXN1YkNvbW1hbmQpIHRoaXMuaGVscCh7IGVycm9yOiB0cnVlIH0pO1xuXG4gICAgaWYgKHN1YkNvbW1hbmQuX2V4ZWN1dGFibGVIYW5kbGVyKSB7XG4gICAgICB0aGlzLl9leGVjdXRlU3ViQ29tbWFuZChzdWJDb21tYW5kLCBvcGVyYW5kcy5jb25jYXQodW5rbm93bikpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzdWJDb21tYW5kLl9wYXJzZUNvbW1hbmQob3BlcmFuZHMsIHVua25vd24pO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogUHJvY2VzcyBhcmd1bWVudHMgaW4gY29udGV4dCBvZiB0aGlzIGNvbW1hbmQuXG4gICAqXG4gICAqIEBhcGkgcHJpdmF0ZVxuICAgKi9cblxuICBfcGFyc2VDb21tYW5kKG9wZXJhbmRzLCB1bmtub3duKSB7XG4gICAgY29uc3QgcGFyc2VkID0gdGhpcy5wYXJzZU9wdGlvbnModW5rbm93bik7XG4gICAgb3BlcmFuZHMgPSBvcGVyYW5kcy5jb25jYXQocGFyc2VkLm9wZXJhbmRzKTtcbiAgICB1bmtub3duID0gcGFyc2VkLnVua25vd247XG4gICAgdGhpcy5hcmdzID0gb3BlcmFuZHMuY29uY2F0KHVua25vd24pO1xuXG4gICAgaWYgKG9wZXJhbmRzICYmIHRoaXMuX2ZpbmRDb21tYW5kKG9wZXJhbmRzWzBdKSkge1xuICAgICAgdGhpcy5fZGlzcGF0Y2hTdWJjb21tYW5kKG9wZXJhbmRzWzBdLCBvcGVyYW5kcy5zbGljZSgxKSwgdW5rbm93bik7XG4gICAgfSBlbHNlIGlmICh0aGlzLl9oYXNJbXBsaWNpdEhlbHBDb21tYW5kKCkgJiYgb3BlcmFuZHNbMF0gPT09IHRoaXMuX2hlbHBDb21tYW5kTmFtZSkge1xuICAgICAgaWYgKG9wZXJhbmRzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICB0aGlzLmhlbHAoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX2Rpc3BhdGNoU3ViY29tbWFuZChvcGVyYW5kc1sxXSwgW10sIFt0aGlzLl9oZWxwTG9uZ0ZsYWddKTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHRoaXMuX2RlZmF1bHRDb21tYW5kTmFtZSkge1xuICAgICAgb3V0cHV0SGVscElmUmVxdWVzdGVkKHRoaXMsIHVua25vd24pOyAvLyBSdW4gdGhlIGhlbHAgZm9yIGRlZmF1bHQgY29tbWFuZCBmcm9tIHBhcmVudCByYXRoZXIgdGhhbiBwYXNzaW5nIHRvIGRlZmF1bHQgY29tbWFuZFxuICAgICAgdGhpcy5fZGlzcGF0Y2hTdWJjb21tYW5kKHRoaXMuX2RlZmF1bHRDb21tYW5kTmFtZSwgb3BlcmFuZHMsIHVua25vd24pO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAodGhpcy5jb21tYW5kcy5sZW5ndGggJiYgdGhpcy5hcmdzLmxlbmd0aCA9PT0gMCAmJiAhdGhpcy5fYWN0aW9uSGFuZGxlciAmJiAhdGhpcy5fZGVmYXVsdENvbW1hbmROYW1lKSB7XG4gICAgICAgIC8vIHByb2JhYmx5IG1pc3Npbmcgc3ViY29tbWFuZCBhbmQgbm8gaGFuZGxlciwgdXNlciBuZWVkcyBoZWxwXG4gICAgICAgIHRoaXMuaGVscCh7IGVycm9yOiB0cnVlIH0pO1xuICAgICAgfVxuXG4gICAgICBvdXRwdXRIZWxwSWZSZXF1ZXN0ZWQodGhpcywgcGFyc2VkLnVua25vd24pO1xuICAgICAgdGhpcy5fY2hlY2tGb3JNaXNzaW5nTWFuZGF0b3J5T3B0aW9ucygpO1xuXG4gICAgICAvLyBXZSBkbyBub3QgYWx3YXlzIGNhbGwgdGhpcyBjaGVjayB0byBhdm9pZCBtYXNraW5nIGEgXCJiZXR0ZXJcIiBlcnJvciwgbGlrZSB1bmtub3duIGNvbW1hbmQuXG4gICAgICBjb25zdCBjaGVja0ZvclVua25vd25PcHRpb25zID0gKCkgPT4ge1xuICAgICAgICBpZiAocGFyc2VkLnVua25vd24ubGVuZ3RoID4gMCkge1xuICAgICAgICAgIHRoaXMudW5rbm93bk9wdGlvbihwYXJzZWQudW5rbm93blswXSk7XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IGNvbW1hbmRFdmVudCA9IGBjb21tYW5kOiR7dGhpcy5uYW1lKCl9YDtcbiAgICAgIGlmICh0aGlzLl9hY3Rpb25IYW5kbGVyKSB7XG4gICAgICAgIGNoZWNrRm9yVW5rbm93bk9wdGlvbnMoKTtcbiAgICAgICAgLy8gQ2hlY2sgZXhwZWN0ZWQgYXJndW1lbnRzIGFuZCBjb2xsZWN0IHZhcmlhZGljIHRvZ2V0aGVyLlxuICAgICAgICBjb25zdCBhcmdzID0gdGhpcy5hcmdzLnNsaWNlKCk7XG4gICAgICAgIHRoaXMuX2FyZ3MuZm9yRWFjaCgoYXJnLCBpKSA9PiB7XG4gICAgICAgICAgaWYgKGFyZy5yZXF1aXJlZCAmJiBhcmdzW2ldID09IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMubWlzc2luZ0FyZ3VtZW50KGFyZy5uYW1lKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKGFyZy52YXJpYWRpYykge1xuICAgICAgICAgICAgYXJnc1tpXSA9IGFyZ3Muc3BsaWNlKGkpO1xuICAgICAgICAgICAgYXJncy5sZW5ndGggPSBNYXRoLm1pbihpICsgMSwgYXJncy5sZW5ndGgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChhcmdzLmxlbmd0aCA+IHRoaXMuX2FyZ3MubGVuZ3RoKSB7XG4gICAgICAgICAgdGhpcy5fZXhjZXNzQXJndW1lbnRzKGFyZ3MpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fYWN0aW9uSGFuZGxlcihhcmdzKTtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50KSB0aGlzLnBhcmVudC5lbWl0KGNvbW1hbmRFdmVudCwgb3BlcmFuZHMsIHVua25vd24pOyAvLyBsZWdhY3lcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5wYXJlbnQgJiYgdGhpcy5wYXJlbnQubGlzdGVuZXJDb3VudChjb21tYW5kRXZlbnQpKSB7XG4gICAgICAgIGNoZWNrRm9yVW5rbm93bk9wdGlvbnMoKTtcbiAgICAgICAgdGhpcy5wYXJlbnQuZW1pdChjb21tYW5kRXZlbnQsIG9wZXJhbmRzLCB1bmtub3duKTsgLy8gbGVnYWN5XG4gICAgICB9IGVsc2UgaWYgKG9wZXJhbmRzLmxlbmd0aCkge1xuICAgICAgICBpZiAodGhpcy5fZmluZENvbW1hbmQoJyonKSkgeyAvLyBsZWdhY3kgZGVmYXVsdCBjb21tYW5kXG4gICAgICAgICAgdGhpcy5fZGlzcGF0Y2hTdWJjb21tYW5kKCcqJywgb3BlcmFuZHMsIHVua25vd24pO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMubGlzdGVuZXJDb3VudCgnY29tbWFuZDoqJykpIHtcbiAgICAgICAgICAvLyBza2lwIG9wdGlvbiBjaGVjaywgZW1pdCBldmVudCBmb3IgcG9zc2libGUgbWlzc3BlbGxpbmcgc3VnZ2VzdGlvblxuICAgICAgICAgIHRoaXMuZW1pdCgnY29tbWFuZDoqJywgb3BlcmFuZHMsIHVua25vd24pO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuY29tbWFuZHMubGVuZ3RoKSB7XG4gICAgICAgICAgdGhpcy51bmtub3duQ29tbWFuZCgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNoZWNrRm9yVW5rbm93bk9wdGlvbnMoKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmICh0aGlzLmNvbW1hbmRzLmxlbmd0aCkge1xuICAgICAgICAvLyBUaGlzIGNvbW1hbmQgaGFzIHN1YmNvbW1hbmRzIGFuZCBub3RoaW5nIGhvb2tlZCB1cCBhdCB0aGlzIGxldmVsLCBzbyBkaXNwbGF5IGhlbHAuXG4gICAgICAgIHRoaXMuaGVscCh7IGVycm9yOiB0cnVlIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY2hlY2tGb3JVbmtub3duT3B0aW9ucygpO1xuICAgICAgICAvLyBmYWxsIHRocm91Z2ggZm9yIGNhbGxlciB0byBoYW5kbGUgYWZ0ZXIgY2FsbGluZyAucGFyc2UoKVxuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogRmluZCBtYXRjaGluZyBjb21tYW5kLlxuICAgKlxuICAgKiBAYXBpIHByaXZhdGVcbiAgICovXG4gIF9maW5kQ29tbWFuZChuYW1lKSB7XG4gICAgaWYgKCFuYW1lKSByZXR1cm4gdW5kZWZpbmVkO1xuICAgIHJldHVybiB0aGlzLmNvbW1hbmRzLmZpbmQoY21kID0+IGNtZC5fbmFtZSA9PT0gbmFtZSB8fCBjbWQuX2FsaWFzZXMuaW5jbHVkZXMobmFtZSkpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBSZXR1cm4gYW4gb3B0aW9uIG1hdGNoaW5nIGBhcmdgIGlmIGFueS5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IGFyZ1xuICAgKiBAcmV0dXJuIHtPcHRpb259XG4gICAqIEBhcGkgcHJpdmF0ZVxuICAgKi9cblxuICBfZmluZE9wdGlvbihhcmcpIHtcbiAgICByZXR1cm4gdGhpcy5vcHRpb25zLmZpbmQob3B0aW9uID0+IG9wdGlvbi5pcyhhcmcpKTtcbiAgfTtcblxuICAvKipcbiAgICogRGlzcGxheSBhbiBlcnJvciBtZXNzYWdlIGlmIGEgbWFuZGF0b3J5IG9wdGlvbiBkb2VzIG5vdCBoYXZlIGEgdmFsdWUuXG4gICAqIExhenkgY2FsbGluZyBhZnRlciBjaGVja2luZyBmb3IgaGVscCBmbGFncyBmcm9tIGxlYWYgc3ViY29tbWFuZC5cbiAgICpcbiAgICogQGFwaSBwcml2YXRlXG4gICAqL1xuXG4gIF9jaGVja0Zvck1pc3NpbmdNYW5kYXRvcnlPcHRpb25zKCkge1xuICAgIC8vIFdhbGsgdXAgaGllcmFyY2h5IHNvIGNhbiBjYWxsIGluIHN1YmNvbW1hbmQgYWZ0ZXIgY2hlY2tpbmcgZm9yIGRpc3BsYXlpbmcgaGVscC5cbiAgICBmb3IgKGxldCBjbWQgPSB0aGlzOyBjbWQ7IGNtZCA9IGNtZC5wYXJlbnQpIHtcbiAgICAgIGNtZC5vcHRpb25zLmZvckVhY2goKGFuT3B0aW9uKSA9PiB7XG4gICAgICAgIGlmIChhbk9wdGlvbi5tYW5kYXRvcnkgJiYgKGNtZC5fZ2V0T3B0aW9uVmFsdWUoYW5PcHRpb24uYXR0cmlidXRlTmFtZSgpKSA9PT0gdW5kZWZpbmVkKSkge1xuICAgICAgICAgIGNtZC5taXNzaW5nTWFuZGF0b3J5T3B0aW9uVmFsdWUoYW5PcHRpb24pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIFBhcnNlIG9wdGlvbnMgZnJvbSBgYXJndmAgcmVtb3Zpbmcga25vd24gb3B0aW9ucyxcbiAgICogYW5kIHJldHVybiBhcmd2IHNwbGl0IGludG8gb3BlcmFuZHMgYW5kIHVua25vd24gYXJndW1lbnRzLlxuICAgKlxuICAgKiBFeGFtcGxlczpcbiAgICpcbiAgICogICAgYXJndiA9PiBvcGVyYW5kcywgdW5rbm93blxuICAgKiAgICAtLWtub3duIGtrayBvcCA9PiBbb3BdLCBbXVxuICAgKiAgICBvcCAtLWtub3duIGtrayA9PiBbb3BdLCBbXVxuICAgKiAgICBzdWIgLS11bmtub3duIHV1dSBvcCA9PiBbc3ViXSwgWy0tdW5rbm93biB1dXUgb3BdXG4gICAqICAgIHN1YiAtLSAtLXVua25vd24gdXV1IG9wID0+IFtzdWIgLS11bmtub3duIHV1dSBvcF0sIFtdXG4gICAqXG4gICAqIEBwYXJhbSB7U3RyaW5nW119IGFyZ3ZcbiAgICogQHJldHVybiB7e29wZXJhbmRzOiBTdHJpbmdbXSwgdW5rbm93bjogU3RyaW5nW119fVxuICAgKi9cblxuICBwYXJzZU9wdGlvbnMoYXJndikge1xuICAgIGNvbnN0IG9wZXJhbmRzID0gW107IC8vIG9wZXJhbmRzLCBub3Qgb3B0aW9ucyBvciB2YWx1ZXNcbiAgICBjb25zdCB1bmtub3duID0gW107IC8vIGZpcnN0IHVua25vd24gb3B0aW9uIGFuZCByZW1haW5pbmcgdW5rbm93biBhcmdzXG4gICAgbGV0IGRlc3QgPSBvcGVyYW5kcztcbiAgICBjb25zdCBhcmdzID0gYXJndi5zbGljZSgpO1xuXG4gICAgZnVuY3Rpb24gbWF5YmVPcHRpb24oYXJnKSB7XG4gICAgICByZXR1cm4gYXJnLmxlbmd0aCA+IDEgJiYgYXJnWzBdID09PSAnLSc7XG4gICAgfVxuXG4gICAgLy8gcGFyc2Ugb3B0aW9uc1xuICAgIGxldCBhY3RpdmVWYXJpYWRpY09wdGlvbiA9IG51bGw7XG4gICAgd2hpbGUgKGFyZ3MubGVuZ3RoKSB7XG4gICAgICBjb25zdCBhcmcgPSBhcmdzLnNoaWZ0KCk7XG5cbiAgICAgIC8vIGxpdGVyYWxcbiAgICAgIGlmIChhcmcgPT09ICctLScpIHtcbiAgICAgICAgaWYgKGRlc3QgPT09IHVua25vd24pIGRlc3QucHVzaChhcmcpO1xuICAgICAgICBkZXN0LnB1c2goLi4uYXJncyk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuXG4gICAgICBpZiAoYWN0aXZlVmFyaWFkaWNPcHRpb24gJiYgIW1heWJlT3B0aW9uKGFyZykpIHtcbiAgICAgICAgdGhpcy5lbWl0KGBvcHRpb246JHthY3RpdmVWYXJpYWRpY09wdGlvbi5uYW1lKCl9YCwgYXJnKTtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBhY3RpdmVWYXJpYWRpY09wdGlvbiA9IG51bGw7XG5cbiAgICAgIGlmIChtYXliZU9wdGlvbihhcmcpKSB7XG4gICAgICAgIGNvbnN0IG9wdGlvbiA9IHRoaXMuX2ZpbmRPcHRpb24oYXJnKTtcbiAgICAgICAgLy8gcmVjb2duaXNlZCBvcHRpb24sIGNhbGwgbGlzdGVuZXIgdG8gYXNzaWduIHZhbHVlIHdpdGggcG9zc2libGUgY3VzdG9tIHByb2Nlc3NpbmdcbiAgICAgICAgaWYgKG9wdGlvbikge1xuICAgICAgICAgIGlmIChvcHRpb24ucmVxdWlyZWQpIHtcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gYXJncy5zaGlmdCgpO1xuICAgICAgICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHRoaXMub3B0aW9uTWlzc2luZ0FyZ3VtZW50KG9wdGlvbik7XG4gICAgICAgICAgICB0aGlzLmVtaXQoYG9wdGlvbjoke29wdGlvbi5uYW1lKCl9YCwgdmFsdWUpO1xuICAgICAgICAgIH0gZWxzZSBpZiAob3B0aW9uLm9wdGlvbmFsKSB7XG4gICAgICAgICAgICBsZXQgdmFsdWUgPSBudWxsO1xuICAgICAgICAgICAgLy8gaGlzdG9yaWNhbCBiZWhhdmlvdXIgaXMgb3B0aW9uYWwgdmFsdWUgaXMgZm9sbG93aW5nIGFyZyB1bmxlc3MgYW4gb3B0aW9uXG4gICAgICAgICAgICBpZiAoYXJncy5sZW5ndGggPiAwICYmICFtYXliZU9wdGlvbihhcmdzWzBdKSkge1xuICAgICAgICAgICAgICB2YWx1ZSA9IGFyZ3Muc2hpZnQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuZW1pdChgb3B0aW9uOiR7b3B0aW9uLm5hbWUoKX1gLCB2YWx1ZSk7XG4gICAgICAgICAgfSBlbHNlIHsgLy8gYm9vbGVhbiBmbGFnXG4gICAgICAgICAgICB0aGlzLmVtaXQoYG9wdGlvbjoke29wdGlvbi5uYW1lKCl9YCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGFjdGl2ZVZhcmlhZGljT3B0aW9uID0gb3B0aW9uLnZhcmlhZGljID8gb3B0aW9uIDogbnVsbDtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBMb29rIGZvciBjb21ibyBvcHRpb25zIGZvbGxvd2luZyBzaW5nbGUgZGFzaCwgZWF0IGZpcnN0IG9uZSBpZiBrbm93bi5cbiAgICAgIGlmIChhcmcubGVuZ3RoID4gMiAmJiBhcmdbMF0gPT09ICctJyAmJiBhcmdbMV0gIT09ICctJykge1xuICAgICAgICBjb25zdCBvcHRpb24gPSB0aGlzLl9maW5kT3B0aW9uKGAtJHthcmdbMV19YCk7XG4gICAgICAgIGlmIChvcHRpb24pIHtcbiAgICAgICAgICBpZiAob3B0aW9uLnJlcXVpcmVkIHx8IChvcHRpb24ub3B0aW9uYWwgJiYgdGhpcy5fY29tYmluZUZsYWdBbmRPcHRpb25hbFZhbHVlKSkge1xuICAgICAgICAgICAgLy8gb3B0aW9uIHdpdGggdmFsdWUgZm9sbG93aW5nIGluIHNhbWUgYXJndW1lbnRcbiAgICAgICAgICAgIHRoaXMuZW1pdChgb3B0aW9uOiR7b3B0aW9uLm5hbWUoKX1gLCBhcmcuc2xpY2UoMikpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBib29sZWFuIG9wdGlvbiwgZW1pdCBhbmQgcHV0IGJhY2sgcmVtYWluZGVyIG9mIGFyZyBmb3IgZnVydGhlciBwcm9jZXNzaW5nXG4gICAgICAgICAgICB0aGlzLmVtaXQoYG9wdGlvbjoke29wdGlvbi5uYW1lKCl9YCk7XG4gICAgICAgICAgICBhcmdzLnVuc2hpZnQoYC0ke2FyZy5zbGljZSgyKX1gKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gTG9vayBmb3Iga25vd24gbG9uZyBmbGFnIHdpdGggdmFsdWUsIGxpa2UgLS1mb289YmFyXG4gICAgICBpZiAoL14tLVtePV0rPS8udGVzdChhcmcpKSB7XG4gICAgICAgIGNvbnN0IGluZGV4ID0gYXJnLmluZGV4T2YoJz0nKTtcbiAgICAgICAgY29uc3Qgb3B0aW9uID0gdGhpcy5fZmluZE9wdGlvbihhcmcuc2xpY2UoMCwgaW5kZXgpKTtcbiAgICAgICAgaWYgKG9wdGlvbiAmJiAob3B0aW9uLnJlcXVpcmVkIHx8IG9wdGlvbi5vcHRpb25hbCkpIHtcbiAgICAgICAgICB0aGlzLmVtaXQoYG9wdGlvbjoke29wdGlvbi5uYW1lKCl9YCwgYXJnLnNsaWNlKGluZGV4ICsgMSkpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIE5vdCBhIHJlY29nbmlzZWQgb3B0aW9uIGJ5IHRoaXMgY29tbWFuZC5cbiAgICAgIC8vIE1pZ2h0IGJlIGEgY29tbWFuZC1hcmd1bWVudCwgb3Igc3ViY29tbWFuZCBvcHRpb24sIG9yIHVua25vd24gb3B0aW9uLCBvciBoZWxwIGNvbW1hbmQgb3Igb3B0aW9uLlxuXG4gICAgICAvLyBBbiB1bmtub3duIG9wdGlvbiBtZWFucyBmdXJ0aGVyIGFyZ3VtZW50cyBhbHNvIGNsYXNzaWZpZWQgYXMgdW5rbm93biBzbyBjYW4gYmUgcmVwcm9jZXNzZWQgYnkgc3ViY29tbWFuZHMuXG4gICAgICBpZiAobWF5YmVPcHRpb24oYXJnKSkge1xuICAgICAgICBkZXN0ID0gdW5rbm93bjtcbiAgICAgIH1cblxuICAgICAgLy8gSWYgdXNpbmcgcG9zaXRpb25hbE9wdGlvbnMsIHN0b3AgcHJvY2Vzc2luZyBvdXIgb3B0aW9ucyBhdCBzdWJjb21tYW5kLlxuICAgICAgaWYgKCh0aGlzLl9lbmFibGVQb3NpdGlvbmFsT3B0aW9ucyB8fCB0aGlzLl9wYXNzVGhyb3VnaE9wdGlvbnMpICYmIG9wZXJhbmRzLmxlbmd0aCA9PT0gMCAmJiB1bmtub3duLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBpZiAodGhpcy5fZmluZENvbW1hbmQoYXJnKSkge1xuICAgICAgICAgIG9wZXJhbmRzLnB1c2goYXJnKTtcbiAgICAgICAgICBpZiAoYXJncy5sZW5ndGggPiAwKSB1bmtub3duLnB1c2goLi4uYXJncyk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH0gZWxzZSBpZiAoYXJnID09PSB0aGlzLl9oZWxwQ29tbWFuZE5hbWUgJiYgdGhpcy5faGFzSW1wbGljaXRIZWxwQ29tbWFuZCgpKSB7XG4gICAgICAgICAgb3BlcmFuZHMucHVzaChhcmcpO1xuICAgICAgICAgIGlmIChhcmdzLmxlbmd0aCA+IDApIG9wZXJhbmRzLnB1c2goLi4uYXJncyk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5fZGVmYXVsdENvbW1hbmROYW1lKSB7XG4gICAgICAgICAgdW5rbm93bi5wdXNoKGFyZyk7XG4gICAgICAgICAgaWYgKGFyZ3MubGVuZ3RoID4gMCkgdW5rbm93bi5wdXNoKC4uLmFyZ3MpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIElmIHVzaW5nIHBhc3NUaHJvdWdoT3B0aW9ucywgc3RvcCBwcm9jZXNzaW5nIG9wdGlvbnMgYXQgZmlyc3QgY29tbWFuZC1hcmd1bWVudC5cbiAgICAgIGlmICh0aGlzLl9wYXNzVGhyb3VnaE9wdGlvbnMpIHtcbiAgICAgICAgZGVzdC5wdXNoKGFyZyk7XG4gICAgICAgIGlmIChhcmdzLmxlbmd0aCA+IDApIGRlc3QucHVzaCguLi5hcmdzKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG5cbiAgICAgIC8vIGFkZCBhcmdcbiAgICAgIGRlc3QucHVzaChhcmcpO1xuICAgIH1cblxuICAgIHJldHVybiB7IG9wZXJhbmRzLCB1bmtub3duIH07XG4gIH07XG5cbiAgLyoqXG4gICAqIFJldHVybiBhbiBvYmplY3QgY29udGFpbmluZyBvcHRpb25zIGFzIGtleS12YWx1ZSBwYWlyc1xuICAgKlxuICAgKiBAcmV0dXJuIHtPYmplY3R9XG4gICAqL1xuICBvcHRzKCkge1xuICAgIGlmICh0aGlzLl9zdG9yZU9wdGlvbnNBc1Byb3BlcnRpZXMpIHtcbiAgICAgIC8vIFByZXNlcnZlIG9yaWdpbmFsIGJlaGF2aW91ciBzbyBiYWNrd2FyZHMgY29tcGF0aWJsZSB3aGVuIHN0aWxsIHVzaW5nIHByb3BlcnRpZXNcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHt9O1xuICAgICAgY29uc3QgbGVuID0gdGhpcy5vcHRpb25zLmxlbmd0aDtcblxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBjb25zdCBrZXkgPSB0aGlzLm9wdGlvbnNbaV0uYXR0cmlidXRlTmFtZSgpO1xuICAgICAgICByZXN1bHRba2V5XSA9IGtleSA9PT0gdGhpcy5fdmVyc2lvbk9wdGlvbk5hbWUgPyB0aGlzLl92ZXJzaW9uIDogdGhpc1trZXldO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5fb3B0aW9uVmFsdWVzO1xuICB9O1xuXG4gIC8qKlxuICAgKiBJbnRlcm5hbCBib3R0bGVuZWNrIGZvciBoYW5kbGluZyBvZiBwYXJzaW5nIGVycm9ycy5cbiAgICpcbiAgICogQGFwaSBwcml2YXRlXG4gICAqL1xuICBfZGlzcGxheUVycm9yKGV4aXRDb2RlLCBjb2RlLCBtZXNzYWdlKSB7XG4gICAgdGhpcy5fb3V0cHV0Q29uZmlndXJhdGlvbi5vdXRwdXRFcnJvcihgJHttZXNzYWdlfVxcbmAsIHRoaXMuX291dHB1dENvbmZpZ3VyYXRpb24ud3JpdGVFcnIpO1xuICAgIHRoaXMuX2V4aXQoZXhpdENvZGUsIGNvZGUsIG1lc3NhZ2UpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFyZ3VtZW50IGBuYW1lYCBpcyBtaXNzaW5nLlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZVxuICAgKiBAYXBpIHByaXZhdGVcbiAgICovXG5cbiAgbWlzc2luZ0FyZ3VtZW50KG5hbWUpIHtcbiAgICBjb25zdCBtZXNzYWdlID0gYGVycm9yOiBtaXNzaW5nIHJlcXVpcmVkIGFyZ3VtZW50ICcke25hbWV9J2A7XG4gICAgdGhpcy5fZGlzcGxheUVycm9yKDEsICdjb21tYW5kZXIubWlzc2luZ0FyZ3VtZW50JywgbWVzc2FnZSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIGBPcHRpb25gIGlzIG1pc3NpbmcgYW4gYXJndW1lbnQuXG4gICAqXG4gICAqIEBwYXJhbSB7T3B0aW9ufSBvcHRpb25cbiAgICogQGFwaSBwcml2YXRlXG4gICAqL1xuXG4gIG9wdGlvbk1pc3NpbmdBcmd1bWVudChvcHRpb24pIHtcbiAgICBjb25zdCBtZXNzYWdlID0gYGVycm9yOiBvcHRpb24gJyR7b3B0aW9uLmZsYWdzfScgYXJndW1lbnQgbWlzc2luZ2A7XG4gICAgdGhpcy5fZGlzcGxheUVycm9yKDEsICdjb21tYW5kZXIub3B0aW9uTWlzc2luZ0FyZ3VtZW50JywgbWVzc2FnZSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIGBPcHRpb25gIGRvZXMgbm90IGhhdmUgYSB2YWx1ZSwgYW5kIGlzIGEgbWFuZGF0b3J5IG9wdGlvbi5cbiAgICpcbiAgICogQHBhcmFtIHtPcHRpb259IG9wdGlvblxuICAgKiBAYXBpIHByaXZhdGVcbiAgICovXG5cbiAgbWlzc2luZ01hbmRhdG9yeU9wdGlvblZhbHVlKG9wdGlvbikge1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBgZXJyb3I6IHJlcXVpcmVkIG9wdGlvbiAnJHtvcHRpb24uZmxhZ3N9JyBub3Qgc3BlY2lmaWVkYDtcbiAgICB0aGlzLl9kaXNwbGF5RXJyb3IoMSwgJ2NvbW1hbmRlci5taXNzaW5nTWFuZGF0b3J5T3B0aW9uVmFsdWUnLCBtZXNzYWdlKTtcbiAgfTtcblxuICAvKipcbiAgICogVW5rbm93biBvcHRpb24gYGZsYWdgLlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gZmxhZ1xuICAgKiBAYXBpIHByaXZhdGVcbiAgICovXG5cbiAgdW5rbm93bk9wdGlvbihmbGFnKSB7XG4gICAgaWYgKHRoaXMuX2FsbG93VW5rbm93bk9wdGlvbikgcmV0dXJuO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBgZXJyb3I6IHVua25vd24gb3B0aW9uICcke2ZsYWd9J2A7XG4gICAgdGhpcy5fZGlzcGxheUVycm9yKDEsICdjb21tYW5kZXIudW5rbm93bk9wdGlvbicsIG1lc3NhZ2UpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBFeGNlc3MgYXJndW1lbnRzLCBtb3JlIHRoYW4gZXhwZWN0ZWQuXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nW119IHJlY2VpdmVkQXJnc1xuICAgKiBAYXBpIHByaXZhdGVcbiAgICovXG5cbiAgX2V4Y2Vzc0FyZ3VtZW50cyhyZWNlaXZlZEFyZ3MpIHtcbiAgICBpZiAodGhpcy5fYWxsb3dFeGNlc3NBcmd1bWVudHMpIHJldHVybjtcblxuICAgIGNvbnN0IGV4cGVjdGVkID0gdGhpcy5fYXJncy5sZW5ndGg7XG4gICAgY29uc3QgcyA9IChleHBlY3RlZCA9PT0gMSkgPyAnJyA6ICdzJztcbiAgICBjb25zdCBmb3JTdWJjb21tYW5kID0gdGhpcy5wYXJlbnQgPyBgIGZvciAnJHt0aGlzLm5hbWUoKX0nYCA6ICcnO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBgZXJyb3I6IHRvbyBtYW55IGFyZ3VtZW50cyR7Zm9yU3ViY29tbWFuZH0uIEV4cGVjdGVkICR7ZXhwZWN0ZWR9IGFyZ3VtZW50JHtzfSBidXQgZ290ICR7cmVjZWl2ZWRBcmdzLmxlbmd0aH0uYDtcbiAgICB0aGlzLl9kaXNwbGF5RXJyb3IoMSwgJ2NvbW1hbmRlci5leGNlc3NBcmd1bWVudHMnLCBtZXNzYWdlKTtcbiAgfTtcblxuICAvKipcbiAgICogVW5rbm93biBjb21tYW5kLlxuICAgKlxuICAgKiBAYXBpIHByaXZhdGVcbiAgICovXG5cbiAgdW5rbm93bkNvbW1hbmQoKSB7XG4gICAgY29uc3QgcGFydENvbW1hbmRzID0gW3RoaXMubmFtZSgpXTtcbiAgICBmb3IgKGxldCBwYXJlbnRDbWQgPSB0aGlzLnBhcmVudDsgcGFyZW50Q21kOyBwYXJlbnRDbWQgPSBwYXJlbnRDbWQucGFyZW50KSB7XG4gICAgICBwYXJ0Q29tbWFuZHMudW5zaGlmdChwYXJlbnRDbWQubmFtZSgpKTtcbiAgICB9XG4gICAgY29uc3QgZnVsbENvbW1hbmQgPSBwYXJ0Q29tbWFuZHMuam9pbignICcpO1xuICAgIGNvbnN0IG1lc3NhZ2UgPSBgZXJyb3I6IHVua25vd24gY29tbWFuZCAnJHt0aGlzLmFyZ3NbMF19Jy5gICtcbiAgICAgICh0aGlzLl9oYXNIZWxwT3B0aW9uID8gYCBTZWUgJyR7ZnVsbENvbW1hbmR9ICR7dGhpcy5faGVscExvbmdGbGFnfScuYCA6ICcnKTtcbiAgICB0aGlzLl9kaXNwbGF5RXJyb3IoMSwgJ2NvbW1hbmRlci51bmtub3duQ29tbWFuZCcsIG1lc3NhZ2UpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBTZXQgdGhlIHByb2dyYW0gdmVyc2lvbiB0byBgc3RyYC5cbiAgICpcbiAgICogVGhpcyBtZXRob2QgYXV0by1yZWdpc3RlcnMgdGhlIFwiLVYsIC0tdmVyc2lvblwiIGZsYWdcbiAgICogd2hpY2ggd2lsbCBwcmludCB0aGUgdmVyc2lvbiBudW1iZXIgd2hlbiBwYXNzZWQuXG4gICAqXG4gICAqIFlvdSBjYW4gb3B0aW9uYWxseSBzdXBwbHkgdGhlICBmbGFncyBhbmQgZGVzY3JpcHRpb24gdG8gb3ZlcnJpZGUgdGhlIGRlZmF1bHRzLlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gc3RyXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBbZmxhZ3NdXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBbZGVzY3JpcHRpb25dXG4gICAqIEByZXR1cm4ge3RoaXMgfCBzdHJpbmd9IGB0aGlzYCBjb21tYW5kIGZvciBjaGFpbmluZywgb3IgdmVyc2lvbiBzdHJpbmcgaWYgbm8gYXJndW1lbnRzXG4gICAqL1xuXG4gIHZlcnNpb24oc3RyLCBmbGFncywgZGVzY3JpcHRpb24pIHtcbiAgICBpZiAoc3RyID09PSB1bmRlZmluZWQpIHJldHVybiB0aGlzLl92ZXJzaW9uO1xuICAgIHRoaXMuX3ZlcnNpb24gPSBzdHI7XG4gICAgZmxhZ3MgPSBmbGFncyB8fCAnLVYsIC0tdmVyc2lvbic7XG4gICAgZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbiB8fCAnb3V0cHV0IHRoZSB2ZXJzaW9uIG51bWJlcic7XG4gICAgY29uc3QgdmVyc2lvbk9wdGlvbiA9IHRoaXMuY3JlYXRlT3B0aW9uKGZsYWdzLCBkZXNjcmlwdGlvbik7XG4gICAgdGhpcy5fdmVyc2lvbk9wdGlvbk5hbWUgPSB2ZXJzaW9uT3B0aW9uLmF0dHJpYnV0ZU5hbWUoKTtcbiAgICB0aGlzLm9wdGlvbnMucHVzaCh2ZXJzaW9uT3B0aW9uKTtcbiAgICB0aGlzLm9uKCdvcHRpb246JyArIHZlcnNpb25PcHRpb24ubmFtZSgpLCAoKSA9PiB7XG4gICAgICB0aGlzLl9vdXRwdXRDb25maWd1cmF0aW9uLndyaXRlT3V0KGAke3N0cn1cXG5gKTtcbiAgICAgIHRoaXMuX2V4aXQoMCwgJ2NvbW1hbmRlci52ZXJzaW9uJywgc3RyKTtcbiAgICB9KTtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICAvKipcbiAgICogU2V0IHRoZSBkZXNjcmlwdGlvbiB0byBgc3RyYC5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IFtzdHJdXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBbYXJnc0Rlc2NyaXB0aW9uXVxuICAgKiBAcmV0dXJuIHtzdHJpbmd8Q29tbWFuZH1cbiAgICovXG4gIGRlc2NyaXB0aW9uKHN0ciwgYXJnc0Rlc2NyaXB0aW9uKSB7XG4gICAgaWYgKHN0ciA9PT0gdW5kZWZpbmVkICYmIGFyZ3NEZXNjcmlwdGlvbiA9PT0gdW5kZWZpbmVkKSByZXR1cm4gdGhpcy5fZGVzY3JpcHRpb247XG4gICAgdGhpcy5fZGVzY3JpcHRpb24gPSBzdHI7XG4gICAgdGhpcy5fYXJnc0Rlc2NyaXB0aW9uID0gYXJnc0Rlc2NyaXB0aW9uO1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIC8qKlxuICAgKiBTZXQgYW4gYWxpYXMgZm9yIHRoZSBjb21tYW5kLlxuICAgKlxuICAgKiBZb3UgbWF5IGNhbGwgbW9yZSB0aGFuIG9uY2UgdG8gYWRkIG11bHRpcGxlIGFsaWFzZXMuIE9ubHkgdGhlIGZpcnN0IGFsaWFzIGlzIHNob3duIGluIHRoZSBhdXRvLWdlbmVyYXRlZCBoZWxwLlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gW2FsaWFzXVxuICAgKiBAcmV0dXJuIHtzdHJpbmd8Q29tbWFuZH1cbiAgICovXG5cbiAgYWxpYXMoYWxpYXMpIHtcbiAgICBpZiAoYWxpYXMgPT09IHVuZGVmaW5lZCkgcmV0dXJuIHRoaXMuX2FsaWFzZXNbMF07IC8vIGp1c3QgcmV0dXJuIGZpcnN0LCBmb3IgYmFja3dhcmRzIGNvbXBhdGliaWxpdHlcblxuICAgIGxldCBjb21tYW5kID0gdGhpcztcbiAgICBpZiAodGhpcy5jb21tYW5kcy5sZW5ndGggIT09IDAgJiYgdGhpcy5jb21tYW5kc1t0aGlzLmNvbW1hbmRzLmxlbmd0aCAtIDFdLl9leGVjdXRhYmxlSGFuZGxlcikge1xuICAgICAgLy8gYXNzdW1lIGFkZGluZyBhbGlhcyBmb3IgbGFzdCBhZGRlZCBleGVjdXRhYmxlIHN1YmNvbW1hbmQsIHJhdGhlciB0aGFuIHRoaXNcbiAgICAgIGNvbW1hbmQgPSB0aGlzLmNvbW1hbmRzW3RoaXMuY29tbWFuZHMubGVuZ3RoIC0gMV07XG4gICAgfVxuXG4gICAgaWYgKGFsaWFzID09PSBjb21tYW5kLl9uYW1lKSB0aHJvdyBuZXcgRXJyb3IoJ0NvbW1hbmQgYWxpYXMgY2FuXFwndCBiZSB0aGUgc2FtZSBhcyBpdHMgbmFtZScpO1xuXG4gICAgY29tbWFuZC5fYWxpYXNlcy5wdXNoKGFsaWFzKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICAvKipcbiAgICogU2V0IGFsaWFzZXMgZm9yIHRoZSBjb21tYW5kLlxuICAgKlxuICAgKiBPbmx5IHRoZSBmaXJzdCBhbGlhcyBpcyBzaG93biBpbiB0aGUgYXV0by1nZW5lcmF0ZWQgaGVscC5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmdbXX0gW2FsaWFzZXNdXG4gICAqIEByZXR1cm4ge3N0cmluZ1tdfENvbW1hbmR9XG4gICAqL1xuXG4gIGFsaWFzZXMoYWxpYXNlcykge1xuICAgIC8vIEdldHRlciBmb3IgdGhlIGFycmF5IG9mIGFsaWFzZXMgaXMgdGhlIG1haW4gcmVhc29uIGZvciBoYXZpbmcgYWxpYXNlcygpIGluIGFkZGl0aW9uIHRvIGFsaWFzKCkuXG4gICAgaWYgKGFsaWFzZXMgPT09IHVuZGVmaW5lZCkgcmV0dXJuIHRoaXMuX2FsaWFzZXM7XG5cbiAgICBhbGlhc2VzLmZvckVhY2goKGFsaWFzKSA9PiB0aGlzLmFsaWFzKGFsaWFzKSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIFNldCAvIGdldCB0aGUgY29tbWFuZCB1c2FnZSBgc3RyYC5cbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IFtzdHJdXG4gICAqIEByZXR1cm4ge1N0cmluZ3xDb21tYW5kfVxuICAgKi9cblxuICB1c2FnZShzdHIpIHtcbiAgICBpZiAoc3RyID09PSB1bmRlZmluZWQpIHtcbiAgICAgIGlmICh0aGlzLl91c2FnZSkgcmV0dXJuIHRoaXMuX3VzYWdlO1xuXG4gICAgICBjb25zdCBhcmdzID0gdGhpcy5fYXJncy5tYXAoKGFyZykgPT4ge1xuICAgICAgICByZXR1cm4gaHVtYW5SZWFkYWJsZUFyZ05hbWUoYXJnKTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIFtdLmNvbmNhdChcbiAgICAgICAgKHRoaXMub3B0aW9ucy5sZW5ndGggfHwgdGhpcy5faGFzSGVscE9wdGlvbiA/ICdbb3B0aW9uc10nIDogW10pLFxuICAgICAgICAodGhpcy5jb21tYW5kcy5sZW5ndGggPyAnW2NvbW1hbmRdJyA6IFtdKSxcbiAgICAgICAgKHRoaXMuX2FyZ3MubGVuZ3RoID8gYXJncyA6IFtdKVxuICAgICAgKS5qb2luKCcgJyk7XG4gICAgfVxuXG4gICAgdGhpcy5fdXNhZ2UgPSBzdHI7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIEdldCBvciBzZXQgdGhlIG5hbWUgb2YgdGhlIGNvbW1hbmRcbiAgICpcbiAgICogQHBhcmFtIHtzdHJpbmd9IFtzdHJdXG4gICAqIEByZXR1cm4ge3N0cmluZ3xDb21tYW5kfVxuICAgKi9cblxuICBuYW1lKHN0cikge1xuICAgIGlmIChzdHIgPT09IHVuZGVmaW5lZCkgcmV0dXJuIHRoaXMuX25hbWU7XG4gICAgdGhpcy5fbmFtZSA9IHN0cjtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICAvKipcbiAgICogUmV0dXJuIHByb2dyYW0gaGVscCBkb2N1bWVudGF0aW9uLlxuICAgKlxuICAgKiBAcGFyYW0ge3sgZXJyb3I6IGJvb2xlYW4gfX0gW2NvbnRleHRPcHRpb25zXSAtIHBhc3Mge2Vycm9yOnRydWV9IHRvIHdyYXAgZm9yIHN0ZGVyciBpbnN0ZWFkIG9mIHN0ZG91dFxuICAgKiBAcmV0dXJuIHtzdHJpbmd9XG4gICAqL1xuXG4gIGhlbHBJbmZvcm1hdGlvbihjb250ZXh0T3B0aW9ucykge1xuICAgIGNvbnN0IGhlbHBlciA9IHRoaXMuY3JlYXRlSGVscCgpO1xuICAgIGlmIChoZWxwZXIuaGVscFdpZHRoID09PSB1bmRlZmluZWQpIHtcbiAgICAgIGhlbHBlci5oZWxwV2lkdGggPSAoY29udGV4dE9wdGlvbnMgJiYgY29udGV4dE9wdGlvbnMuZXJyb3IpID8gdGhpcy5fb3V0cHV0Q29uZmlndXJhdGlvbi5nZXRFcnJIZWxwV2lkdGgoKSA6IHRoaXMuX291dHB1dENvbmZpZ3VyYXRpb24uZ2V0T3V0SGVscFdpZHRoKCk7XG4gICAgfVxuICAgIHJldHVybiBoZWxwZXIuZm9ybWF0SGVscCh0aGlzLCBoZWxwZXIpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBAYXBpIHByaXZhdGVcbiAgICovXG5cbiAgX2dldEhlbHBDb250ZXh0KGNvbnRleHRPcHRpb25zKSB7XG4gICAgY29udGV4dE9wdGlvbnMgPSBjb250ZXh0T3B0aW9ucyB8fCB7fTtcbiAgICBjb25zdCBjb250ZXh0ID0geyBlcnJvcjogISFjb250ZXh0T3B0aW9ucy5lcnJvciB9O1xuICAgIGxldCB3cml0ZTtcbiAgICBpZiAoY29udGV4dC5lcnJvcikge1xuICAgICAgd3JpdGUgPSAoYXJnKSA9PiB0aGlzLl9vdXRwdXRDb25maWd1cmF0aW9uLndyaXRlRXJyKGFyZyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHdyaXRlID0gKGFyZykgPT4gdGhpcy5fb3V0cHV0Q29uZmlndXJhdGlvbi53cml0ZU91dChhcmcpO1xuICAgIH1cbiAgICBjb250ZXh0LndyaXRlID0gY29udGV4dE9wdGlvbnMud3JpdGUgfHwgd3JpdGU7XG4gICAgY29udGV4dC5jb21tYW5kID0gdGhpcztcbiAgICByZXR1cm4gY29udGV4dDtcbiAgfVxuXG4gIC8qKlxuICAgKiBPdXRwdXQgaGVscCBpbmZvcm1hdGlvbiBmb3IgdGhpcyBjb21tYW5kLlxuICAgKlxuICAgKiBPdXRwdXRzIGJ1aWx0LWluIGhlbHAsIGFuZCBjdXN0b20gdGV4dCBhZGRlZCB1c2luZyBgLmFkZEhlbHBUZXh0KClgLlxuICAgKlxuICAgKiBAcGFyYW0ge3sgZXJyb3I6IGJvb2xlYW4gfSB8IEZ1bmN0aW9ufSBbY29udGV4dE9wdGlvbnNdIC0gcGFzcyB7ZXJyb3I6dHJ1ZX0gdG8gd3JpdGUgdG8gc3RkZXJyIGluc3RlYWQgb2Ygc3Rkb3V0XG4gICAqL1xuXG4gIG91dHB1dEhlbHAoY29udGV4dE9wdGlvbnMpIHtcbiAgICBsZXQgZGVwcmVjYXRlZENhbGxiYWNrO1xuICAgIGlmICh0eXBlb2YgY29udGV4dE9wdGlvbnMgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIGRlcHJlY2F0ZWRDYWxsYmFjayA9IGNvbnRleHRPcHRpb25zO1xuICAgICAgY29udGV4dE9wdGlvbnMgPSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIGNvbnN0IGNvbnRleHQgPSB0aGlzLl9nZXRIZWxwQ29udGV4dChjb250ZXh0T3B0aW9ucyk7XG5cbiAgICBjb25zdCBncm91cExpc3RlbmVycyA9IFtdO1xuICAgIGxldCBjb21tYW5kID0gdGhpcztcbiAgICB3aGlsZSAoY29tbWFuZCkge1xuICAgICAgZ3JvdXBMaXN0ZW5lcnMucHVzaChjb21tYW5kKTsgLy8gb3JkZXJlZCBmcm9tIGN1cnJlbnQgY29tbWFuZCB0byByb290XG4gICAgICBjb21tYW5kID0gY29tbWFuZC5wYXJlbnQ7XG4gICAgfVxuXG4gICAgZ3JvdXBMaXN0ZW5lcnMuc2xpY2UoKS5yZXZlcnNlKCkuZm9yRWFjaChjb21tYW5kID0+IGNvbW1hbmQuZW1pdCgnYmVmb3JlQWxsSGVscCcsIGNvbnRleHQpKTtcbiAgICB0aGlzLmVtaXQoJ2JlZm9yZUhlbHAnLCBjb250ZXh0KTtcblxuICAgIGxldCBoZWxwSW5mb3JtYXRpb24gPSB0aGlzLmhlbHBJbmZvcm1hdGlvbihjb250ZXh0KTtcbiAgICBpZiAoZGVwcmVjYXRlZENhbGxiYWNrKSB7XG4gICAgICBoZWxwSW5mb3JtYXRpb24gPSBkZXByZWNhdGVkQ2FsbGJhY2soaGVscEluZm9ybWF0aW9uKTtcbiAgICAgIGlmICh0eXBlb2YgaGVscEluZm9ybWF0aW9uICE9PSAnc3RyaW5nJyAmJiAhQnVmZmVyLmlzQnVmZmVyKGhlbHBJbmZvcm1hdGlvbikpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdvdXRwdXRIZWxwIGNhbGxiYWNrIG11c3QgcmV0dXJuIGEgc3RyaW5nIG9yIGEgQnVmZmVyJyk7XG4gICAgICB9XG4gICAgfVxuICAgIGNvbnRleHQud3JpdGUoaGVscEluZm9ybWF0aW9uKTtcblxuICAgIHRoaXMuZW1pdCh0aGlzLl9oZWxwTG9uZ0ZsYWcpOyAvLyBkZXByZWNhdGVkXG4gICAgdGhpcy5lbWl0KCdhZnRlckhlbHAnLCBjb250ZXh0KTtcbiAgICBncm91cExpc3RlbmVycy5mb3JFYWNoKGNvbW1hbmQgPT4gY29tbWFuZC5lbWl0KCdhZnRlckFsbEhlbHAnLCBjb250ZXh0KSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFlvdSBjYW4gcGFzcyBpbiBmbGFncyBhbmQgYSBkZXNjcmlwdGlvbiB0byBvdmVycmlkZSB0aGUgaGVscFxuICAgKiBmbGFncyBhbmQgaGVscCBkZXNjcmlwdGlvbiBmb3IgeW91ciBjb21tYW5kLiBQYXNzIGluIGZhbHNlIHRvXG4gICAqIGRpc2FibGUgdGhlIGJ1aWx0LWluIGhlbHAgb3B0aW9uLlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZyB8IGJvb2xlYW59IFtmbGFnc11cbiAgICogQHBhcmFtIHtzdHJpbmd9IFtkZXNjcmlwdGlvbl1cbiAgICogQHJldHVybiB7Q29tbWFuZH0gYHRoaXNgIGNvbW1hbmQgZm9yIGNoYWluaW5nXG4gICAqL1xuXG4gIGhlbHBPcHRpb24oZmxhZ3MsIGRlc2NyaXB0aW9uKSB7XG4gICAgaWYgKHR5cGVvZiBmbGFncyA9PT0gJ2Jvb2xlYW4nKSB7XG4gICAgICB0aGlzLl9oYXNIZWxwT3B0aW9uID0gZmxhZ3M7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgdGhpcy5faGVscEZsYWdzID0gZmxhZ3MgfHwgdGhpcy5faGVscEZsYWdzO1xuICAgIHRoaXMuX2hlbHBEZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uIHx8IHRoaXMuX2hlbHBEZXNjcmlwdGlvbjtcblxuICAgIGNvbnN0IGhlbHBGbGFncyA9IF9wYXJzZU9wdGlvbkZsYWdzKHRoaXMuX2hlbHBGbGFncyk7XG4gICAgdGhpcy5faGVscFNob3J0RmxhZyA9IGhlbHBGbGFncy5zaG9ydEZsYWc7XG4gICAgdGhpcy5faGVscExvbmdGbGFnID0gaGVscEZsYWdzLmxvbmdGbGFnO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIE91dHB1dCBoZWxwIGluZm9ybWF0aW9uIGFuZCBleGl0LlxuICAgKlxuICAgKiBPdXRwdXRzIGJ1aWx0LWluIGhlbHAsIGFuZCBjdXN0b20gdGV4dCBhZGRlZCB1c2luZyBgLmFkZEhlbHBUZXh0KClgLlxuICAgKlxuICAgKiBAcGFyYW0ge3sgZXJyb3I6IGJvb2xlYW4gfX0gW2NvbnRleHRPcHRpb25zXSAtIHBhc3Mge2Vycm9yOnRydWV9IHRvIHdyaXRlIHRvIHN0ZGVyciBpbnN0ZWFkIG9mIHN0ZG91dFxuICAgKi9cblxuICBoZWxwKGNvbnRleHRPcHRpb25zKSB7XG4gICAgdGhpcy5vdXRwdXRIZWxwKGNvbnRleHRPcHRpb25zKTtcbiAgICBsZXQgZXhpdENvZGUgPSBwcm9jZXNzLmV4aXRDb2RlIHx8IDA7XG4gICAgaWYgKGV4aXRDb2RlID09PSAwICYmIGNvbnRleHRPcHRpb25zICYmIHR5cGVvZiBjb250ZXh0T3B0aW9ucyAhPT0gJ2Z1bmN0aW9uJyAmJiBjb250ZXh0T3B0aW9ucy5lcnJvcikge1xuICAgICAgZXhpdENvZGUgPSAxO1xuICAgIH1cbiAgICAvLyBtZXNzYWdlOiBkbyBub3QgaGF2ZSBhbGwgZGlzcGxheWVkIHRleHQgYXZhaWxhYmxlIHNvIG9ubHkgcGFzc2luZyBwbGFjZWhvbGRlci5cbiAgICB0aGlzLl9leGl0KGV4aXRDb2RlLCAnY29tbWFuZGVyLmhlbHAnLCAnKG91dHB1dEhlbHApJyk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEFkZCBhZGRpdGlvbmFsIHRleHQgdG8gYmUgZGlzcGxheWVkIHdpdGggdGhlIGJ1aWx0LWluIGhlbHAuXG4gICAqXG4gICAqIFBvc2l0aW9uIGlzICdiZWZvcmUnIG9yICdhZnRlcicgdG8gYWZmZWN0IGp1c3QgdGhpcyBjb21tYW5kLFxuICAgKiBhbmQgJ2JlZm9yZUFsbCcgb3IgJ2FmdGVyQWxsJyB0byBhZmZlY3QgdGhpcyBjb21tYW5kIGFuZCBhbGwgaXRzIHN1YmNvbW1hbmRzLlxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gcG9zaXRpb24gLSBiZWZvcmUgb3IgYWZ0ZXIgYnVpbHQtaW4gaGVscFxuICAgKiBAcGFyYW0ge3N0cmluZyB8IEZ1bmN0aW9ufSB0ZXh0IC0gc3RyaW5nIHRvIGFkZCwgb3IgYSBmdW5jdGlvbiByZXR1cm5pbmcgYSBzdHJpbmdcbiAgICogQHJldHVybiB7Q29tbWFuZH0gYHRoaXNgIGNvbW1hbmQgZm9yIGNoYWluaW5nXG4gICAqL1xuICBhZGRIZWxwVGV4dChwb3NpdGlvbiwgdGV4dCkge1xuICAgIGNvbnN0IGFsbG93ZWRWYWx1ZXMgPSBbJ2JlZm9yZUFsbCcsICdiZWZvcmUnLCAnYWZ0ZXInLCAnYWZ0ZXJBbGwnXTtcbiAgICBpZiAoIWFsbG93ZWRWYWx1ZXMuaW5jbHVkZXMocG9zaXRpb24pKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuZXhwZWN0ZWQgdmFsdWUgZm9yIHBvc2l0aW9uIHRvIGFkZEhlbHBUZXh0LlxuRXhwZWN0aW5nIG9uZSBvZiAnJHthbGxvd2VkVmFsdWVzLmpvaW4oXCInLCAnXCIpfSdgKTtcbiAgICB9XG4gICAgY29uc3QgaGVscEV2ZW50ID0gYCR7cG9zaXRpb259SGVscGA7XG4gICAgdGhpcy5vbihoZWxwRXZlbnQsIChjb250ZXh0KSA9PiB7XG4gICAgICBsZXQgaGVscFN0cjtcbiAgICAgIGlmICh0eXBlb2YgdGV4dCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICBoZWxwU3RyID0gdGV4dCh7IGVycm9yOiBjb250ZXh0LmVycm9yLCBjb21tYW5kOiBjb250ZXh0LmNvbW1hbmQgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBoZWxwU3RyID0gdGV4dDtcbiAgICAgIH1cbiAgICAgIC8vIElnbm9yZSBmYWxzeSB2YWx1ZSB3aGVuIG5vdGhpbmcgdG8gb3V0cHV0LlxuICAgICAgaWYgKGhlbHBTdHIpIHtcbiAgICAgICAgY29udGV4dC53cml0ZShgJHtoZWxwU3RyfVxcbmApO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG59O1xuXG4vKipcbiAqIEV4cG9zZSB0aGUgcm9vdCBjb21tYW5kLlxuICovXG5cbmV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cyA9IG5ldyBDb21tYW5kKCk7XG5leHBvcnRzLnByb2dyYW0gPSBleHBvcnRzOyAvLyBNb3JlIGV4cGxpY2l0IGFjY2VzcyB0byBnbG9iYWwgY29tbWFuZC5cblxuLyoqXG4gKiBFeHBvc2UgY2xhc3Nlc1xuICovXG5cbmV4cG9ydHMuQ29tbWFuZCA9IENvbW1hbmQ7XG5leHBvcnRzLk9wdGlvbiA9IE9wdGlvbjtcbmV4cG9ydHMuQ29tbWFuZGVyRXJyb3IgPSBDb21tYW5kZXJFcnJvcjtcbmV4cG9ydHMuSW52YWxpZE9wdGlvbkFyZ3VtZW50RXJyb3IgPSBJbnZhbGlkT3B0aW9uQXJndW1lbnRFcnJvcjtcbmV4cG9ydHMuSGVscCA9IEhlbHA7XG5cbi8qKlxuICogQ2FtZWwtY2FzZSB0aGUgZ2l2ZW4gYGZsYWdgXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGZsYWdcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqIEBhcGkgcHJpdmF0ZVxuICovXG5cbmZ1bmN0aW9uIGNhbWVsY2FzZShmbGFnKSB7XG4gIHJldHVybiBmbGFnLnNwbGl0KCctJykucmVkdWNlKChzdHIsIHdvcmQpID0+IHtcbiAgICByZXR1cm4gc3RyICsgd29yZFswXS50b1VwcGVyQ2FzZSgpICsgd29yZC5zbGljZSgxKTtcbiAgfSk7XG59XG5cbi8qKlxuICogT3V0cHV0IGhlbHAgaW5mb3JtYXRpb24gaWYgaGVscCBmbGFncyBzcGVjaWZpZWRcbiAqXG4gKiBAcGFyYW0ge0NvbW1hbmR9IGNtZCAtIGNvbW1hbmQgdG8gb3V0cHV0IGhlbHAgZm9yXG4gKiBAcGFyYW0ge0FycmF5fSBhcmdzIC0gYXJyYXkgb2Ygb3B0aW9ucyB0byBzZWFyY2ggZm9yIGhlbHAgZmxhZ3NcbiAqIEBhcGkgcHJpdmF0ZVxuICovXG5cbmZ1bmN0aW9uIG91dHB1dEhlbHBJZlJlcXVlc3RlZChjbWQsIGFyZ3MpIHtcbiAgY29uc3QgaGVscE9wdGlvbiA9IGNtZC5faGFzSGVscE9wdGlvbiAmJiBhcmdzLmZpbmQoYXJnID0+IGFyZyA9PT0gY21kLl9oZWxwTG9uZ0ZsYWcgfHwgYXJnID09PSBjbWQuX2hlbHBTaG9ydEZsYWcpO1xuICBpZiAoaGVscE9wdGlvbikge1xuICAgIGNtZC5vdXRwdXRIZWxwKCk7XG4gICAgLy8gKERvIG5vdCBoYXZlIGFsbCBkaXNwbGF5ZWQgdGV4dCBhdmFpbGFibGUgc28gb25seSBwYXNzaW5nIHBsYWNlaG9sZGVyLilcbiAgICBjbWQuX2V4aXQoMCwgJ2NvbW1hbmRlci5oZWxwRGlzcGxheWVkJywgJyhvdXRwdXRIZWxwKScpO1xuICB9XG59XG5cbi8qKlxuICogVGFrZXMgYW4gYXJndW1lbnQgYW5kIHJldHVybnMgaXRzIGh1bWFuIHJlYWRhYmxlIGVxdWl2YWxlbnQgZm9yIGhlbHAgdXNhZ2UuXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IGFyZ1xuICogQHJldHVybiB7c3RyaW5nfVxuICogQGFwaSBwcml2YXRlXG4gKi9cblxuZnVuY3Rpb24gaHVtYW5SZWFkYWJsZUFyZ05hbWUoYXJnKSB7XG4gIGNvbnN0IG5hbWVPdXRwdXQgPSBhcmcubmFtZSArIChhcmcudmFyaWFkaWMgPT09IHRydWUgPyAnLi4uJyA6ICcnKTtcblxuICByZXR1cm4gYXJnLnJlcXVpcmVkXG4gICAgPyAnPCcgKyBuYW1lT3V0cHV0ICsgJz4nXG4gICAgOiAnWycgKyBuYW1lT3V0cHV0ICsgJ10nO1xufVxuXG4vKipcbiAqIFBhcnNlIHRoZSBzaG9ydCBhbmQgbG9uZyBmbGFnIG91dCBvZiBzb21ldGhpbmcgbGlrZSAnLW0sLS1taXhlZCA8dmFsdWU+J1xuICpcbiAqIEBhcGkgcHJpdmF0ZVxuICovXG5cbmZ1bmN0aW9uIF9wYXJzZU9wdGlvbkZsYWdzKGZsYWdzKSB7XG4gIGxldCBzaG9ydEZsYWc7XG4gIGxldCBsb25nRmxhZztcbiAgLy8gVXNlIG9yaWdpbmFsIHZlcnkgbG9vc2UgcGFyc2luZyB0byBtYWludGFpbiBiYWNrd2FyZHMgY29tcGF0aWJpbGl0eSBmb3Igbm93LFxuICAvLyB3aGljaCBhbGxvd2VkIGZvciBleGFtcGxlIHVuaW50ZW5kZWQgYC1zdywgLS1zaG9ydC13b3JkYCBbc2ljXS5cbiAgY29uc3QgZmxhZ1BhcnRzID0gZmxhZ3Muc3BsaXQoL1sgfCxdKy8pO1xuICBpZiAoZmxhZ1BhcnRzLmxlbmd0aCA+IDEgJiYgIS9eW1s8XS8udGVzdChmbGFnUGFydHNbMV0pKSBzaG9ydEZsYWcgPSBmbGFnUGFydHMuc2hpZnQoKTtcbiAgbG9uZ0ZsYWcgPSBmbGFnUGFydHMuc2hpZnQoKTtcbiAgLy8gQWRkIHN1cHBvcnQgZm9yIGxvbmUgc2hvcnQgZmxhZyB3aXRob3V0IHNpZ25pZmljYW50bHkgY2hhbmdpbmcgcGFyc2luZyFcbiAgaWYgKCFzaG9ydEZsYWcgJiYgL14tW14tXSQvLnRlc3QobG9uZ0ZsYWcpKSB7XG4gICAgc2hvcnRGbGFnID0gbG9uZ0ZsYWc7XG4gICAgbG9uZ0ZsYWcgPSB1bmRlZmluZWQ7XG4gIH1cbiAgcmV0dXJuIHsgc2hvcnRGbGFnLCBsb25nRmxhZyB9O1xufVxuXG4vKipcbiAqIFNjYW4gYXJndW1lbnRzIGFuZCBpbmNyZW1lbnQgcG9ydCBudW1iZXIgZm9yIGluc3BlY3QgY2FsbHMgKHRvIGF2b2lkIGNvbmZsaWN0cyB3aGVuIHNwYXduaW5nIG5ldyBjb21tYW5kKS5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ1tdfSBhcmdzIC0gYXJyYXkgb2YgYXJndW1lbnRzIGZyb20gbm9kZS5leGVjQXJndlxuICogQHJldHVybnMge3N0cmluZ1tdfVxuICogQGFwaSBwcml2YXRlXG4gKi9cblxuZnVuY3Rpb24gaW5jcmVtZW50Tm9kZUluc3BlY3RvclBvcnQoYXJncykge1xuICAvLyBUZXN0aW5nIGZvciB0aGVzZSBvcHRpb25zOlxuICAvLyAgLS1pbnNwZWN0Wz1baG9zdDpdcG9ydF1cbiAgLy8gIC0taW5zcGVjdC1icmtbPVtob3N0Ol1wb3J0XVxuICAvLyAgLS1pbnNwZWN0LXBvcnQ9W2hvc3Q6XXBvcnRcbiAgcmV0dXJuIGFyZ3MubWFwKChhcmcpID0+IHtcbiAgICBpZiAoIWFyZy5zdGFydHNXaXRoKCctLWluc3BlY3QnKSkge1xuICAgICAgcmV0dXJuIGFyZztcbiAgICB9XG4gICAgbGV0IGRlYnVnT3B0aW9uO1xuICAgIGxldCBkZWJ1Z0hvc3QgPSAnMTI3LjAuMC4xJztcbiAgICBsZXQgZGVidWdQb3J0ID0gJzkyMjknO1xuICAgIGxldCBtYXRjaDtcbiAgICBpZiAoKG1hdGNoID0gYXJnLm1hdGNoKC9eKC0taW5zcGVjdCgtYnJrKT8pJC8pKSAhPT0gbnVsbCkge1xuICAgICAgLy8gZS5nLiAtLWluc3BlY3RcbiAgICAgIGRlYnVnT3B0aW9uID0gbWF0Y2hbMV07XG4gICAgfSBlbHNlIGlmICgobWF0Y2ggPSBhcmcubWF0Y2goL14oLS1pbnNwZWN0KC1icmt8LXBvcnQpPyk9KFteOl0rKSQvKSkgIT09IG51bGwpIHtcbiAgICAgIGRlYnVnT3B0aW9uID0gbWF0Y2hbMV07XG4gICAgICBpZiAoL15cXGQrJC8udGVzdChtYXRjaFszXSkpIHtcbiAgICAgICAgLy8gZS5nLiAtLWluc3BlY3Q9MTIzNFxuICAgICAgICBkZWJ1Z1BvcnQgPSBtYXRjaFszXTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIGUuZy4gLS1pbnNwZWN0PWxvY2FsaG9zdFxuICAgICAgICBkZWJ1Z0hvc3QgPSBtYXRjaFszXTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKChtYXRjaCA9IGFyZy5tYXRjaCgvXigtLWluc3BlY3QoLWJya3wtcG9ydCk/KT0oW146XSspOihcXGQrKSQvKSkgIT09IG51bGwpIHtcbiAgICAgIC8vIGUuZy4gLS1pbnNwZWN0PWxvY2FsaG9zdDoxMjM0XG4gICAgICBkZWJ1Z09wdGlvbiA9IG1hdGNoWzFdO1xuICAgICAgZGVidWdIb3N0ID0gbWF0Y2hbM107XG4gICAgICBkZWJ1Z1BvcnQgPSBtYXRjaFs0XTtcbiAgICB9XG5cbiAgICBpZiAoZGVidWdPcHRpb24gJiYgZGVidWdQb3J0ICE9PSAnMCcpIHtcbiAgICAgIHJldHVybiBgJHtkZWJ1Z09wdGlvbn09JHtkZWJ1Z0hvc3R9OiR7cGFyc2VJbnQoZGVidWdQb3J0KSArIDF9YDtcbiAgICB9XG4gICAgcmV0dXJuIGFyZztcbiAgfSk7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=